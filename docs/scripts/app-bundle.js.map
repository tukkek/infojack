{"version":3,"sources":["app.js","empty.js","environment.js","infojack-mainmenu.js","infojack-radio.js","infojack-topmenu.js","infojack-win.js","main.js","messages.js","cyberspace/infojack-cyberspace.js","cyberspace/program-bar.js","character/character-abilities.js","character/character-deck.js","character/character-details.js","character/character-feats.js","character/character-general.js","character/character-programs.js","character/character-screen.js","character/character-skills.js","character/character-talents.js","modules/deck.js","modules/grade.js","modules/rpg.js","modules/save.js","modules/sound.js","resources/index.js","modules/character/character.js","modules/character/feat.js","modules/character/occupation.js","modules/character/skill.js","modules/cyberspace/console.js","modules/cyberspace/system.js","modules/program/armor.js","modules/program/cloak.js","modules/program/eject.js","modules/program/program.js","modules/world/business.js","modules/world/names.js","modules/character/class/class.js","modules/character/class/webcrawler.js","modules/cyberspace/avatar/avatar.js","modules/cyberspace/avatar/control.js","modules/cyberspace/avatar/file.js","modules/cyberspace/avatar/gateway.js","modules/cyberspace/avatar/map.js","modules/cyberspace/avatar/player.js","modules/cyberspace/node/cpu.js","modules/cyberspace/node/datastore.js","modules/cyberspace/node/interface.js","modules/cyberspace/node/node.js","modules/cyberspace/node/portal.js","modules/program/weapon/blade.js","modules/program/weapon/blaster.js","modules/program/weapon/weapon.js","modules/cyberspace/avatar/ice/bouncer.js","modules/cyberspace/avatar/ice/greeter.js","modules/cyberspace/avatar/ice/ice.js","modules/cyberspace/avatar/ice/scout.js","modules/cyberspace/avatar/ice/tracer.js","modules/cyberspace/avatar/secure/alarm.js","modules/cyberspace/avatar/secure/backdoor.js","modules/cyberspace/avatar/secure/entry.js","modules/cyberspace/avatar/secure/secure.js","modules/cyberspace/avatar/secure/shutdown.js","modules/cyberspace/avatar/secure/terminal.js"],"names":["App","Example","debug","testing","nodesize","fullattributes","ccskills","playeravatars","MainMenu","EventAggregator","show","messaging","hassave","checkload","view","me","setTimeout","close","showpending","play","ERROR","alert","startgame","prompt","confirm","clear","loadgame","load","open","publish","openrepository","window","Radio","active","audio","pause","TopMenu","hideradio","NICE","Win","subscribe","apply","end","levelup","save","level","abilities","pointextra","skills","ranks","feats","newfeats","wealth","nice","choose","location","reload","configure","Promise","config","warnings","wForgottenReturn","aurelia","use","standardConfiguration","feature","developmentLogging","plugin","start","then","setRoot","ShowView","Connect","system","connect","Disconnect","message","safe","win","reconnect","Refresh","target","refresh","TILESIZE","SPACING","FADETIME","MINIMUMWAIT","current","lastclick","Cyberspace","e","s","init","map","document","querySelector","console","player","tiles","drawn","draw","clicktile","tile","now","Date","getTime","tagName","parentNode","node","nodes","nodeid","avatar","getavatar","nodex","nodey","scanned","click","wait","disconnect","enter","placenode","placetile","x","y","createElement","push","classList","add","id","onclick","style","width","height","left","top","placespacer","farx","fary","t","offsetLeft","offsetTop","spacer","body","scrollTop","scrollLeft","appendChild","expand","indexOf","getneighbors","n","visited","scroll","scrollIntoView","addimage","image","src","title","tooltip","removeimage","opacity","fade","removeChild","printmessages","innerHTML","m","next","color","createTextNode","text","scrollHeight","refreshtile","name","remove","act","revealed","ProgramBar","BindingSignaler","signals","collapsed","sort","gethpcolor","hp","green","red","r","g","b","refreshdetails","c","character","maxhp","hpcolor","Math","round","memoryused","totalload","memory","getload","loadcolor","freestorage","storage","storageused","turn","programs","slice","signal","toggle","isloaded","program","loaded","geticonclass","doload","LOAD","dounload","unload","UNLOAD","run","print","CharacterAbilities","attached","full","strength","dexterity","constitution","intelligence","wisdom","charisma","pointbuy","clone","Object","assign","upgrade","ability","raised","buy","updateranks","cost","CharacterDeck","possess","electronics","getelectronics","deckgrade","memorygrade","storagegrade","stealthgrade","canupgradedeck","upgradedeck","canupgradememory","upgradememory","canupgradestorage","upgradestorage","canupgradestealth","upgradestealth","grade","i","CharacterDetails","saves","classes","hero","bind","getmodifier","toLowerCase","getsave","getskill","skill","replace","sign","CharacterFeats","viewname","points","feat","validate","getcurrent","f","talent","getall","CharacterGeneral","avatars","focus","select","CharacterPrograms","getprograms","Map","available","getinformation","purchasedc","set","get","technology","gettechnology","has","getpurchaselabel","canbuy","cancreate","programmingdc","getprogramminglabel","create","CharacterScreen","showgeneral","showabilities","showskills","showfeats","showtalents","showdetails","showdeck","showprograms","buttons","charactermenu","querySelectorAll","button","CharacterSkills","values","getranks","iscrossclass","classskills","includes","canupgrade","setranks","value","pending","getability","substring","toUpperCase","CharacterTalents","talents","OK","MEMORYUPGRADE","Deck","memorytemporary","checkgrade","currentgrade","installdc","result","data","key","a","compare","getfreestorage","roll","deck","duration","hackingdc","grades","CRITICALHIT","CRITICALMISS","Rpg","min","max","floor","random","d","dice","sides","sum","list","length","chancein","shuffle","array","j","swap","randomize","amount","rpg","DEBUG","Save","localStorage","getItem","saveprograms","p","setItem","JSON","stringify","loadprograms","populate","parse","initialize","PREFIX","queue","running","Sound","ALERTCANCEL","ALERTRED","ALERTYELLOW","CONNECT","CRASH","DISABLE","DISCONNECTED","ICEATTACK","ICEDEATH","ICEENTER","ICELEAVE","MOVE","SCAN","SUCCESS","QUERY","process","Audio","shift","onended","file","sound","ABILITYPOINTS","costs","Character","bab","edgedice","edge","fort","ref","will","defence","speed","extratalents","contacts","setoccupation","occupation","addclassskill","enhance","con","hasfeat","addfeat","featbonus","undefined","getbluff","bluff","getconcentration","concentration","getdecryption","decryption","getforgery","forgery","information","gethacking","hacking","getperceive","perceive","getmedicine","medicine","getstealth","stealth","getprofession","profession","getresearch","research","getsearch","search","getfortitude","getreflexes","getwill","getinitiative","getdefence","getmelee","getranged","price","difference","sell","upgradewealth","taketen","letter","move","learnability","learnskill","learnfeat","advance","adventurer","Feat","description","Talent","Educated","Meticulous","Stealthy","Studious","Trustworthy","ImprovedInitiative","Toughness","Windfall","Occupation","skillsp","occupations","checkskills","Skill","log","ss","Message","Console","messages","ICECOMMON","ICERARE","System","business","depth","shutdown","ice","reentry","entrance","backdoor","disconnected","generate","generatemap","definenodes","generateice","revealmap","reveal","scannodes","scan","getnode","size","leastx","leasty","replacenode","original","findportals","exits","filter","generatenode","defineportals","portals","mainframe","branches","systems","branch","pop","neighbors","corridor","fireevent","MAPREVEALED","notifyalert","previous","cancelling","raisealert","raise","silent","credentials","types","rarechance","rare","budget","passes","pass","quantity","doublings","type","deployice","na","nb","priority","deploy","ap","noice","reset","Armor","modify","bonus","describe","armor","Cloak","apcost","modifier","onevent","ATTACK","OPENFILE","Eject","hack","code","eject","SESSION","Number","MAX_SAFE_INTEGER","PROGRAMS","Program","basename","ntimes","conflict","boot","splice","localeCompare","LETTERS","Business","entry","tier","ceil","levels","l","ismainframe","crash","systemlevel","NATIONALITIES","INDUSTRIES","pick","range","reference","lower","higher","index","Class","upgradehp","hd","upgraderanks","classlevel","stat","upgradestat","upgradeedgedice","upgradereputation","last","split","parseInt","reputation","check","TheWebIsAlive","SpecializedEquipment","Webcrawler","webcrawler","Avatar","obfuscate","scandc","rollinitiative","setname","setimage","characterclass","describehealth","health","die","leave","damage","hit","attack","authenticate","dc","hide","query","discovered","getserial","serial","toString","getscale","hidden","Control","privilege","abuse","NOTDOWNLOADING","File","downloading","worthless","trap","protected","define","getprogram","eligible","findtrap","decrypt","download","spring","invalid","transfer","progress","DISCONNECT","JUMP","Gateway","destination","events","lastact","Player","trace","penalty","first","percent","status","source","spotter","login","FUNCTIONS","Cpu","main","Datastore","files","Interface","TILES","Node","xy","checkadjacent","receive","Portal","Blade","Blaster","Weapon","soundfile","Bouncer","getattack","ranged","Greeter","Ice","revealedname","revealedimage","checkcharacter","constructor","getdamage","findplayer","getdestination","meleedamage","Scout","path","history","ns","moved","DUMMY","FINISHED","Tracer","Alarm","Backdoor","activate","deactivate","Entry","SecureAvatar","INITIAL","Shutdown","Terminal"],"mappings":"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","file":"app-bundle.js","sourcesContent":["export class App {\n  constructor() {\n  }\n}\n","export class Example {\n  constructor() {\n  }\n}\n","export default {\n  /* environment */\n  debug: false,\n  testing: false,\n  /* game options */\n  nodesize:4, //grid size for each node\n  fullattributes:false, //no sense in having physical now\n  ccskills:false, //only 1 is cross-class, so disable for now \n  playeravatars:17,\n  /* debug flags only on dev.js */\n};\n","import {inject} from 'aurelia-framework';\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {sound} from './modules/sound';\nimport {save} from './modules/save';\nimport {ShowView} from './messages';\nimport environment from './environment';\nimport './modules/world/names';\n\n@inject(EventAggregator)\nexport class MainMenu {\n    constructor(EventAggregator) {\n        this.show=true;\n        this.messaging=EventAggregator;\n        this.hassave=save.checkload()!=false;\n        if(environment.view){\n          let me=this;\n          setTimeout(function(){\n            me.close(environment.view);}\n          ,1);\n        }\n    }\n  \n    showpending(){\n        sound.play(sound.ERROR);\n        setTimeout(function(){\n            alert('Operation pending!');\n        },100);\n    }\n    \n    startgame(){\n        let prompt='Are you sure you want to start a new game? Any previous progress will be lost!';\n        if(this.hassave&&!confirm(prompt)){\n            return;\n        }\n        save.clear();\n        this.close('CharacterScreen');\n    }\n    \n    loadgame(){\n        if(this.hassave){\n          save.load();\n          this.close('CharacterScreen');\n        }else{\n          sound.play(sound.ERROR);\n          alert('No save found!');\n        }\n    }\n    \n    close(open){\n        this.show=false;\n        this.messaging.publish(new ShowView(open));\n    }\n      \n    openrepository(){\n      window.open('https://github.com/tukkek/infojack');\n    }\n}\n","export class Radio {\n    constructor() {\n        this.active=false;\n    }\n  \n    play(){\n        this.audio.play();\n        if(!this.active){\n            this.audio.play();\n        } else {\n            this.audio.pause();\n        }\n        return true;\n    }\n}\n","export class TopMenu{\n    constructor(){\n        this.hideradio=true;\n    }\n    \n    open(){\n        this.hideradio=!this.hideradio;\n    }\n}\n","import {inject} from 'aurelia-framework';\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {ShowView} from './messages';\nimport {hero} from './modules/character/character';\nimport {rpg} from './modules/rpg';\nimport {save} from './modules/save';\n\nvar NICE=['Alright!','Sweet!','Hell to the yeah!','Score!','Bonus!','♫ A ♫ ma ♫ zing ♫','Groovy!','Hit it Johnny!','Loving it!','Totally radical!','Cowabanga!',\"That's how you do it, chummer.\",'Let it rip, choombata!'];\n\n@inject(EventAggregator)\nexport class Win {\n  constructor(messaging) {\n    this.show=false;\n    let me=this;\n    messaging.subscribe(ShowView,function(show){\n      if(show.view=='Win') me.apply();\n    });\n  }\n  \n  apply(){\n    this.end=!hero.levelup();\n    save.save();\n    this.level=hero.level;\n    this.abilities=hero.pointextra;\n    this.skills=hero.ranks;\n    this.feats=hero.newfeats;\n    this.wealth=hero.wealth+'¥';\n    this.nice=rpg.choose(NICE);\n    this.show=true;\n  }\n  \n  close(){\n    if(!this.end){\n      this.show=false;\n      return;\n    }\n    save.clear();\n    window.location.reload();\n  }\n}\n","import environment from './environment';\n\n//Configure Bluebird Promises.\nPromise.config({\n  warnings: {\n    wForgottenReturn: false\n  }\n});\n\nexport function configure(aurelia) {\n  aurelia.use\n    .standardConfiguration()\n    .feature('resources');\n\n  if (environment.debug) {\n    aurelia.use.developmentLogging();\n  }\n\n  if (environment.testing) {\n    aurelia.use.plugin('aurelia-testing');\n  }\n\n  aurelia.start().then(() => aurelia.setRoot());\n}\n","import {connect} from './modules/world/business';\n\nexport class ShowView{\n  constructor(view){this.view=view;}\n}\n\nexport class Connect{\n  constructor(system=connect()){\n    system.connect();\n    this.system=system;\n  }\n}\n\nexport class Disconnect{\n  constructor(message=false){\n    this.message=message;\n    this.safe=false;\n    this.win=false;\n    this.reconnect=false;//jumping between systems\n  }\n}\n\nexport class Refresh{\n  constructor(target){this.target=target;}\n}\n","import {connect} from '../modules/world/business';\nimport {console} from '../modules/cyberspace/console';\nimport {inject} from 'aurelia-framework';\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {sound} from '../modules/sound';\nimport {ShowView} from '../messages';\nimport environment from '../environment';\nimport {hero} from '../modules/character/character';\nimport {Connect,Refresh,Disconnect} from '../messages';\n\nvar TILESIZE=2.5;\nvar SPACING=1.1;\nvar FADETIME=2000;\nvar MINIMUMWAIT=environment.debug?0:1000/2; //once there's realtime, this isn't necessary - can just check if AP<=0 to let a click on the map go through\n\nvar current=false;\nvar lastclick=0;\n\n@inject(EventAggregator)\nexport class Cyberspace{\n  constructor(messaging){\n    this.messaging=messaging;\n    this.active=false;\n    current=this;\n    let me=this;\n    messaging.subscribe(Connect,function(e){\n      let s=e.system;\n      me.system=s;\n      console.system=s;\n      me.init();\n    });\n  }\n\n  init(){\n    this.active=true;\n    this.map=document.querySelector('#cyberspace');\n    this.console=\n      document.querySelector('#console-constraint');\n    this.player=this.system.player;\n    this.tiles=[];\n    this.drawn=[];\n    this.draw();\n  }\n\n  clicktile(tile){\n    let now=new Date().getTime();\n    if(lastclick+MINIMUMWAIT>now) return;\n    lastclick=now;\n    if(tile.tagName=='IMG') tile=tile.parentNode;\n    let node=this.system.nodes[tile.nodeid];\n    if(node==this.player.node){\n      let avatar=node.getavatar(tile.nodex,tile.nodey);\n      try{\n        if(avatar&&avatar.scanned) avatar.click();\n        else this.player.wait();\n      }catch(e){\n        this.disconnect(e);\n        return;\n      }\n    }else if(this.player.enter(node))\n      this.placenode(node,true);\n    this.refresh();\n  }\n\n  placetile(x,y,node){\n    let tile=document.createElement('div');\n    this.tiles.push(tile);\n    tile.classList.add('tile');\n    tile.nodeid=node.id;\n    tile.nodex=x;\n    tile.nodey=y;\n    let me=this;\n    tile.onclick=function(){me.clicktile(this);};\n    let style=tile.style;\n    style.width=TILESIZE+'em';\n    style.height=TILESIZE+'em';\n    style.left=(node.x*SPACING*environment.nodesize+x)\n      *TILESIZE+'em';\n    style.top=(node.y*SPACING*environment.nodesize+y)\n      *TILESIZE+'em';\n    return tile;\n  }\n\n  placespacer(){\n    let farx=0;\n    let fary=0;\n    for(let t of this.tiles){\n      if(t.offsetLeft>farx) farx=t.offsetLeft;\n      if(t.offsetTop>fary) fary=t.offsetTop;\n    }\n    let spacer=document.createElement('div');\n    spacer.classList.add('spacer');\n    spacer.style.top=(document.body.scrollTop+fary)+'px';\n    spacer.style.left=(document.body.scrollLeft+farx)+'px';\n    this.map.appendChild(spacer);\n  }\n\n  placenode(node,expand){\n    if(this.drawn.indexOf(node)<0){\n      this.drawn.push(node);\n      for(let x=0;x<environment.nodesize;x++)\n        for(let y=0;y<environment.nodesize;y++)\n          this.map.appendChild(this.placetile(x,y,node));\n    }\n    if(expand) for(let n of node.getneighbors())\n      this.placenode(n,false);\n    let me=this;\n    setTimeout(function(){me.placespacer();},500);\n  }\n\n  draw(){\n    for(let n of this.system.nodes) if(n.visited)\n      this.placenode(n,true);\n    this.scroll();\n    this.refresh();\n  }\n\n  scroll(){\n    for(let t of this.tiles)\n      if(t.nodeid==this.player.node.id&&\n        t.nodex==this.player.x&&t.nodey==this.player.y){\n          setTimeout(function(){t.scrollIntoView();},250);\n          return;\n      }\n  }\n\n  addimage(tile,avatar){\n    tile.avatar=avatar;\n    tile.scanned=avatar.scanned;\n    let image=document.createElement('img');\n    image.src=avatar.image;\n    image.title=avatar.tooltip;\n    tile.appendChild(image);\n    tile.image=image;\n  }\n\n  removeimage(tile){\n    tile.avatar=null;\n    tile.image.style.opacity=0;\n    let fade=tile.image;\n    tile.image=null;\n    setTimeout(function(){tile.removeChild(fade);},FADETIME);\n  }\n\n  printmessages(){\n    this.console.innerHTML='';\n    for(let m=console.next();m;m=console.next()){\n      let color=false;\n      if(m.alert==0) color='white';\n      else if(m.alert==1) color='yellow';\n      else if(m.alert==2) color='red';\n      else throw 'Unknown alert level';\n      let message=document.createElement('span');\n      message.style.color=color;\n      message.appendChild(document.createTextNode(m.text));\n      this.console.appendChild(message);\n    }\n    this.console.scrollTop=this.console.scrollHeight;\n  }\n\n  refreshtile(t){\n    let node=this.system.nodes[t.nodeid];\n    if(t.style.opacity==0) setTimeout(function(){\n      t.classList.add('discovered');\n    },1);\n    if(!node.visited) return;\n    if(!t.visited){\n      t.classList.add(node.name);\n      t.visited=true;\n    }\n    let avatar=node.getavatar(t.nodex,t.nodey);\n    if(avatar&&!avatar.show()) avatar=false;\n    if(t.image&&(!avatar||\n      avatar!=t.avatar||t.scanned!=avatar.scanned))\n        this.removeimage(t);\n    if(avatar&&avatar!=t.avatar) this.addimage(t,avatar);\n    if(avatar&&this.player.target==avatar){\n      t.classList.add('target');\n    }else t.classList.remove('target');\n  }\n\n  disconnect(e){\n    if(!(e instanceof Disconnect)) throw e;\n    this.refresh(false);\n    this.system.disconnect(e);\n    this.active=false;\n    this.map.innerHTML='';\n    this.console.innerHTML='';\n    if(e.reconnect){\n      this.messaging.publish(new Connect(e.reconnect));\n    }else{\n      this.messaging.publish(\n        new ShowView('CharacterScreen'));\n      if(e.win) this.messaging.publish(new ShowView('Win'));\n    }\n  }\n\n  refresh(act=true){\n    try{\n      if(act) while(this.system.act()){ /* process NPCs */ }\n    }catch(e){\n      this.disconnect(e);\n      return;\n    }\n    this.printmessages();\n    if(this.system.revealed) for(let n of this.system.nodes)\n      this.placenode(n,false);\n    for(let t of this.tiles) this.refreshtile(t);\n    this.messaging.publish(new Refresh('ProgramBar'));\n  }\n}\n\nexport function refresh(){current.refresh();}\n","import {deck} from '../modules/deck';\nimport {console} from '../modules/cyberspace/console';\nimport {inject} from 'aurelia-framework';\nimport {BindingSignaler} from 'aurelia-templating-resources';\nimport {refresh as refreshcyberspace} from './infojack-cyberspace';\nimport {sound} from '../modules/sound';\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {Connect,Refresh} from '../messages';\n\n@inject(BindingSignaler,EventAggregator)\nexport class ProgramBar{\n  constructor(BindingSignaler,EventAggregator) {\n    this.signals=BindingSignaler;\n    this.messaging=EventAggregator;\n    let me=this;\n    this.messaging.subscribe(Connect,function(e){\n      me.system=e.system;\n      me.collapsed=true;\n      deck.sort();\n      me.refresh(false);\n    });\n    this.messaging.subscribe(Refresh,function(e){\n      if(e.target!='ProgramBar') return;\n      me.refresh(false);\n    });\n  }\n\n  gethpcolor(hp){\n    let green=[124,252,0];\n    let red=[255,0,0];\n    let r=red[0]+hp*(green[0]-red[0]);\n    let g=red[1]+hp*(green[1]-red[1]);\n    let b=red[2]+hp*(green[2]-red[2]);\n    return 'rgb('+r+','+g+','+b+')';\n  }\n\n  //not all data needs to be update every single turn\n  //prevent a cyberspace<->program bar refresh loop\n  refreshdetails(){\n    let c=this.system.player.character;\n    let hp=c.hp/c.maxhp;\n    this.hpcolor='color:'+this.gethpcolor(hp)+';';\n    this.hp=Math.round(100*hp);\n    this.load=deck.memoryused;\n    this.totalload=deck.memory;\n    let load=deck.getload();\n    if(load==0) this.loadcolor='white';\n    else if(load==1) this.loadcolor='orange';\n    else this.loadcolor='red';\n    this.loadcolor='color:'+this.loadcolor+';';\n    this.freestorage=deck.storage-deck.storageused;\n  }\n\n  refresh(turn=true){\n    this.programs=deck.programs.slice();\n    this.refreshdetails();\n    this.signals.signal('update-program-bar');\n    if(turn) refreshcyberspace();\n  }\n\n  toggle(){this.collapsed=!this.collapsed;}\n\n  isloaded(program){\n    return deck.loaded.indexOf(program)>=0;\n  }\n\n  geticonclass(program){\n    return this.isloaded(program)?\"loaded\":\"unloaded\";\n  }\n\n  doload(program){\n    let load=program.load(this.system);\n    sound.play(load?sound.LOAD:sound.ERROR);\n    this.refresh();\n    return load;\n  }\n\n  dounload(program){\n    let unload=program.unload(this.system);\n    if(unload) sound.play(sound.UNLOAD);\n    this.refresh();\n    return unload;\n  }\n\n  run(program){\n    //TODO skill roll\n    if(!this.isloaded(program)){\n      console.print('Load '+program.name+' first...');\n    }else if(program.run(this.system)){\n      //TODO duration callback and skill check\n    }\n    this.refresh();\n  }\n}\n","import {hero,costs} from '../modules/character/character';\nimport environment from '../environment';\n\n/* TODO add difficulty modes */\nexport class CharacterAbilities {\n    constructor() {}\n    \n    attached(){\n        this.full=environment.fullattributes;\n        this.strength=hero.strength;\n        this.dexterity=hero.dexterity;\n        this.constitution=hero.constitution;\n        this.intelligence=hero.intelligence;\n        this.wisdom=hero.wisdom;\n        this.charisma=hero.charisma;\n        this.pointbuy=hero.pointbuy;\n        this.pointextra=hero.pointextra;\n    }\n    \n    save(){\n        let clone={};\n        Object.assign(clone,this);\n        delete clone.full;\n        hero.assign(clone);\n    }\n\n    upgrade(ability){\n      let current=this[ability];\n      if(current==18) return;\n      let raised=this[ability]+1;\n      if(this.pointextra>0){\n        this.pointextra-=1;\n        this[ability]=raised;\n      }else if(this.buy(current)){\n        this[ability]=raised;\n      }else return;\n      this.save();\n      hero.updateranks(ability);\n    }\n    \n    buy(current){\n        let next=current+1;\n        let cost=costs[next]-costs[current];\n        if(this.pointbuy>=cost){\n            this.pointbuy-=cost;\n            return true;\n        }\n        return false;\n    }\n}\n","import {deck} from '../modules/deck';\nimport {hero,sign} from '../modules/character/character';\nimport {grades} from '../modules/grade';\n\n//TODO move to a city shop screen instead of character\nexport class CharacterDeck {\n    constructor(){}\n    \n    attached(){this.refresh();}\n    \n    refresh(){\n      this.memory=deck.memory;\n      this.storage=deck.storage;\n      this.name=hero.possess();\n      this.wealth=hero.wealth;\n      this.electronics=sign(hero.getelectronics());\n      this.deckgrade=deck.deckgrade;\n      this.memorygrade=deck.memorygrade;\n      this.storagegrade=deck.storagegrade;\n      this.stealthgrade=deck.stealthgrade;\n      this.canupgradedeck=deck.upgradedeck(false);\n      this.canupgradememory=deck.upgradememory(false);\n      this.canupgradestorage=deck.upgradestorage(false);\n      this.canupgradestealth=deck.upgradestealth(false);\n    }\n    \n    grade(i){return grades[i];}\n    \n    upgradedeck(){\n      debugger;\n      deck.upgradedeck(true);\n      this.refresh();\n    }\n    \n    upgradememory(){\n      deck.upgradememory(true);\n      this.refresh();\n    }\n    \n    upgradestorage(){\n      deck.upgradestorage(true);\n      this.refresh();\n    }\n    \n    upgradestealth(){\n      deck.upgradestealth(true);\n      this.refresh();\n    }\n}\n","import {hero,sign} from '../modules/character/character';\nimport {skills} from '../modules/character/skill';\nimport {Class} from '../modules/character/class/class';\n\nexport class CharacterDetails {\n    constructor() {\n      this.abilities=['Strength','Dexterity','Constitution','Intelligence','Wisdom','Charisma'];\n      this.saves=['Fortitude','Reflexes','Will'];\n      this.skills=skills;\n      this.classes=Class.classes;\n      this.hero=hero;\n    }\n\n    bind(){\n      this.avatar=hero.connect();\n    }\n    \n    getmodifier(ability){\n      ability=ability.toLowerCase();\n      ability=this.avatar.getmodifier(this.avatar[ability]);\n      return sign(ability);\n    }\n    \n    getsave(save){\n      save=save.toLowerCase();\n      return sign(this.avatar['get'+save]());\n    }\n    \n    getskill(skill){\n      skill=skill.name.replace(' ','').toLowerCase()\n      return sign(this.avatar['get'+skill]());\n    }\n    \n    sign(n){return sign(n);}\n}\n","import {feats} from '../modules/character/feat';\nimport {hero} from '../modules/character/character';\nimport {inject} from 'aurelia-framework';\nimport {BindingSignaler} from 'aurelia-templating-resources';\n\n@inject(BindingSignaler)\nexport class CharacterFeats {\n    constructor(BindingSignaler) {\n        this.signals=BindingSignaler;\n        this.viewname='Feats';\n    }\n    \n    bind(){this.points=hero.newfeats;}\n\n    add(feat){\n        if(this.points==0) return;\n        this.points-=1;\n        hero.newfeats-=1;\n        feat.apply(hero);\n        this.signals.signal('update');\n    }\n    \n    validate(feat){\n        return this.points>0&&feat.validate(hero);\n    }\n    \n    getcurrent(){\n      let current=[];\n      for(let f of hero.feats) if(!f.talent) current.push(f);\n      return current;\n    }\n    \n    getall(){return feats;}\n}\n","import {hero} from '../modules/character/character';\nimport environment from '../environment';\n\nexport class CharacterGeneral {\n    constructor() {\n      this.hero=hero;\n      this.avatar=hero.image;\n      this.avatars=environment.playeravatars;\n    }\n    \n    attached(){this.name.focus();}\n    \n    select(avatar){\n      this.avatar=avatar;\n      hero.image=avatar;\n    }\n}\n","import {PROGRAMS} from '../modules/program/program';\nimport {hero,sign} from '../modules/character/character';\nimport {deck} from '../modules/deck';\nimport {inject} from 'aurelia-framework';\nimport {BindingSignaler} from 'aurelia-templating-resources';\n\n//TODO move out of character screen\n@inject(BindingSignaler)\nexport class CharacterPrograms {\n    constructor(BindingSignaler) {\n      this.signals=BindingSignaler;\n    }\n    \n    //returns sorted by name and filtered by Information\n    getprograms(){\n      let programs=new Map();\n      let available=[];\n      for(let [name,program] of PROGRAMS)\n        if(10+hero.getinformation()>=program.purchasedc)\n          available.push(name);\n      for(let name of available) \n        programs.set(name,PROGRAMS.get(name));\n      return programs;\n    }\n    \n    refresh(){\n      this.programs=this.getprograms();\n      this.name=hero.possess();\n      this.wealth=hero.wealth;\n      this.technology=sign(hero.gettechnology());\n      this.signals.signal('update');\n    }\n    \n    attached(){this.refresh();}\n    \n    has(program){return deck.programs.indexOf(program)>=0;}\n    \n    getpurchaselabel(program){\n      let wealth=program.purchasedc-10;\n      if(wealth<0) wealth=0;\n      return 'Requires '+wealth+'¥';\n    }\n    \n    canbuy(program){\n      return !this.has(program)&&\n        hero.wealth+10>=program.purchasedc;\n    }\n    \n    buy(program){\n      if(program.buy()) this.refresh();\n      else alert('Cannot buy error!');\n    }\n    \n    cancreate(program){\n      return !this.has(program)&&\n        hero.gettechnology()+10>=program.programmingdc;\n    }\n    \n    getprogramminglabel(program){\n      return 'Requires technology '+\n        sign(program.programmingdc-10);\n    }\n    \n    create(program){\n      deck.programs.push(program);\n      this.refresh();\n    }\n}\n","import {inject} from 'aurelia-framework';\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {ShowView,Connect} from '../messages';\nimport {save} from '../modules/save';\n\n@inject(EventAggregator)\nexport class CharacterScreen {\n  constructor(messaging) {\n      this.messaging=messaging;\n      this.show=false;\n      this.showgeneral=true;\n      this.showabilities=false;\n      this.showskills=false;\n      this.showfeats=false;\n      this.showtalents=false;\n      this.showdetails=false;\n      this.showdeck=false;\n      this.showprograms=false;\n      let me=this;\n      messaging.subscribe(ShowView,function(show){\n          if(show.view=='CharacterScreen') me.show=true;\n      });\n  }\n  \n  select(e){\n    let id=e.target.id;\n    let buttons=\n      this.charactermenu.querySelectorAll('button');\n    for(let button of buttons){\n      let classes=button.classList;\n      if(!classes) continue;\n      var show=button.id==id;\n      this['show'+button.id.replace('character-','')]=show;\n      if(show){\n        classes.add('highlightbg');\n      } else {\n        classes.remove('highlightbg');\n      }\n    }\n  }\n  \n  close(){\n      save.save();\n      this.show=false;\n      this.messaging.publish(new Connect());\n  }\n}\n\n","import {skills} from '../modules/character/skill';\nimport {hero} from '../modules/character/character';\nimport {inject} from 'aurelia-framework';\nimport environment from '../environment';\n\nexport class CharacterSkills {\n  constructor() {\n    this.skills=skills;\n  }\n  \n  bind(){\n    this.hero=hero;\n    this.ranks={};\n    for(let s of skills.values()) \n      this.ranks[s.name]=hero.getranks(s.name);\n  }\n  \n  iscrossclass(skill){\n    return environment.ccskills&&\n      !hero.classskills.includes(skill);\n  }\n  \n  buy(skill){\n    return this.iscrossclass(skill)?2:1;\n  }\n  \n  upgrade(skill){\n    if(!this.canupgrade(this.ranks[skill],skill)) return;\n    let cost=this.buy(skill);\n    hero.ranks-=cost;\n    this.ranks[skill]+=1;\n    hero.setranks(skill,this.ranks[skill]);\n    if(skill=='Profession'&&hero.level==1\n      &&this.ranks[skill]==1) hero.wealth+=1;\n  }\n  \n  canupgrade(value,skill){\n    if(skills.get(skill).pending) return false;\n    let cost=this.buy(skill);\n    return hero.ranks>=cost && value<3+hero.level;\n  }\n  \n  getability(skill){\n    return skill.ability.substring(0,3).toUpperCase();\n  }\n}\n","import {useView} from 'aurelia-framework';\nimport {hero} from '../modules/character/character';\nimport {Class} from '../modules/character/class/class';\nimport {inject} from 'aurelia-framework';\nimport {BindingSignaler} from 'aurelia-templating-resources';\n\n@useView('./character-feats.html')\n@inject(BindingSignaler)\nexport class CharacterTalents {\n    constructor(BindingSignaler) {\n        this.signals=BindingSignaler;\n        this.viewname='Talents';\n    }\n    \n    bind(){\n      this.points=hero.talent;\n      this.talents=new Map();\n      for(let c in hero.classes)\n        for(let [name,talent] of Class.classes.get(c).talents)\n          this.talents.set(name,talent);\n    }\n\n    add(talent){\n        if(this.points==0) return;\n        this.points-=1;\n        hero.talent-=1;\n        talent.apply(hero);\n        this.signals.signal('update');\n    }\n    \n    validate(talent){\n        return this.points>0&&talent.validate(hero);\n    }\n    \n    getcurrent(){\n      let current=[];\n      for(let f of hero.feats) if(f.talent) current.push(f);\n      return current;\n    }\n    \n    getall(){return this.talents;}\n}\n","import {hero,sign} from './character/character'\nimport {console} from './cyberspace/console'\nimport {sound} from './sound'\nimport {SESSION} from './program/program';\nimport {grades as armor} from './program/armor';\nimport {grades as blade} from './program/weapon/blade';\nimport {grades as blaster} from './program/weapon/blaster';\nimport './program/cloak';\nimport {eject} from './program/eject';\nimport envinronment from '../environment';\n\nvar OK='';\nvar MEMORYUPGRADE=[+10,+5,+5,+5];\n\nclass Deck{\n  constructor(){\n    this.memory=10;\n    this.memoryused=0;\n    this.memorytemporary=0;\n    this.storage=20;\n    this.storageused=0;\n    this.deckgrade=1;\n    this.memorygrade=0;\n    this.storagegrade=0;\n    this.stealthgrade=0;\n    this.loaded=[];\n    this.programs=[];\n  }\n  \n  upgrade(checkgrade,currentgrade,purchasedc,installdc,\n    apply){\n      if(currentgrade==4)\n        return 'Already at maximum grade.';\n      let upgrade=currentgrade+1;\n      if(checkgrade&&upgrade>this.deckgrade) \n        return 'Requires a deck upgrade.';\n      purchasedc+=2*(upgrade-1);\n      if(hero.wealth<purchasedc-10) \n        return 'Requires '+(purchasedc-10)+'¥.';\n      installdc+=1*(upgrade-1);\n      if(hero.getelectronics()<installdc-10) \n        return 'Requires electronics '+sign(installdc-10)\n          +'.';\n      if(apply&&!hero.buy(purchasedc))\n        return 'Unexpected not buy error.';\n      return OK;\n  }\n  \n  upgradedeck(apply){\n    let result=this.upgrade(false,this.deckgrade,10,12,apply);\n    if(result==OK&&apply) this.deckgrade+=1;\n    return result;\n  }\n  \n  upgradememory(apply){\n    let result=\n      this.upgrade(true,this.memorygrade,9,14,apply);\n    if(result==OK&&apply){\n      this.memory+=MEMORYUPGRADE[this.memorygrade];\n      this.memorygrade+=1;\n    }\n    return result;\n  }\n  \n  upgradestorage(apply){\n    let result=\n      this.upgrade(true,this.storagegrade,8,14,apply);\n    if(result==OK&&apply){\n      this.storage+=10;\n      this.storagegrade+=1;\n    }\n    return result;\n  }\n  \n  upgradestealth(apply){\n    let result=\n      this.upgrade(true,this.stealthgrade,10,12,apply);\n    if(result==OK&&apply) this.stealthgrade+=1;\n    return result;\n  }\n  \n  assign(data){\n    for(let key in data){\n      if(key in this){\n        this[key]=data[key];\n      }\n    }\n  }\n  \n  sort(){\n    this.programs.sort((a,b)=>a.compare(b));\n    this.loaded.sort((a,b)=>a.compare(b));\n  }\n  \n  getload(){\n    let load=this.memoryused/this.memory;\n    if(load>=.75) return 2;\n    if(load>=.5) return 1;\n    return 0;\n  }\n  \n  connect(system){ //refresh effects for loaded programs\n    let loaded=this.loaded;\n    this.loaded=[];\n    for(let program of loaded){\n      program.load(system,true);\n    }\n  }\n  \n  disconnect(){\n    this.memoryused=0;\n    this.memorytemporary=0;\n    this.storageused=0;\n  }\n  \n  getfreestorage(){return this.storage-this.storageused;}\n  \n  act(roll,system){ //called once per turn\n    for(let program of deck.loaded.slice())\n      if(program.duration!=SESSION){\n        program.duration-=1;\n        if(program.duration>0) continue;\n        sound.play(sound.UNLOAD);\n        console.print(program.name+' expired...');\n        program.unload(system);\n      }\n    for(let program of deck.loaded.slice())\n      if(roll<program.hackingdc){\n        sound.play(sound.UNLOAD);\n        console.print('You failed to keep '+program.name+\n          ' running...');\n        program.unload(system);\n      }\n  }\n}\n\nexport var deck=new Deck();\nfor(let program of [armor[0],blaster[0],eject]){\n  if(!program.buy()&&envinronment.debug)\n    throw 'Cannot buy '+program.name;\n  deck.loaded.push(program);\n}\n","export var grades=['0','I','II','III','IV','V','VI','VII',\n'VIII','IX','X','XI'];\n","export var CRITICALHIT=9001;\nexport var CRITICALMISS=-CRITICALHIT;\n\nclass Rpg{\n    constructor(){}\n    \n    r(min,max){\n      return Math.floor(Math.random()*(max-min+1))+min;\n    }\n    \n    d(dice,sides){\n      let sum=0;\n      for(let i=0;i<dice;i++){\n          sum+=this.r(1,sides);\n      }\n      return sum;\n    }\n    \n    choose(list){return list[this.r(0,list.length-1)];}\n    \n    chancein(n){return this.r(1,n)==1;}\n    \n    shuffle(array){\n      for (let i=array.length-1;i>0;i--) {\n        let j=this.r(0,i);\n        let swap=array[i];\n        array[i]=array[j];\n        array[j]=swap;\n      }\n      return array;\n    }\n    \n    randomize(amount){\n      return this.r(1,amount)-this.r(1,amount);\n    }\n}\n\nexport var rpg=new Rpg();\n","import {hero} from './character/character';\nimport environment from '../environment';\nimport {deck} from './deck';\nimport {PROGRAMS} from './program/program';\n\nvar DEBUG=false&&environment.debug;\n\nclass Save{\n  constructor(){}\n  \n  checkload(){\n    return localStorage.getItem('infojack-save');\n  }\n  \n  debug(){\n    if(!DEBUG) return;\n    let data=this.checkload();\n    if(data) alert(data);\n  }\n\n  saveprograms(programs){\n    return programs.map(p=>p.name);\n  }\n  \n  save(){\n    let data={};\n    data.hero=hero;\n    data.deck=Object.assign({},deck);\n    data.deck.loaded=this.saveprograms(data.deck.loaded);\n    data.deck.programs=this.saveprograms(data.deck.programs);\n    localStorage.setItem('infojack-save',\n      JSON.stringify(data));\n    this.debug();\n  }\n\n  loadprograms(deck){\n    let programs=[];\n    let loaded=[];\n    for(let name of deck.programs){\n      let p=PROGRAMS.get(name);\n      programs.push(p);\n      if(deck.loaded.indexOf(name)>=0) loaded.push(p);\n    }\n    deck.programs=programs;\n    deck.loaded=loaded;\n  }\n  \n  populate(data){\n    hero.assign(data.hero);\n    deck.assign(data.deck);\n    this.loadprograms(deck);\n    this.debug();\n  }\n  \n  load(){\n    let data=this.checkload();\n    if(!data) return false;\n    data=JSON.parse(data);\n    this.populate(data);\n    this.initialize();\n    return true;\n  }\n\n  initialize(){}\n\n  clear(){localStorage.setItem('infojack-save','');}\n}\n\nexport var save=new Save();\n","var PREFIX='./sounds/';\n\nvar queue=[];\nvar running=false;\n\nclass Sound{\n  constructor(){\n    this.ALERTCANCEL='CancelAlert.wav';\n    this.ALERTRED='RedAlert.wav';\n    this.ALERTYELLOW='YellowAlert.wav';\n    this.CONNECT='Dialup.wav';\n    this.CRASH='Spike.wav';\n    this.DISABLE='CancelAlert.wav';\n    this.DISCONNECTED='EndOfLine.wav';\n    this.ERROR='Computer Error Alert-SoundBible.com-783113881.mp3';\n    this.ICEATTACK='Pulse1.wav';\n    this.ICEDEATH='Error.wav';\n    this.ICEENTER='ICEEnter.wav';\n    this.ICELEAVE='ICEEnter.wav';\n    this.LOAD='Misc2.wav';\n    this.MOVE='Move.wav';\n    this.SCAN='Ping.wav';\n    this.SUCCESS='Deceive.wav';\n    this.QUERY='ICELeave.wav';\n    this.UNLOAD='Misc5.wav';\n  }\n  \n  process(){\n    if(queue.length==0){\n      running=false;\n      return;\n    }\n    running=true;\n    let a=new Audio(queue.shift());\n    let me=this;\n    a.onended=function(){me.process();};\n    a.play();\n  }\n    \n  play(file){\n    file=PREFIX+file;\n    if(queue.indexOf(file)>=0) return;\n    queue.push(file);\n    if(!running) this.process();\n  }\n  \n  clear(){queue=[];}\n}\n\nexport var sound=new Sound();\n","export function configure(config) {\n  //config.globalResources([]);\n}\n","import {occupations} from './occupation';\nimport {webcrawler} from './class/webcrawler';\nimport {skills} from './skill';\nimport {feats} from './feat';\nimport {rpg} from '../rpg';\nimport environment from '../../environment';\n\nvar ABILITYPOINTS=\n  Math.round((15+4*6)/(environment.fullattributes?1:2));\n\nexport var costs={\n    7:-4,\n    8:-2,\n    9:-1,\n    10:0,\n    11:1,\n    12:2,\n    13:3,\n    14:5,\n    15:7,\n    16:10,\n    17:13,\n    18:17,\n}\n\nexport class Character{\n  constructor(name){\n    this.name=name;\n    this.image=rpg.r(0,environment.playeravatars-1);\n    this.hp=0;\n    this.maxhp=0;\n    this.strength=7;\n    this.dexterity=7;\n    this.constitution=7;\n    this.intelligence=7;\n    this.wisdom=7;\n    this.charisma=7;\n    this.pointbuy=ABILITYPOINTS;\n    this.pointextra=0;\n    this.wealth=5; //average of 2d4 to prevent scumming\n    if(environment.wealth) this.wealth=environment.wealth;\n    this.classskills=[];\n    this.classes={};//holds levels\n    this.level=0;\n    this.ranks=0;\n    this.bab=0;//only primary BAB\n    this.edgedice=[0,0];//0d1\n    this.edge=0;//current edge\n    this.fort=0;\n    this.ref=0;\n    this.will=0;\n    this.defence=0;\n    this.init=0;\n    this.speed=30;\n    this.talent=0;\n    if(environment.extratalents)\n      this.talent+=environment.extratalents;\n    this.contacts=0;//TODO\n    this.feats=[];\n    this.newfeats=2;\n    for(let s of skills.values()){\n      this[s.name.replace(' ','').toLowerCase()]=0;\n    }\n  }\n\n  assign(data){\n    for(let key in data){\n      if(key in this){\n        this[key]=data[key];\n      }\n    }\n  }\n  \n  setoccupation(occupation){\n      this.wealth+=occupation.wealth;\n      for(let s of occupation.skills){\n          this.addclassskill(s);\n      }\n  }\n  \n  addclassskill(s){\n      if(this.classskills.indexOf(s)<0){\n          this.classskills.push(s);\n      }\n  }\n  \n  connect(){\n    let avatar=new Character();\n    Object.assign(avatar,this);\n    if(this.classes['Webcrawler']) avatar.enhance();\n    return avatar;\n  }\n  \n  enhance(){\n    this.strength=Math.max(this.strength,this.intelligence);\n    this.dexterity=Math.max(this.dexterity,this.wisdom);\n    let constitution=this.constitution;\n    this.constitution=Math.max(\n      this.constitution,this.charisma);\n    for(let con=this.constitution+1;con<=constitution;con++)\n      if(con%2==0) this.maxhp+=this.level;\n    this.hp=this.maxhp;\n    let level=this.classes['Webcrawler'];\n    this.bab-=[0,1,1,2,2,3,3,4,4,5][level-1];\n    this.bab+=level;\n  }\n  \n  getmodifier(ability){\n      if(ability%2==1){\n          ability-=1;\n      }\n      return (ability-10)/2;\n  }\n  \n  getranks(name){\n      return this[name.replace(' ','').toLowerCase()];\n  }\n  \n  setranks(name,value){\n      this[name.replace(' ','').toLowerCase()]=value;\n  }\n  \n  hasfeat(f){\n      f=f.name||f;\n      for(let feat of this.feats)\n        if(feat.name.toLowerCase()==f.toLowerCase())\n          return feat;\n      return false;\n  }\n  \n  addfeat(f){this.feats.push(f);}\n  \n  getskill(ranks,ability,feat,featbonus){\n    if(environment.debug&&ranks===undefined)\n      throw 'Unkwnown skill!';\n    if(feat&&this.hasfeat(feat)) ranks+=featbonus;\n    ranks=ranks+this.getmodifier(ability);\n    return ranks;\n  }\n  \n  getbluff(){\n    return this.getskill(this.bluff,this.charisma,'power of belief',1);\n  }\n  \n  getconcentration(){\n      return this.getskill(\n        this.concentration,this.constitution,false,0);\n  }\n  \n  getdecryption(){\n    let decryption=this.getskill(\n      this.decryption,this.intelligence,'studious',2);\n    if(this.hasfeat('power of belief')) decryption+=1;\n    return decryption;\n  }\n  \n  getelectronics(){\n      return this.getskill(\n        this.electronics,this.intelligence,false,0);\n  }\n  \n  getforgery(){\n      return this.getskill(\n        this.forgery,this.intelligence,'meticulous',2);\n  }\n  \n  getinformation(){\n      return this.getskill(\n        this.information,this.charisma,'trustworthy',3);\n  }\n  \n  gethacking(){\n      return this.getskill(\n        this.hacking,this.intelligence,\n        'specialized equipment',1);\n  }\n  \n  getperceive(){\n      return this.getskill(\n        this.perceive,this.wisdom,false,0);\n  }\n  \n  getmedicine(){\n      return this.getskill(\n        this.medicine,this.wisdom,false,0);\n  }\n  \n  getstealth(){\n    let stealth=this.getskill(\n      this.stealth,this.dexterity,'stealthy',3);\n    if(this.hasfeat('power of belief')) stealth+=1;\n    return stealth;\n  }\n  \n  getprofession(){\n    return this.getskill(\n      this.profession,this.wisdom,false,0);\n  }\n  \n  getresearch(){\n      return this.getskill(\n        this.research,this.intelligence,'studious',2);\n  }\n  \n  getsearch(){\n    let search=this.getskill(\n      this.search,this.intelligence,'meticulous',2);\n    if(this.hasfeat('power of belief')) search+=1;\n    return search;\n  }\n  \n  gettechnology(){\n      return this.getskill(\n        this.technology,this.intelligence,'educated',3);\n  }\n  \n  getfortitude(){\n    return this.fort+this.getmodifier(this.constitution);\n  }\n  \n  getreflexes(){\n    return this.ref+this.getmodifier(this.dexterity);\n  }\n  \n  getwill(){\n    return this.will+this.getmodifier(this.wisdom);\n  }\n  \n  getinitiative(){\n    let init=this.init+this.getmodifier(this.dexterity);\n    if(this.hasfeat('improved initiative')) init+=4;\n    return init;\n  }\n  \n  getdefence(){\n    return 10+this.defence+this.getmodifier(this.dexterity);\n  }\n  \n  getmelee(){\n    return this.bab+this.getmodifier(this.strength);\n  }\n  \n  getranged(){\n    return this.bab+this.getmodifier(this.dexterity);\n  }\n  \n  price(purchasedc){\n    let price=purchasedc>=15?1:0;\n    let difference=purchasedc-this.wealth;\n    if(difference<1) return price;\n    if(difference<=10) return price+1;\n    price+=difference-10;\n    return price>12?12:price; \n  }\n  \n  /*TODO gather information takes 1 hour per purchasedc\n    * use this to find items of interest (1 store per type of buy: programs, deck, cyber) and create as many options until the total purchasedc is equal or bigger than 16 in a day (or 24h with manual sleeping/tired routines). Each gather information roll returns the maximum purchasedc of the found object (or manybe result-10).\n    * */\n  buy(purchasedc){\n    if(10+this.wealth<purchasedc) return false;\n    this.wealth-=this.price(purchasedc);\n    if(this.wealth<0) this.wealth=0;\n    return true;\n  }\n  \n  sell(purchasedc){ /*-3 for selling, -3 for illegal*/\n    let price=this.price(purchasedc-3-3);\n    this.wealth+=price;\n    return price;\n  }\n  \n  /* As per level-up rules, in Infojack may be used to\n    * represent mission payment values or similar. TODO */\n  upgradewealth(){\n    let taketen=10+this.getprofession();\n    if(taketen<this.wealth) return 0;\n    let wealth=1;\n    taketen-=this.wealth;\n    while(taketen>=5){\n      wealth+=1;\n      taketen-=5;\n    }\n    return wealth;\n  }\n  \n  possess(){\n    let letter=this.name[this.name.length-1].toLowerCase();\n    let name=this.name+\"'\";\n    if(letter!='s') name+='s';\n    return name;\n  }\n  \n  move(){return .5*30/this.speed;}\n  \n  updateranks(ability){//call after adding 1 ability point\n    if(ability=='intelligence'&&this[ability]%2==0)\n      this.ranks+=this.level==1?4:1;\n  }\n  \n  learnability(ability){\n    if(this[ability]===undefined)\n      throw 'Unknown ability '+ability;\n    if(!this.pointextra) return false;\n    this[ability]+=1;\n    this.pointextra-=1;\n    this.updateranks(ability);\n    return true;\n  }\n  \n  learnskill(skill){\n    skill=skill.replace(' ','').toLowerCase();\n    if(this[skill]===undefined)\n      throw 'Unknown skill '+skill;\n    if(!this.ranks) return false;\n    while(this[skill]<this.level+3&&this.ranks>0){\n      this[skill]+=1;\n      this.ranks-=1;\n    }\n    return true;\n  }\n  \n  learnfeat(name){\n    let feat=feats.get(name.toLowerCase());\n    if(!feat) throw 'Unkwnown feat: '+name;\n    if(!this.newfeats) return false;\n    if(!feat.validate(this)) throw 'Invalid feat: '+name;\n    this.addfeat(feat);\n    this.newfeats-=1;\n    return true;\n  }\n  \n  levelup(){\n    if(this.level==10) return false; //TODO\n    webcrawler.advance(hero);\n    return true;\n  }\n}\n\nexport function sign(n){return n>=0?'+'+n:n;}\n\nexport var hero=new Character('Player1');\nhero.setoccupation(occupations.adventurer);\nhero.levelup(); //becomes level 1\nhero.buy(10);//basic deck\n//TODO ideal program list: flicker,blade,cloak\n","export var feats=new Map();\n\nexport class Feat{\n    constructor(name,description){\n        this.name=name;\n        this.description=description;\n        this.talent=false;\n    }\n    \n    validate(character){\n        return !character.hasfeat(this);\n    }\n    \n    apply(character){\n        character.addfeat(this);\n    }\n}\n\nexport class Talent extends Feat{\n  constructor(name,description){\n    super(name,description);\n    this.talent=true;\n  }\n}\n\nclass Educated extends Feat{\n    constructor(){\n        super('Educated','+3 to Techonology rolls');\n    }\n}\n\nclass Meticulous extends Feat{\n    constructor(){\n        super('Meticulous','+2 to Forgery and Search rolls');\n    }\n}\n\nclass Stealthy extends Feat{\n    constructor(){\n        super('Stealthy','+3 to Stealth rolls');\n    }\n}\n\nclass Studious extends Feat{\n    constructor(){\n        super('Studious','+2 to Decrypt and Research rolls');\n    }\n}\n\nclass Trustworthy extends Feat{\n    constructor(){\n        super('Trustworthy','+3 to Information rolls');\n    }\n}\n\nclass ImprovedInitiative extends Feat{\n   constructor(){\n        super('Improved initiative',\n              '+4 to initiative rolls');\n    }\n}\n\nclass Toughness extends Feat{\n  constructor(){\n    super('Toughness',\n      '+3 hit points (may be taken multiple times)');\n  }\n  validate(character){return true;}\n  apply(character){\n    character.maxhp+=3;\n    character.hp+=3;\n  }\n}\n\nclass Windfall extends Feat{\n  constructor(){\n    super('Windfall',\n      '+3 wealth (may be taken multiple times)');\n  }\n  validate(character){return true;}\n  apply(character){character.wealth+=3;}\n}\n\nfor(let feat of [\n    new Educated(),\n    new ImprovedInitiative(),\n    new Meticulous(),\n    new Stealthy(),\n    new Stealthy(),\n    new Studious(),\n    new Toughness(),\n    new Trustworthy(),\n    new Windfall(),\n]) feats.set(feat.name.toLowerCase(),feat);\n","import {skills,checkskills} from './skill';\n\nclass Occupation{\n  constructor(wealth,skillsp){\n    this.wealth=wealth;\n    this.skills=skillsp;\n    checkskills(skillsp);\n  }\n}\n\nexport var occupations={};\n\n//adventurer gives you a choice of Feat but none of them are easy to add to the game. Maybe pick other occupation?\noccupations.adventurer=new Occupation(+1,['Bluff','Technology','Stealth','Perceive','Medicine']);\n","/*A couple skills here are cross-class but they're too few to bother enforcing the rules properly. Also the Adventurer occupation gives you 2 extra skills from a list to use as cross class. Those skill aren't there but it evens out anyway since that isn't being taken into account currently.\n \nCross skills are actually implemented on character-abilities.html but disabled.*/\n\nclass Skill{\n  constructor(name,ability,description,pending=false){\n    this.name=name;\n    this.ability=ability; //used only as a label\n    this.description=description;\n    this.pending=pending;\n    if(pending) console.log('Pending: '+this.name); //TODO\n  }\n}\n\nexport var skills=new Map();\n\nfor (let skill of [\n    new Skill('Bluff','Charisma',\n        \"Convince ICE you're not an intruder\"),\n    new Skill('Concentration','Constitution',\n        \"Ignore system alert penalties\"),\n    new Skill('Decryption','Intelligence',\n        \"Break into protected data\"),\n    new Skill('Electronics','Intelligence',\n        \"Install hardware\"),\n    new Skill('Forgery','Intelligence',\n        \"Forge authentication credentials\"),\n    new Skill('Hacking','Intelligence',\n        \"Act on the Web\"),\n    new Skill('Information','Charisma',\n        \"Find more shopping items and missions\"),\n    new Skill('Medicine','Wisdom',\n        \"Treat your injuries\",true),\n    new Skill('Perceive','Wisdom',\n        \"Passive node scanning.\"),\n    new Skill('Profession','Wisdom',\n        \"Earn more money per contract\"),\n    new Skill('Research','Intelligence',\n        \"Do perimeter checks on Frames\",true),\n    new Skill('Search','Intelligence',\n        \"Active node scanning.\"),\n    new Skill('Stealth','Dexterity',\n        \"Avoid being detected on the Web\"),\n    new Skill('Technology','Intelligence',\n        \"Create your own programs\"),\n]){\n    skills.set(skill.name,skill);\n}\n\nexport function checkskills(ss){\n    for(let s of ss) if(!skills.get(s)) alert('Unknown skill: '+s);\n    return ss;\n}\n","class Message{\n  constructor(text,system){\n    this.text=text;\n    this.alert=system.alert;\n  }\n}\n\nclass Console{\n  constructor(){\n    this.messages=[];\n    this.system=false;\n  }\n  \n  print(message){\n    if(this.system)\n      this.messages.push(new Message(message,this.system));\n  }\n  \n  next(){return this.messages.shift();}\n  \n  log(...args){window.console.log(...args);}\n}\n\nexport var console=new Console();\n","import {rpg} from '../rpg';\nimport {Node} from './node/node';\nimport {Datastore} from './node/datastore';\nimport {Cpu} from './node/cpu';\nimport {Portal} from './node/portal';\nimport {Interface} from './node/interface';\nimport environment from '../../environment';\nimport {Ice} from './avatar/ice/ice';\nimport {Scout} from './avatar/ice/scout';\nimport {Greeter} from './avatar/ice/greeter';\nimport {Bouncer} from './avatar/ice/bouncer';\nimport {Tracer} from './avatar/ice/tracer';\nimport {console} from './console';\nimport {sound} from '../sound';\nimport {deck} from '../deck';\nimport {Player,events} from './avatar/player';\nimport {INITIAL as RESET} from './avatar/secure/shutdown';\n\nconst ICECOMMON=[Scout,Greeter,Bouncer];\nconst ICERARE=[Tracer];\n\nexport class System{\n  constructor(name,level,business,depth){\n    this.name=name;\n    this.level=level;\n    this.business=business;\n    this.depth=depth;//0=entry level\n    if(this.level<1) this.level=1;\n    else if(this.level>20) this.level=20;\n    this.alert=0;\n    this.shutdown=RESET;\n    this.nodes=[];\n    this.ice=[];\n    this.reentry=[];\n    this.entrance=null;\n    this.revealed=false; //reveal all map\n    this.backdoor=false;\n    this.disconnected=false; //throw this if set\n  }\n  \n  generate(){\n    this.generatemap();\n    this.definenodes();\n    for(let n of this.nodes) n.generate();\n    this.generateice();\n  }\n\n  debug(){\n    if(environment.revealmap) this.reveal();\n    if(environment.scannodes) for(let n of this.nodes)\n      for(let a of n.avatars.slice()) if(!a.scanned){\n        a.scan();\n        a.scanned=true;\n      }\n  }\n\n  getnode(x,y){\n    for(let n of this.nodes) if(x==n.x&&y==n.y) return n;\n    return null;\n  }\n\n  generatemap(){\n    this.nodes.push(new Cpu(0,0,this,true));\n    let size=rpg.r(3,7)+this.level;\n    let leastx=0;\n    let leasty=0;\n    while(this.nodes.length<size){\n      let n=rpg.choose(this.nodes);\n      if(rpg.chancein(5-n.getneighbors().length)) continue;\n      let x=n.x;\n      let y=n.y;\n      if(rpg.chancein(2)) x+=rpg.chancein(2)?+1:-1;\n      else y+=rpg.chancein(2)?+1:-1;\n      if(this.getnode(x,y)) continue;\n      this.nodes.push(new Node(x,y,this));\n      if(x<leastx) leastx=x;\n      if(y<leasty) leasty=y;\n    }\n    for(let n of this.nodes){ //ensure node.x>=0 node.y>=0\n      n.x-=leastx;\n      n.y-=leasty;\n    }\n  }\n\n  replacenode(target,i){\n    let original=this.nodes[i];\n    target.id=original.id;\n    target.x=original.x;\n    target.y=original.y;\n    this.nodes[i]=target;\n  }\n\n  //returns all nodes with the given number of exits\n  findportals(exits){\n    return this.nodes.filter(\n      n=>n.id!=0&&n.getneighbors().length==exits);\n  }\n\n  generatenode(){\n    if(rpg.chancein(10)) return new Cpu(-1,-1,this);\n    if(rpg.chancein(3)) return new Interface(-1,-1,this);\n    return new Datastore(-1,-1,this);\n  }\n\n  defineportals(){\n    this.entrance=new Portal(-1,-1,this);\n    let portals=[this.entrance];\n    if(this!=this.business.mainframe){\n      let branches=this.business.systems[this.depth+1];\n      for(let branch of branches)\n        portals.push(new Portal(-1,-1,this,branch));\n    }\n    rpg.shuffle(portals);\n    for(let exits=1;portals.length>0;exits++){\n      let nodes=this.findportals(exits);\n      rpg.shuffle(nodes);\n      while(portals.length>0&&nodes.length>0)\n        this.replacenode(portals.pop(),nodes.pop().id);\n    }\n  }\n  \n  definenodes(){\n    this.defineportals();\n    for(let n of this.nodes){\n      if(n instanceof Portal) continue;\n      let neighbors=n.getneighbors().length;\n      let corridor=neighbors>2&&rpg.chancein(5-neighbors);\n      if(corridor) continue;\n      this.replacenode(this.generatenode(),n.id);\n    }\n  }\n\n  reveal(){\n    this.revealed=true;\n    for(let n of this.nodes) n.visited=true;\n    this.player.fireevent(events.MAPREVEALED);\n  }\n\n  notifyalert(previous){\n    let cancelling=this.alert<previous;\n    if(cancelling) sound.play(sound.ALERTCANCEL);\n    if(this.alert==0)\n      console.print('The alert is cleared.');\n    else if(this.alert==1){\n      console.print('The system is now in yellow alert...');\n      if(!cancelling) sound.play(sound.ALERTYELLOW);\n    }else{\n      console.print('The system is now in red alert!');\n      if(!cancelling) sound.play(sound.ALERTRED);\n    }\n  }\n\n  raisealert(raise=+1,silent=false){\n    let previous=this.alert;\n    this.alert+=raise;\n    if(this.alert>2) this.alert=2;\n    else if(this.alert<0) this.alert=0;\n    if(this.alert==2) this.player.credentials=-20;\n    else this.shutdown=RESET;\n    if(!silent&&this.alert!=previous)\n      this.notifyalert(previous);\n  }\n\n  generateice(){\n    let types=ICECOMMON.slice();\n    let rarechance=Math.round(20/this.level);\n    for(let rare of ICERARE) if(rpg.chancein(rarechance))\n      types.push(rare);\n    let budget=this.level*4;//TODO alternative approach\n    let passes=Math.min(this.level,4);\n    for(let pass=0;pass<passes;pass++){\n      let level=this.level;\n      let quantity=1;\n      let doublings=rpg.r(1,4);\n      for(let i=1;i<doublings&&level>=3;i++){\n        level-=2;\n        quantity*=2;\n      }\n      let type=rpg.choose(types);\n      for(let i=0;i<quantity;i++){\n        this.ice.push(new type(this,level));\n      }\n    }\n  }\n\n  //guarantees same ice placement for non-random deployment\n  deployice(){\n    let random=[];\n    for(let i of this.ice){\n      let nodes=this.nodes.slice();\n      nodes.sort((a,b)=>{\n        let na=a.avatars.filter(x=>x instanceof Ice).length;\n        let nb=b.avatars.filter(x=>x instanceof Ice).length;\n        return (b.priority-nb)-(a.priority-na);\n      });\n      for(let n of nodes) if(i.deploy(n)){\n        i.enter(n);\n        break;\n      }\n      if(!i.node) random.push(i);\n    }\n    for(let ice of random)\n      ice.enter(rpg.choose(this.nodes));\n  }\n\n  act(){ //return false when it's the player's turn\n    if(this.disconnected) throw this.disconnected;\n    let next=this.player;\n    for(let n of this.nodes) for(let a of n.avatars)\n      if(a.ap<next.ap) next=a;\n    next.act();\n    return next!=this.player;\n  }\n\n  connect(){\n    this.player=new Player(this);\n    deck.connect(this);\n    this.raisealert(-1,true); //TODO once per day, not immediate\n    console.system=this;\n    this.player.connect();\n    this.player.enter(this.backdoor||this.entrance);\n    if(!environment.noice) this.deployice();\n    this.debug();\n  }\n\n  disconnect(e){\n    console.system=false;\n    this.disconnected=false;\n    this.revealed=false;\n    this.player.disconnect(e)\n    this.player=false;\n    for(let ice of this.reentry) this.ice.push(ice);\n    this.reentry=[];\n    for(let n of this.nodes) n.reset();\n    deck.disconnect();\n    if(rpg.chancein(30-this.level)) this.backdoor=false;\n  }\n}\n","import {Program,SESSION,PROGRAMS} from './program';\nimport {console} from '../cyberspace/console';\n\nclass Armor extends Program{\n  constructor(grade){\n    super('Armor',grade,'armor.png',1,4,10,20);\n    this.duration=SESSION;\n    this.defence=+4+(grade-1);\n  }\n  \n  modify(bonus,player){\n    player.character.defence+=bonus;\n    console.print('Your defence is now '+\n      player.character.getdefence()+'.');\n  }\n  \n  load(system){\n    if(!super.load(system)) return false;\n    this.modify(this.defence,system.player);\n    return true;\n  }\n  \n  unload(system){\n    if(!super.unload(system)) return false;\n    this.modify(-this.defence,system.player);\n    return true;\n  }\n  \n  describe(){\n    return 'Adds +'+this.defence+' to defence';\n  }\n  \n  run(system){console.print(\"Armor is already active.\");}\n}\n\nexport var grades=[];\n\nfor(let armor=+4;armor<=+10;armor++)\n  grades.push(new Armor(armor-3));\n","import {Program} from './program';\nimport {console} from '../cyberspace/console';\nimport {events} from '../cyberspace/avatar/player';\nimport {sign} from '../character/character';\n\nclass Cloak extends Program{\n  constructor(){\n    super('Cloak',false,'cloak.png',3,6,13,25);\n    this.apcost=1;\n  }\n  \n  apply(modifier,player){\n    let c=player.character;\n    c.stealth+=modifier;\n    console.print('Your stealth is now: '+\n      sign(c.getstealth())+'.');\n  }\n  \n  load(system){\n    if(!super.load(system)) return false;\n    this.apply(+5,system.player);\n    return true;\n  }\n  \n  unload(system){\n    if(!super.unload(system)) return false;\n    this.apply(-5,system.player);\n    return true;\n  }\n  \n  describe(){\n    return 'Stealth +5 (unloads on attack or file open)';\n  }\n  \n  onevent(e,system){\n    if(e==events.ATTACK||e==events.OPENFILE){\n      this.unload(system);\n    }\n  }\n}\n\nnew Cloak();\n","import {Program} from './program';\nimport {Disconnect} from '../../messages';\n\nclass Eject extends Program{\n  constructor(name,grade,image,size,hack,buy,code){\n    super('Eject',0,'eject.png',1,4,6,10);\n  }\n  \n  describe(){return 'Disconnects from a system';}\n  \n  run(system){\n    if(window.confirm('Are you sure you want to leave?'))\n      system.disconnected=\n        new Disconnect('Ejection successful.');\n  }\n}\n\nexport var eject=new Eject();\n","import {deck} from '../deck';\nimport {grades} from '../grade';\nimport {console} from '../cyberspace/console';\nimport {hero} from '../character/character';\n\nexport const SESSION=Number.MAX_SAFE_INTEGER;\nexport const PROGRAMS=new Map();\n\n//For design parameters: https://github.com/tukkek/infojack/wiki/Program-parameters-reference\nexport class Program{\n  constructor(name,grade,image,size,hack,buy,code){\n    this.hackingdc=hack+10;\n    this.purchasedc=buy;\n    this.programmingdc=code;\n    this.size=size; //MBs / blocks\n    this.apcost=.5;\n    this.duration=SESSION; //0=instantaneous\n    this.basename=name;\n    this.name=name;\n    this.image='./images/software/'+image;\n    this.grade=grade;\n    if(grade){\n      this.name+=' '+grades[grade];\n      if(grade>1) this.upgrade(grade-1);\n    }\n    PROGRAMS.set(this.name,this);\n  }\n  \n  upgrade(ntimes){\n    this.hackingdc+=ntimes;\n    this.purchasedc+=ntimes;\n    this.programmingdc+=ntimes;\n    this.size+=ntimes/2;\n  }\n  \n  describe(){return this.name;}\n  \n  conflict(program){return this.basename==program.basename;}\n  \n  validate(){\n    for(let program of deck.loaded) \n      if(this.conflict(program)){\n        console.print(\n          'You cannot load '+this.name+' while '+\n            program.name+' is loaded...');\n        return false;\n      }\n    if(deck.memoryused+this.size>deck.memory){\n      console.print(\n        'This program requires '+this.size+' free blocks.');\n      return false;\n    }\n    return true;\n  }\n\n  boot(system){\n    let p=system.player;\n    let hack=p.roll(p.character.gethacking());\n    if(hack>=this.hackingdc)\n      return true;\n    console.print('You failed to load '+this.name+'...');\n    return false;\n  }\n  \n  load(system,safe=false){\n    if(!this.validate()) return false;\n    system.player.ap+=this.apcost;\n    if(!safe&&!this.boot(system)) return false;\n    console.print(this.name+' loaded.');\n    deck.memoryused+=this.size;\n    deck.loaded.push(this);\n    return true;\n  }\n  \n  unload(system){\n    let i=deck.loaded.indexOf(this);\n    if(i<0) return false;\n    console.print(this.name+' unloaded.');\n    system.player.ap+=this.apcost;\n    deck.memoryused-=this.size;\n    deck.loaded.splice(i,1);\n    return true;\n  }\n  \n  run(system){}\n  \n  compare(program){\n    if(this.basename==program.basename)\n      return this.grade-program.grade;\n    return this.basename.localeCompare(program.basename);\n  }\n  \n  buy(){\n    if(!hero.buy(this.purchasedc)) return false;\n    deck.programs.push(this);\n    return true;\n  }\n  \n  onevent(e){return;}\n}\n","//Corporation are the offline counterpart of Systems and they can be easily serialized, with system being regenerated. See GitHub issue #44.\n//TODO generate all available Corporations at save start, 1d4 per level (1-20). make sure names don't overlap.\nimport {name} from './names';\nimport {System} from '../cyberspace/system'\nimport {rpg} from '../rpg';\nimport {hero as offlinehero} from '../character/character';\nimport environment from '../../environment';\n\nconst LETTERS='ABCDEFGHIJKLMNOPQRSTUVXWYZ';\nconst DEBUG=environment.debug&&true;\n\nvar active=false;\n\n/* Each business has a certain depth, starting at depth 0 which is the entry-level System. Each System will have Portals to all the following depth's Systems (or none if at maximum depth already). The final depth contains only one System, representing the mainframe. */\nexport class Business{\n  constructor(level){\n    this.name=name(level);\n    this.level=level;\n    this.backdoor=false;\n    this.systems=[];\n    this.map();\n    for(let depth of this.systems) for(let system of depth) \n      system.generate();\n  }\n  \n  map(){\n    this.entry=\n      new System(this.name+' (entry)',this.level,this,0);\n    this.systems[0]=[this.entry];\n    let tier=Math.ceil(this.level/5);\n    let levels=tier+rpg.randomize(tier);\n    if(DEBUG) levels=tier;\n    for(let depth=1;depth<levels;depth++){\n      let l=[];\n      let ismainframe=depth==levels-1;\n      let branches=ismainframe?1:rpg.r(1,tier);\n      if(DEBUG&&!ismainframe) branches=tier;\n      for(let branch=0;branch<branches;branch++){\n        let name=this.name+' ('+depth+LETTERS[branch]+')';\n        let s=new System(name,this.level+depth,this,0+depth);\n        l.push(s);\n      }\n      this.systems[depth]=l;\n    }\n    this.mainframe=this.systems[this.systems.length-1][0];\n  }\n  \n  crash(system){active=false;}\n}\n\n/*Enters the entry-level System for this Business or exploits a backdoor.*/\nexport function connect(){\n  if(!active){\n    let level=environment.systemlevel||offlinehero.level;\n    active=new Business(level);\n  }\n  if(active.backdoor&&active.backdoor.backdoor)\n    return active.backdoor;\n  return active.entry;\n}\n\n","import {rpg} from '../rpg';\n\n//lower GDP to highest GDP\n//source: http://databank.worldbank.org/data/download/GDP.xls\n//TODO \"fictionalize\" more nation names\nvar NATIONALITIES=\n  ['Chilean','Pakistani','Colombian','Philippine','Malay','Singaporean','Danish','Irish','African','Zionist','Norse','Austrian','Iranian','Thai','Belgian','Polish','Swedish','Argentine','Swiss','Arabic','Dutch','Turkish','Indonesian','Aztec','Spanish','Australian','Korean','Russian','Canadian','Italian','Brazilian','French','Indian','British','German','Japanese','Chinese','American'];\n\n//from least to top revenue\n//source: https://eresearch.fidelity.com/eresearch/markets_sectors/sectors/sectors_in_market.jhtml\nvar INDUSTRIES=\n  ['Transportation','Distribution','Commerce','Utilities','Health','Finance','Energy','Construction','Finance','Services','Commerce','Construction','Transportation','Commerce','Finance','Auto','Transportation','Distribution','Finance','Commerce','Services','Energy','Electronics','Commerce','Tobacco','Communications','Transportation','Foods','Commerce','Finance','Communication','Foods','Auto','Energy','Commerce','Machinery','Tourism','Transportation','Distribution','Military','Chemicals','Mining','Health','Foods','Media','Biotechnology','Communication','Real estate','Technology','Finance','Commerce','Insurance','Electronics','Pharmaceuticals','Technology','Fuel','Banking'];\n  \nfunction pick(level,array){\n  let range=rpg.r(10,25);\n  let reference=100*(level-1)/19;\n  let lower=reference-range;\n  if(lower<0) lower=0;\n  else if(lower>100-range) lower=100-range;\n  let higher=reference+range;\n  if(higher>100) higher=100;\n  else if(higher<range) higher=range;\n  lower=Math.round(lower);\n  higher=Math.round(higher);\n  let roll=rpg.r(lower,higher);\n  let index=Math.round((array.length-1)*roll/100);\n  return array[index];\n}\n  \nexport function name(level){\n  if(level<1) level=1;\n  else if(level>20) level=20;\n  return pick(level,NATIONALITIES)+' '+pick(level,INDUSTRIES).toLowerCase();\n}\n","/* TODO \n * - for advanced classes, have edge dice as part of levelup\n */\n\nimport {checkskills} from '../skill';\nimport {rpg} from '../../rpg';\nimport {webcrawler} from './webcrawler';\n\nexport class Class{\n    constructor(){this.talents=new Map();}\n    \n    advance(character){\n        let level=character.classes[this.name];\n        if(!level) level=0;\n        level+=1;\n        if(level>10) {\n            throw 'Cannot advance past level 10!';\n        }\n        character.level+=1;\n        this.levelup(character,level);\n        character.classes[this.name]=level;\n    }\n    \n    upgradehp(character){\n      if(character.level==1){\n          character.maxhp=this.hd;\n          character.hp=character.maxhp;\n      }else{\n          let hp=Math.round((1+this.hd)/2);\n          character.maxhp+=hp;\n          character.hp+=hp;\n      }\n    }\n    \n    upgraderanks(character,classlevel){\n      let ranks=this.ranks+\n        character.getmodifier(character.intelligence);\n      character.ranks+=Math.max(1,ranks);\n      if(character.level==1) character.ranks*=4;\n      if(classlevel==1) for(let s of this.skills)\n        character.addclassskill(s);\n    }\n    \n    levelup(character,classlevel){\n      for(let stat of ['bab','fort','ref','will','defence'])\n        this.upgradestat(classlevel,stat,character);\n      this.upgradeedgedice(classlevel,character);\n      this.upgradereputation(character,classlevel);\n      this.upgradehp(character);\n      this.upgraderanks(character,classlevel);\n      if(character.level%3==0) character.newfeats+=1;\n      if(character.level%4==0) character.pointextra+=1;\n      //TODO may want to do this through external means to make it explicit to the player (as mission payment rates for example):\n      if(character.level>1) character.upgradewealth(); \n    }\n    \n    upgradestat(level,stat,character){\n        let last=level>1?this[stat][level-2]:0;\n        let current=this[stat][level-1];\n        character[stat]+=current-last;\n    }\n    \n    upgradeedgedice(level,character){\n        let target=this.edgedice[level-1].split('d');\n        target=[parseInt(target[0]),parseInt(target[1])];\n        if(target[0]>character.edgedice[0]||\n          (target[0]==character.edgedice[0]&&\n            target[1]>=character.edgedice[1]))\n              character.edgedice[0]=target[0];\n              character.edgedice[1]=target[1];\n        if(character.level==1) \n          character.edge+=character.edgedice[0];\n    }\n    \n    upgradereputation(character,level){\n        if(level==1){\n            if(this.reputation[0]>0){\n                //TODO boost\n            }\n        }else if(this.reputation[level-1]>\n                this.reputation[level-2]){\n            //TODO boost\n        }\n    }\n    \n    check(skills){\n      return checkskills(skills);\n    }\n}\n\nClass.classes=new Map();\n","import {Talent} from '../feat'; \nimport {Class} from './class'; \n\nclass TheWebIsAlive extends Talent{\n  constructor(){\n    super('The web is alive',\n      'Adds Will to Perception rolls (requires level 3 and Power of Belief)');\n  }\n  \n  validate(character){\n    return super.validate(character)&&\n      character.level>=3&&\n      character.hasfeat('power of belief');\n  }\n}\n\nclass SpecializedEquipment extends Talent{\n  constructor(){\n    super('Specialized equipment',\n      '+1 to hacking rolls, +5 speed, safe disconnections (requires 4 in hacking, electronics and technology)');\n  }\n  \n  validate(character){\n    return super.validate(character)\n      &&character.hacking>=4\n      &&character.electronics>=4\n      &&character.technology>=4;\n  }\n  \n  apply(character){\n    super.apply(character);\n    character.speed+=5;\n  }\n}\n\nclass Webcrawler extends Class{\n    constructor(){\n        super();\n        this.name='Webcrawler';\n        this.skills=this.check(['Hacking', 'Electronics', 'Decryption', /*'Disable device',*/ 'Forgery', 'Technology', 'Profession', 'Research', 'Technology', 'Search']);\n        this.hd=4;\n        this.ranks=7;\n        this.bab=[0,1,1,2,2,3,3,4,4,5];\n        this.fort=[0,0,1,1,1,2,2,2,3,3];\n        this.ref=[1,2,2,2,3,3,4,4,4,5];\n        this.will=[1,2,2,2,3,3,4,4,4,5];\n        this.defence=[1,1,2,2,2,3,3,3,4,4];\n        this.reputation=[0,1,1,2,2,3,3,4,4,5];\n        this.edgedice=['1d4','1d4','2d4','2d6','2d6','3d6','3d8','3d8','4d8','4d10'];\n        let talents=[\n          new Talent('Hackmastery',\n            '+2 to all damage inflicted'),\n          new Talent('Phreakmastery',\n            'Safe connections, +1 against traces'),\n          new Talent('Power of belief',\n            '+1 to bluff, decryption, search and stealth'),\n          new SpecializedEquipment(),\n          new TheWebIsAlive(),\n          ];\n        for(let t of talents)\n          this.talents.set(t.name,t);\n    }\n    \n    levelup(character,classlevel){\n        super.levelup(character,classlevel);\n        let level=character.level;\n        if(level==1||level==3||level==6||level==9){\n            character.talent+=1;\n        }else if(level==4||level==7){\n            character.ranks+=1;\n        }else if(level==5||level==8){\n            character.contacts+=1;\n        }else if(level==10){\n            character.wealth+=5;\n            //TODO +5 reputation to law and hackers\n        }\n    }\n}\n\nexport var webcrawler=new Webcrawler();\nClass.classes.set(webcrawler.name,webcrawler);\n","import {rpg,CRITICALMISS,CRITICALHIT} from '../../rpg';\nimport {console} from '../console';\nimport {Character} from '../../character/character';\nimport {webcrawler} from '../../character/class/webcrawler';\nimport {occupations} from '../../character/occupation';\nimport {sound} from '../../sound';\nimport environment from '../../../environment';\n\nexport class Avatar{\n  constructor(system,level=system.level){\n    this.obfuscate();\n    this.system=system;\n    this.node=null;\n    this.x=-1;\n    this.y=-1;\n    this.create(webcrawler,occupations.adventurer,level);\n    this.character.enhance();\n    this.scandc=10+this.system.level;\n    this.rollinitiative();\n  }\n  \n  rollinitiative(){\n    this.ap=-(rpg.r(1,20)+this.character.getinitiative())/20;\n  }\n  \n  obfuscate(){\n    this.setname('A process');\n    this.setimage('nodes/process.png');\n    this.scanned=false;\n  }\n  \n  create(characterclass,occupation,level){\n    this.character=new Character();\n    this.character.setoccupation(occupation);\n    if(level>10){\n      console.log('Cannot raise avatar past level 10!');\n      level=10;\n    }\n    for(let i=0;i<level;i++) \n      characterclass.advance(this.character);\n    this.character.pointbuy=0;\n    this.character.pointextra=9;\n  }\n  \n  setname(name){\n    this.name=name;\n    this.tooltip=name;\n  }\n  \n  setimage(image){this.image='./images/'+image;}\n\n  enter(node){return node.enter(this);}\n  \n  click(){alert('Unimplemented.');}\n  \n  scan(){return true;}\n  \n  act(){this.ap+=.5;}\n  \n  describehealth(){\n    let health=this.character.hp/this.character.maxhp;\n    if(health<=0) return 'deallocated';\n    if(health==1) return 'unharmed';\n    if(health>=.5) return 'OK';\n    if(health>=.25) return 'unstable';\n    return 'critical';\n  }\n  \n  die(){this.leave(this.node);}\n  \n  damage(damage){\n    this.character.hp-=damage;\n    console.print(\n      this.name+' is '+this.describehealth()+'.');\n    if(this.character.hp<=0) this.die();\n  }\n  \n  hit(roll,bonus){\n    if(roll==1) return false;\n    if(roll==20) return true;\n    return roll+bonus>=this.character.getdefence();\n  }\n\n  //returns true on hit, false on miss\n  attack(bonus,target,damage,roll=false){\n    if(!roll) roll=rpg.r(1,20);\n    if(!target.hit(roll,bonus)) return false;\n    target.damage(damage);\n    return true;\n  }\n  \n  authenticate(){\n    let dc=10+this.character.getbluff();\n    let p=this.system.player;\n    return p.hide(this)||p.query(dc,this);\n  }\n  \n  hack(authenticate=false,roll=undefined){\n    let p=this.system.player;\n    p.ap+=1;\n    if(roll===undefined)\n      roll=p.roll(p.character.gethacking());\n    let discovered=authenticate&&!this.authenticate();\n    if(discovered||roll==CRITICALMISS){\n      this.system.raisealert(+1);\n      return false;\n    }\n    let dc=this.character.getdefence()+this.system.level;\n    if(environment.debug)\n      console.print('Hack: '+roll+' DC'+dc+'.');\n    if(roll==CRITICALHIT||roll>=dc) return true;\n    sound.play(sound.ERROR);\n    let name=this.name.toLowerCase();\n    console.print('You fail to hack: '+name+'...');\n    return false;\n  }\n  \n  leave(node){node.remove(this);}\n  \n  getserial(){\n    let serial=Number(rpg.r(0,9999)).toString();\n    while(serial.length<4) serial='0'+serial;\n    return serial;\n  }\n  \n  getscale(){ //a die size scaled to this level (d4 to d20)\n    let level=Math.min(20,this.character.level);\n    for(let die of [4,6,8,10,12,20]) if(level<=die)\n      return die;\n    throw 'Unknown damage level';\n  }\n  \n  reset(){\n    this.character.hp=this.character.maxhp;\n    this.rollinitiative();\n  }\n  \n  hide(){\n    this.node.hidden.push(this);\n    this.leave(this.node);\n  }\n  \n  show(){return true;}\n  \n  onevent(e){return;}\n}\n","import {Avatar} from './avatar';\nimport {rpg,CRITICALMISS} from '../../rpg';\nimport {console} from '../console';\nimport {deck} from '../../deck';\n\nexport class Control extends Avatar{\n  constructor(system){\n    super(system);\n    this.memory=rpg.chancein(2)?rpg.r(2,this.getscale()):0;\n    this.privilege=0;\n    while(rpg.chancein(2)) this.privilege+=1;\n  }\n  \n  scan(){\n    if(!this.memory&&!this.privilege) this.leave(this.node);\n    else{\n      this.setimage('nodes/control2.png');\n      this.setname('External device');\n    }\n  }\n  \n  abuse(){\n    if(this.memory){\n      console.print(\"You gain access to \"+this.memory+\n        \" blocks of memory!\");\n      deck.memorytemporary+=this.memory;\n      deck.memoryused-=this.memory;\n    }\n    if(this.privilege){\n      let p=this.system.player;\n      let result;\n      if(p.privilege<this.privilege){\n        p.privilege+=this.privilege;\n        result=\"Your privilege escalated to +\"\n          +this.privilege+\"!\";\n      }else result=\"You're already at privilege +\"+\n        p.privilege+'...';\n      console.print(result);\n    }\n    this.hide();\n  }\n  \n  click(){\n    let p=this.system.player;\n    let hacking=p.roll(p.character.gethacking());\n    if(hacking==CRITICALMISS){\n      console.print('You trigger an alarm!');\n      this.system.raisealert(+1);\n      return;\n    }\n    if(this.hack(hacking)) this.abuse();\n  }\n}\n","import {Avatar} from './avatar';\nimport {rpg,CRITICALMISS} from '../../rpg';\nimport {console} from '../console';\nimport {hero as offlinehero} from '../../character/character';\nimport {deck} from '../../deck';\nimport {events} from './player';\nimport {PROGRAMS} from '../../program/program';\n\nvar NOTDOWNLOADING=-1;\n\n//TODO would be great to have a filename generator based on the grade of the file\n//TODO have a chance of it being a program! (purchasedc==purchasedc)\nexport class File extends Avatar{\n  constructor(system){\n    super(system);\n    this.setname('Unscanned data');\n    this.setimage('nodes/fileunscanned.png');\n    this.purchasedc=system.level+rpg.randomize(4);\n    this.size=rpg.r(1,this.getscale());\n    this.downloading=NOTDOWNLOADING;\n    this.worthless=false;\n    this.program=false; //TODO need to serialize as name?\n    this.trap=false;\n    this.protected=false;\n    this.define();\n  }\n  \n  getprogram(){\n    let eligible=[];\n    for(let p of PROGRAMS.values()) if(this.purchasedc==p.purchasedc)\n      eligible.push(p);\n    return eligible.length==0?false:rpg.choose(eligible);\n  }\n  \n  define(){\n    let level=this.system.level;\n    if(this.purchasedc<1||rpg.chancein(level+1)){\n      this.worthless=true;\n      this.purchasedc=0;\n      return;\n    }\n    if(rpg.chancein(20)){\n     this.program=this.getprogram();\n     if(this.program){\n       this.size=this.program.size;\n       return;\n     }\n    }\n    if(rpg.chancein(60/level)){\n      this.trap=true;\n      return;\n    }\n    if(rpg.chancein(21/level)){\n      this.protected=true;\n      if(this.purchasedc<level)\n        this.purchasedc=level;\n      return;\n    }\n  }\n  \n  findtrap(){\n    if(!this.trap) return false\n    let p=this.system.player;\n    let perceive=p.roll(p.character.getperceive());\n    return perceive>=this.purchasedc;\n  }\n  \n  scan(){\n    this.scanned=true; //redundant (for File#setname)\n    if(this.worthless){\n      this.leave(this.node);\n      this.setname('Worthless data');\n    }else if(this.program){\n      this.setimage('nodes/fileprogram.png');\n      this.setname(this.program.name);\n    }else if(this.protected){\n      this.setimage('nodes/fileprotected.png');\n      this.setname('Encrypted data');\n    }else if(this.findtrap()){\n      this.setimage('nodes/filetrap.png');\n      this.setname('Trap data');\n    }else{\n      this.setimage('nodes/file.png');\n      this.setname('Unencrypted data');\n    }\n    if(this.node==this.system.player.node)\n      console.print('File scanned: '+this.name+'.');\n  }\n  \n  decrypt(){\n    if(!this.protected) return true;\n    let p=this.system.player;\n    let decrypt=p.roll(p.character.getdecryption());\n    if(decrypt==CRITICALMISS){\n      sound.play(sound.CRASH);\n      console.print('You destroy the file by accident!');\n      this.leave(this.node);\n      return false;\n    }\n    return this.hack(false,decrypt);\n  }\n  \n  validate(){\n    if(this.size>deck.getfreestorage())\n      return \"You need \"+this.size+\" free storage blocks.\";\n    if(this.program&&deck.programs.indexOf(this.program)>=0)\n      return 'You already have '+this.program.name+'.';\n    return false;\n  }\n  \n  download(){\n    let name=this.name+' '+this.getserial();\n    this.setname(name);\n    console.print('You start downloading '+name+\n      ' ('+this.size+' blocks)...');\n    this.downloading=0;\n    deck.storageused+=this.size;\n    this.ap=this.system.player.ap;\n  }\n  \n  spring(){\n    if(!this.trap) return false;\n    this.leave(this.node);\n    console.print('The file was a honeypot!');\n    this.system.raisealert(2);\n    return true;\n  }\n  \n  click(){\n    if(this.downloading!=NOTDOWNLOADING){\n      console.print('You are already downloading this.');\n      return;\n    }\n    let p=this.system.player;\n    p.fireevent(events.OPENFILE);\n    p.ap+=.5;\n    if(this.spring()) return;\n    let invalid=this.validate();\n    if(invalid){\n      console.print(invalid);\n      return;\n    }\n    p.ap+=.5;\n    if(this.decrypt()) this.download();\n  }\n  \n  transfer(){\n    if(this.program){\n      deck.programs.push(this.program);\n      console.print('You now have '+this.program.name+'!');\n      return;\n    }\n    let value=offlinehero.sell(this.purchasedc);\n    let result='Downloaded '+this.name+'. ';\n    if(value==0){\n      result+='It was worthless and discarded.';\n      deck.storageused-=this.size;\n    }else{\n      result+='It is worth '+value+'¥!';\n    }\n    console.print(result);\n  }\n  \n  act(){ //TODO deck download speed upgrade?\n    this.ap+=.5;\n    if(this.downloading==NOTDOWNLOADING) return;\n    this.downloading+=.5;\n    if(this.downloading<this.size){\n      let progress=\n        Math.round(100*this.downloading/this.size);\n      console.print('Downloading '+this.name+'... '+\n        '('+progress+'% done)');\n    }else{\n      this.transfer();\n      this.leave(this.node);\n    }\n  }\n  \n  die(){\n    if(this.downloading!=NOTDOWNLOADING)\n      deck.storageused+=this.size;\n  }\n  \n  setname(name){\n    super.setname(name);\n    if(this.scanned)\n      this.tooltip+=' ('+this.size+' blocks)';\n  }\n  \n  reset(){\n    super.reset();\n    this.downloading=NOTDOWNLOADING;\n  }\n}\n","import {Avatar} from './avatar';\nimport {Disconnect} from '../../../messages';\n\nconst DISCONNECT='Do you want to leave the system?';\nconst JUMP='Do you want to leave the system?';\n\n/*Allows for a safe exit (no alamrs raised) or entry into a deeper level, if any. */\nexport class Gateway extends Avatar{\n  constructor(system,destination){\n    super(system);\n    if(destination){\n      this.setname('Gateway (unscanned)');\n      this.setimage('nodes/gatewayunscanned.png');\n    }else{\n      this.setname('Exit');\n      this.setimage('nodes/gatewayexit.png');\n      this.scanned=true;\n    }\n  }\n  \n  scan(){\n    let d=this.node.destination;\n    this.setname('Gateway to '+d.name);\n    this.setimage('nodes/gateway.png');\n  }\n  \n  confirm(prompt,destination=false){\n    if(!window.confirm(prompt)) return false;\n    let d=\n      new Disconnect(destination?false:'You exit safely.');\n    d.safe=true;\n    d.reconnect=destination;\n    return d;\n  }\n  \n  click(){\n    let destination=this.node.destination;\n    let disconnect;\n    if(destination){\n      let prompt='Do you want to go to: '+\n        destination.name+'?';\n      disconnect=this.confirm(prompt,destination);\n    }else{\n      disconnect=this.confirm(DISCONNECT);\n    }\n    if(disconnect) throw disconnect;\n  }\n}\n","import {Avatar} from './avatar';\nimport {CRITICALMISS} from '../../rpg';\nimport {console} from '../console';\nimport {sound} from '../../sound';\nimport {events} from './player';\n\nexport class Map extends Avatar{\n  scan(){\n    this.setimage('nodes/map.bmp');\n    this.setname('Map');\n  }\n  \n  click(){\n    let p=this.system.player;\n    let hack=p.roll(p.character.gethacking());\n    if(hack==CRITICALMISS){\n      console.print(\n        'You trigger an aler while reading the map!');\n      this.system.raisealert(+1);\n      return;\n    }\n    if(this.hack(false,hack)){\n      console.print('You download the system map!');\n      sound.play(sound.SUCCESS);\n      this.system.reveal();\n    }\n  }\n  \n  onevent(e){if(e==events.MAPREVEALED) this.hide();}\n}\n","import {Avatar} from './avatar';\nimport {console} from '../console';\nimport {hero as offline} from '../../character/character';\nimport {rpg,CRITICALHIT,CRITICALMISS} from '../../rpg';\nimport {sound} from '../../sound';\nimport {Disconnect} from '../../../messages';\nimport {deck} from '../../deck';\nimport environment from '../../../environment';\n\nexport const events={\n  ATTACK:'ATTACK',CONNECT:'CONNECT',MAPREVEALED:'MAPREVEALED',OPENFILE:'OPENFILE',}\n\nvar lastact=-9000;\n\nexport class Player extends Avatar{\n  constructor(system){\n    super(system);\n    this.setname(offline.name);\n    this.setimage('characters/'+offline.image+'.png');\n    this.scanned=true;\n    this.target=false; //current target (ICE)\n    this.credentials=10+this.character.getforgery();\n    this.privilege=0; //global roll() bonus\n    this.trace=0; //see Tracer ICE\n  }\n\n  create(characterclass,level){\n    this.character=offline.connect();\n  }\n\n  roll(bonus,roll=false){\n    if(!roll) roll=rpg.r(1,20);\n    if(roll==1) return CRITICALMISS;\n    if(roll==20) return CRITICALHIT;\n    if(this.system.alert){\n      let concentration=rpg.r(1,20)+\n        this.character.getconcentration();\n      let penalty=2*this.system.alert-concentration/5;\n      bonus-=Math.max(0,Math.round(penalty));\n    }\n    bonus+=this.privilege-deck.getload();\n    return roll+bonus;\n  }\n\n  enter(node){\n    let first=!this.node;\n    if(!super.enter(node)) return false;\n    if(!first){\n      sound.play(sound.MOVE);\n      console.print('You enter a node...');\n    }\n    node.visited=true;\n    this.node.scan(\n      this.roll(this.character.getperceive(),10));\n    return true;\n  }\n\n  wait(){\n    sound.play(sound.SCAN);\n    console.print('You scan the node...');\n    this.ap+=.5;\n    this.node.scan(this.roll(this.character.getsearch()));\n  }\n\n  click(){\n    //TODO maybe add % to deck and revert this to #wait()\n    let c=this.character;\n    let percent=Math.round(100*c.hp/c.maxhp);\n    let status='You currently have '+c.hp+\n      ' out of '+c.maxhp+' hit points '+\n      '('+percent+'%).';\n    console.print(status);\n  }\n\n  act(){\n    if(this.ap<lastact+1) return;\n    lastact=this.ap;\n    let hacking=Math.max(\n      this.roll(this.character.gethacking()),\n      this.roll(this.character.gethacking(),10));\n    deck.act(hacking,this.system);\n  }\n\n  query(dc,source){ //ICE queries player\n    if(this.credentials>=dc) return true;\n    sound.play(sound.QUERY);\n    console.print(source.name+' queries you...');\n    let bluff=this.roll(this.character.getbluff());\n    if(bluff<dc) return false;\n    this.credentials=bluff;\n    return true;\n  }\n\n  //returns true on hit, false on miss\n  attack(bonus,target,damage,roll=false){\n    this.fireevent(events.ATTACK);\n    if(!roll){\n      roll=this.roll(bonus);\n      bonus=0;\n      if(roll==CRITICALMISS) roll=1;\n      else if(roll==CRITICALHIT) roll=20;\n    }\n    return super.attack(bonus,target,damage,roll);\n  }\n\n  die(){\n    sound.play(sound.DISCONNECTED);\n    this.system.raisealert(+2,true);\n    //TODO transfer extra damage\n    let d=new Disconnect('You have been disconnected!');\n    d.safe=true;\n    throw d;\n  }\n\n  hide(spotter){\n    let perceive=10+spotter.character.getperceive();\n    let search=rpg.r(1,20)+spotter.character.getsearch()\n    let dc=Math.max(perceive,search);\n    let roll=this.roll(this.character.getstealth());\n    if(environment.debug)\n      console.print('Hide: '+roll+' DC'+dc+'.');\n    return roll>=dc;\n  }\n\n  login(){ //or logout\n    if(!this.node&&this.system.backdoor) return true;\n    let login=this.roll(this.character.gethacking());\n    if(this.credentials>login) login=this.credentials;\n    if(login>=10+this.system.level) return true;\n    this.system.raisealert(+1);\n    this.fireevent(events.CONNECT);\n    return false;\n  }\n\n  connect(){\n    sound.play(sound.CONNECT);\n    console.print('You connect to: '+this.system.name+'.');\n    if(!this.login())\n      console.print('Your unauthorized login is detected!');\n  }\n\n  disconnect(e){\n    this.leave(this.node);\n    let message=e.message;\n    if(!e.safe&&!this.login())\n      message='Your disconnection is detected!'\n    if(message) window.alert(message);\n    sound.clear();\n  }\n\n  fireevent(e){\n    for(let n of this.system.nodes) for(let a of n.avatars)\n      a.onevent(e);\n    for(let program of deck.loaded.slice())\n      program.onevent(e,this.system);\n  }\n}\n","import {rpg} from '../../rpg';\nimport {Node} from './node';\nimport {Alarm} from '../avatar/secure/alarm';\nimport {Entry} from '../avatar/secure/entry';\nimport {Shutdown} from '../avatar/secure/shutdown';\nimport {Map} from '../avatar/map';\nimport {Terminal} from '../avatar/secure/terminal';\n\nvar FUNCTIONS=4;\n\nexport class Cpu extends Node{\n  constructor(x,y,system,main=false){\n    super(x,y,system,'cpu');\n    this.priority=main?3:2;\n    if(main){\n      new Alarm(this.system).enter(this);\n      new Entry(this.system).enter(this);\n      new Map(this.system).enter(this);\n      new Terminal(this.system).enter(this);\n      if(rpg.chancein(Math.round(20/this.system.level)))\n        new Shutdown(this.system).enter(this);\n    }\n  }\n  \n  generate(){\n    while(this.avatars.length==0){\n      if(rpg.chancein(FUNCTIONS)) \n        new Alarm(this.system).enter(this);\n      if(rpg.chancein(FUNCTIONS)) \n        new Entry(this.system).enter(this);\n      if(rpg.chancein(FUNCTIONS)) \n        new Map(this.system).enter(this);\n      if(rpg.chancein(FUNCTIONS)) \n        new Shutdown(this.system).enter(this);\n    }\n  }\n}\n","import {Node} from './node';\nimport {File} from '../avatar/file';\nimport {rpg} from '../../rpg';\n\nexport class Datastore extends Node{\n  constructor(x,y,system){\n    super(x,y,system,'datastore');\n    this.priority=1;\n  }\n  \n  generate(){\n    let files=rpg.r(1,4);\n    for(let i=0;i<files;i++){\n      this.enter(new File(this.system));\n    }\n  }\n}\n","import {Node} from './node';\nimport {Backdoor} from '../avatar/secure/backdoor';\nimport {Control} from '../avatar/control';\nimport {rpg} from '../../rpg';\n\nexport class Interface extends Node{\n  constructor(x,y,system){\n    super(x,y,system,'interface');\n    this.priority=1;\n  }\n  \n  generate(){\n    this.enter(new Control(this.system));\n    if(rpg.chancein(4))\n      this.enter(new Backdoor(this.system));\n  }\n}\n","import {rpg} from '../../rpg';\nimport environment from '../../../environment';\nimport {console} from '../console';\nimport {sound} from '../../sound';\nimport {Ice} from '../avatar/ice/ice';\n\nvar TILES=[];\n\nfor(let x=0;x<environment.nodesize;x++) \n  for(let y=0;y<environment.nodesize;y++)\n    TILES.push([x,y]);\n\nexport class Node{\n  constructor(x,y,system,name='corridor'){\n    this.name=name;\n    this.x=x;\n    this.y=y;\n    this.id=system.nodes.length;\n    this.priority=0;\n    this.system=system;\n    this.avatars=[];\n    this.hidden=[];\n    this.visited=false;\n  }\n  \n  generate(){\n    // override\n  }\n  \n  getneighbors(){\n    let neighbors=[];\n    for(let xy of [[-1,0],[+1,0],[0,+1],[0,-1]]){\n      let n=this.system.getnode(this.x+xy[0],this.y+xy[1]);\n      if(n) neighbors.push(n);\n    }\n    return neighbors;\n  }\n  \n  getavatar(x,y){\n    for(let a of this.avatars) if(a.x==x&&a.y==y) return a;\n    return null;\n  }\n  \n  remove(avatar){//TODO should be called leave\n    if(avatar.node!=this)\n      throw 'Removing '+avatar.name+' from random node?';\n    let p=this.system.player;\n    if(avatar instanceof Ice&&this==p.node&&\n      avatar.character.hp>0){\n        sound.play(sound.ICELEAVE);\n        console.print(avatar.name+' leaves the node...');\n    }\n    avatar.node=false;\n    this.avatars.splice(this.avatars.indexOf(avatar),1);\n    if(p==avatar) p.target=false;\n    else if(p.target==avatar) p.target=false;\n  }\n  \n  checkadjacent(source,avatar){\n    if(environment.debug&&avatar==this.system.player)\n      return true;\n    return source.getneighbors().indexOf(this)>=0;\n  }\n  \n  receive(avatar,xy){\n    if(avatar.node){\n      avatar.leave(avatar.node);\n      if(this.system.player&&this==this.system.player.node){\n        sound.play(sound.ICEENTER);\n        console.print(avatar.name+' enters the node.');\n      }\n    }\n    avatar.x=xy[0];\n    avatar.y=xy[1];\n    avatar.node=this;\n    avatar.ap+=avatar.character.move();\n    this.avatars.push(avatar);\n  }\n  \n  /* return true if found free spot \n   * always prefer Avatar#enter(node) */\n  enter(avatar){\n    let source=avatar.node;\n    if(source==this) return false;\n    if(source&&!this.checkadjacent(source,avatar)){\n      console.print(\"Can only enter adjacent nodes...\");\n      return false;\n    }\n    rpg.shuffle(TILES);\n    for(let xy of TILES) if(!this.getavatar(xy[0],xy[1])){\n      this.receive(avatar,xy);\n      return true;\n    }\n    return false;\n  }\n  \n  scan(roll){\n    for(let a of this.avatars.slice())\n      if(!a.scanned&&roll>=a.scandc){\n        a.scan();\n        a.scanned=true;\n      }\n  }\n  \n  reset(){\n    for(let a of this.hidden) a.enter(this);\n    this.hidden=[];\n    for(let a of this.avatars.slice()) a.reset();\n  }\n}\n","import {Node} from './node';\nimport {Gateway} from '../avatar/gateway';\n\n/*TODO \n * - make it part of the normal generation to hop to other systems\n * - at first can even have it as \"stairs down\" */\nexport class Portal extends Node{\n  constructor(x,y,system,destination=false){\n    super(x,y,system,'portal');\n    this.destination=destination;\n    this.priority=destination?2:3;//prioritize entrance\n  }\n  \n  generate(){\n    new Gateway(this.system,this.destination).enter(this);\n  }\n}\n","import {Weapon} from './weapon';\nimport {rpg} from '../../rpg';\n\nexport const grades=[];\n\nclass Blade extends Weapon{\n  constructor(grade){\n    super('Blade',grade,'blade.png',1,4,9,18);\n    this.bonus=grade-1;\n  }\n  \n  upgrade(ntimes){super.upgrade(ntimes*2);}\n  \n  run(system){\n    let c=system.player.character;\n    let attack=c.getmelee()+this.bonus;\n    let damage=rpg.r(1,4)+c.getmodifier(c.intelligence)+\n      this.bonus*2;\n    if(damage<1) damage=1;\n    this.attack(attack,damage,'Portal.wav',system,true);\n  }\n  \n  describe(){\n    let bonus=this.bonus*2;\n    return 'Deals 1d4+'+bonus+' mêlée damage (silent)';\n  }\n}\n\nfor(let i=1;i<=11;i++) grades.push(new Blade(i));\n","import {Weapon} from './weapon';\nimport {rpg} from '../../rpg';\n\nexport const grades=[];\n\nclass Blaster extends Weapon{\n  constructor(grade){\n    super('Blaster',grade,'blaster.png',2,5,10,20);\n    this.duration=10;\n    this.bonus=grade-1;\n  }\n  \n  run(system){\n    let attack=system.player.character.getranged()+\n      this.bonus;\n    let damage=rpg.r(1,6)+this.bonus;\n    this.attack(attack,damage,'9mmPistol.wav',system);\n  }\n  \n  describe(){\n    return 'Deals 1d6+'+this.bonus+' damage (raises alarm)';\n  }\n}\n\nfor(let i=1;i<=11;i++) grades.push(new Blaster(i));\n","import {Program} from '../program';\nimport {console} from '../../cyberspace/console';\nimport {sound} from '../../sound';\n\nexport class Weapon extends Program{\n  attack(attack,damage,soundfile,system,silent=false){\n    let p=system.player;\n    let target=p.target;\n    if(!target){\n      console.print('Select a target first...');\n      return;\n    }\n    system.player.ap+=this.apcost;\n    sound.play(soundfile);\n    console.log('attack bonus '+attack);\n    console.log('damage '+damage);\n    console.log('target hp '+target.character.hp);\n    console.log('target ac '+target.character.getdefence());\n    let hit=p.attack(attack,target,damage);\n    if(!hit) console.print('You miss...');\n    if(!silent||(hit&&target.character.hp>0))\n      system.raisealert(2);\n  }\n  \n  conflict(program){\n    return super.conflict(program)||\n      program instanceof Weapon;\n  }\n}\n","import {Ice} from './ice';\nimport {Cpu} from '../../node/cpu';\nimport {Datastore} from '../../node/datastore';\nimport {Interface} from '../../node/interface';\nimport {Portal} from '../../node/portal';\n\nexport class Bouncer extends Ice{\n  constructor(system,level){\n    super('Bouncer','bouncer.png',system,level+1);\n  }\n  \n  create(characterclass,occupation,level){\n    super.create(characterclass,occupation,level);\n    let c=this.character;\n    while(c.learnability('intelligence')) continue;\n    c.learnskill('perceive');\n    while(c.learnfeat('toughness')) continue;\n  }\n  \n  getattack(ranged=true){\n    return super.getattack(false);\n  }\n  \n  query(){return true;}\n  \n  move(){\n    if(this.system.alert<2) return false;\n    super.move();\n  }\n  \n  deploy(node){\n    if(!node.priority) return false;\n    if(node instanceof Cpu||node instanceof Datastore||\n        node instanceof Interface) return true;\n    if(node instanceof Portal) {\n      let ice=node.avatars.filter(x=>x instanceof Ice);\n      if(ice.length>0) return true;\n    }\n    return false;\n  }\n}\n","import {Ice} from './ice';\n\nexport class Greeter extends Ice{\n  constructor(system,level){\n    super('Greeter','greeter.png',system,level+1);\n  }\n  \n  create(characterclass,occupation,level){\n    super.create(characterclass,occupation,level);\n    let c=this.character;\n    while(c.learnability('wisdom')) continue;\n    for(let skill of ['bluff','perceive','stealth']) \n      c.learnskill(skill);\n    //TODO Alert or bluff style feat would be better\n    for(let feat of ['stealthy','improved initiative'])\n      c.learnfeat(feat);\n    while(c.learnfeat('toughness')) continue;\n  }\n  \n  move(){return false;}\n  \n  deploy(node){\n    for(let a of node.avatars) if(a instanceof Greeter)\n      return false;\n    return true;\n  }\n}\n","import {Avatar} from '../avatar';\nimport {console} from '../../console';\nimport {rpg} from '../../../rpg';\nimport {sound} from '../../../sound';\nimport environment from '../../../../environment';\n\nexport class Ice extends Avatar{\n  constructor(name,image,system,level){\n    super(system,level);\n    this.revealedname=name;\n    this.revealedimage='ice/'+image;\n    if(environment.debug) this.checkcharacter();\n    this.scandc=10+this.character.getstealth();\n  }\n  \n  checkcharacter(){\n    let c=this.character;\n    let level=' (level '+c.level+')';\n    let name=this.constructor.name;\n    if(c.pointextra)\n      console.log(c.pointextra+' unspent ability points: '+\n        name+level);\n    if(c.ranks)\n      console.log(c.ranks+' unspent ranks: '+name+level);\n    if(c.newfeats)\n      console.log(c.newfeats+' unspent feats: '+name+level);\n  }\n  \n  click(){\n    if(!this.scanned) return;\n    let p=this.system.player;\n    if(p.target==this){\n      p.target=false;\n      console.print('Target cleared...');\n    }else{\n      p.target=this;\n      console.print('Targeting '+this.name+'...');\n    }\n  }\n  \n  scan(){\n    this.setname(this.revealedname+' '+this.getserial());\n    this.setimage(this.revealedimage);\n  }\n  \n  //returns true on attempt, hit or not\n  attack(bonus,target,damage,roll=false){\n    if(this.system.alert!=2||target.node!=this.node)\n      return false;\n    this.ap+=.5;\n    sound.play(sound.ICEATTACK);\n    console.print(this.name+' attacks!');\n    super.attack(bonus,target,damage)\n    return true;\n  }\n  \n  getdamage(){return rpg.r(1,this.getscale());}\n  \n  die(){\n    super.die();\n    sound.play(sound.ICEDEATH);\n    this.system.reentry.push(this);\n  }\n  \n  reset(){\n    super.reset();\n    this.leave(this.node);\n  }\n  \n  show(){\n    return this.scanned||this.system.revealed||\n      this.node==this.system.player.node;\n  }\n  \n  query(){//return false if failed query\n    if(this.system.alert==2) return true;\n    let p=this.system.player;\n    if(p.node!=this.node) return true;\n    if(p.hide(this)) return true;\n    this.ap+=.5;\n    let bluff=rpg.r(1,20)+this.character.getbluff();\n    if(p.query(bluff,this)) return true;\n    this.system.raisealert();\n    return false;\n  }\n  \n  findplayer(){//return player if adjacent\n    let p=this.system.player;\n    if(p.hide(this)) return false;\n    for(let n of this.node.getneighbors())\n      if(n==p.node) return p;\n    return false;\n  }\n  \n  getdestination(){\n    if(this.system.alert){\n      let player=this.findplayer();\n      if(player) return player.node;\n    }\n    return rpg.choose(this.node.getneighbors());\n  }\n  \n  move(){\n    let p=this.system.player;\n    if(this.system.alert>0&&\n      p.node==this.node&&!p.hide(this)) return false;\n    this.enter(this.getdestination());\n    return true;\n  }\n  \n  getattack(ranged=true){ //bonus and damage, default: ranged\n    if(ranged)\n      return [this.character.getranged(),this.getdamage()];\n    let c=this.character;\n    let meleedamage=this.getdamage();\n    meleedamage+=c.getmodifier(c.intelligence);\n    return [this.character.getmelee(),meleedamage];\n  }\n  \n  act(){\n    let attack=this.getattack();\n    if(this.attack(attack[0],this.system.player,attack[1]))\n      return;\n    if(!this.query()) return;\n    if(this.move()) return;\n    this.ap+=.5; //wait\n  }\n  \n  //return true if ICE likes being deployed in this node\n  //no randomness: return always false for random deploy\n  deploy(node){return node.priority;}\n}\n","import {Ice} from './ice';\nimport {rpg} from '../../../rpg';\nimport {console} from '../../console';\n\nexport class Scout extends Ice{\n  constructor(system,level){\n    super('Scout','scout.png',system,level);\n    this.path=[]; //prevents looping between rooms\n  }\n  \n  create(characterclass,occupation,level){\n    super.create(characterclass,occupation,level);\n    let c=this.character;\n    while(c.learnability('wisdom')) continue;\n    for(let skill of ['perceive','bluff','stealth']) \n      c.learnskill(skill);\n    //TODO Alert or bluff style feat would be better\n    for(let feat of ['improved initiative','stealthy'])\n      c.learnfeat(feat);\n    while(c.learnfeat('toughness')) continue;\n    c.speed+=this.character.level;\n  }\n  \n  enter(node){\n    if(!super.enter(node)) return false;\n    this.path.push(node);\n    let history=1+Math.round(this.character.speed/30);\n    if(this.path.length>history) this.path.shift();\n    return true;\n  }\n  \n  getdestination(){\n    if(this.system.alert){\n      let player=this.findplayer();\n      if(player) return player.node;\n    }\n    let ns=rpg.shuffle(this.node.getneighbors());\n    for(let n of ns) if(this.path.indexOf(n)<0) return n;\n    return ns[0];\n  }\n  \n  move(){\n    let moved=super.move();\n    if(moved) this.query();\n    return moved;\n  }\n  \n  act(){\n    super.act();\n    if(this.system.alert==2) this.path=[];\n  }\n  \n  deploy(node){return false;}\n}\n","import {Ice} from './ice';\nimport {rpg} from '../../../rpg';\nimport {save} from '../../../save';\nimport {sound} from '../../../sound';\nimport {console} from '../../console';\n\nconst DUMMY=[0,0];\nconst FINISHED=100;\n\nexport class Tracer extends Ice{\n  constructor(system,level){\n    super('Tracer','tracer.png',system,level);\n  }\n  \n  create(characterclass,occupation,level){\n    super.create(characterclass,occupation,level);\n    let c=this.character;\n    while(c.learnability('intelligence')) continue;\n    for(let s of ['search','stealth','perceive','bluff'])\n      c.learnskill(s);\n    c.learnfeat('meticulous');\n    c.learnfeat('stealthy');\n    while(c.learnfeat('toughness')) continue;\n  }\n  \n  getattack(ranged=true){return DUMMY;}\n  \n  attack(bonus,target,damage,roll=false){\n    if(this.system.alert!=2||target.node!=this.node)\n      return false;\n    this.ap+=.5;\n    let p=this.system.player;\n    let stealth=p.roll(p.character.getstealth(),10);\n    if(rpg.r(1,20)+this.character.getsearch()>=stealth){\n      let level=this.character.level;\n      p.trace+=level+rpg.randomize(level);\n      if(p.trace>=FINISHED){\n        save.clear();\n        alert('Your identity has been traced. Game over.');\n        location.reload();\n      }else{\n        sound.play('Scan.wav');\n        console.print('A trace is active ('+p.trace+'%)!');\n      }\n    }\n    return true;\n  }\n  \n  deploy(node){return false;}\n}\n","import {SecureAvatar} from './secure';\nimport {console} from '../../console';\nimport {CRITICALMISS} from '../../../rpg';\n\nexport class Alarm extends SecureAvatar{\n  scan(){\n    this.setimage('nodes/alarm.bmp');\n    this.setname('Alarm');\n  }\n  \n  click(){\n    if(this.system.alert==0)\n      console.print('No alerts to clear right now...');\n    else if(super.click()) this.system.raisealert(-2);\n  }\n}\n","import {SecureAvatar} from './secure';\nimport {sound} from '../../../sound';\nimport {console} from '../../console';\n\nexport class Backdoor extends SecureAvatar{\n  scan(){\n    this.setimage('nodes/backdoor.bmp');\n    this.setname('Backdoor');\n  }\n  \n  activate(){\n    //TODO if(!this.hack(true)) return false;\n    sound.play(sound.SUCCESS);\n    this.system.backdoor=this.node;\n    this.system.business.backdoor=this.system;\n    console.print('You succesfully exploit the backdoor!');\n  }\n  \n  deactivate(){\n    if(!confirm(\n      'Are you sure you want to disable this backdoor?'))\n        return;\n    sound.play(sound.DISABLE);\n    this.system.backdoor=false;\n    this.system.business.backdoor=false;\n    console.print('Backdoor cleared.');\n  }\n  \n  click(){\n    if(this.system.backdoor==this.node) this.deactivate();\n    else this.activate();\n  }\n}\n","import {SecureAvatar} from './secure';\nimport {rpg} from '../../../rpg';\nimport envinronment from '../../../../environment';\nimport {sound} from '../../../sound';\nimport {console} from '../../console';\n\nexport class Entry extends SecureAvatar{\n  scan(){\n    this.setimage('nodes/entry.png');\n    this.setname('ICE entry');\n  }\n  \n  click(){\n    if(!super.click()) return false;\n    console.print('You disable the ICE re-entry point!');\n    sound.play(sound.DISABLE);\n    this.hide();\n  }\n  \n  act(){\n    this.ap+=1;\n    if(this.system.reentry.length==0) return;\n    let ice=this.system.reentry[0];\n    if(rpg.r(1,20)+this.system.level<10+ice.character.level)\n      return;\n    if(!ice.enter(this.node)) return;\n    ice=this.system.reentry.shift();\n    ice.character.hp=ice.character.maxhp;\n    ice.rollinitiative();\n    ice.ap+=this.ap;\n    ice.obfuscate();\n    if(envinronment.scannodes){\n      ice.scan();\n      ice.scanned=true;\n    }\n  }\n}\n","import {Avatar} from '../avatar';\n\nexport class SecureAvatar extends Avatar{\n  create(characterclass,occupation,level){\n    super.create(characterclass,occupation,level);\n    let c=this.character;\n    for(let s of ['bluff','perceive']) c.learnskill(s);\n  }\n  \n  click(){return this.hack(true);}\n}\n","import {SecureAvatar} from './secure';\nimport {console} from '../../console';\nimport {Disconnect} from '../../../../messages';\n\nexport const INITIAL=11;\n\nexport class Shutdown extends SecureAvatar{\n  scan(){\n    this.setname('Automatic shutdown');\n    this.setimage('nodes/shutdown.png');\n  }\n  \n  click(){\n    if(!super.click()) return false;\n    if(this.system.shutdown!=INITIAL){\n      this.system.shutdown=INITIAL;\n      console.print('You reset the current countdown!');\n    }\n    this.hide();\n    console.print('Automatic shutdown node disabled.');\n  }\n  \n  act(){\n    let s=this.system;\n    if(s.alert!=2){\n      super.act();\n      return;\n    }\n    this.ap+=.5;\n    s.shutdown-=1;\n    if(s.shutdown>0){\n      console.print(\n        'Automatic shutdown in '+s.shutdown+'...');\n    }else if(s.shutdown==0){\n      console.print('Going for full system halt NOW!');\n    }else{\n      s.disconnected=new Disconnect(\n        'System went for emergency shutdown.');\n    }\n  }\n}\n","import {SecureAvatar} from './secure';\nimport {rpg} from '../../../rpg';\nimport {console} from '../../console';\nimport {sound} from '../../../sound';\nimport {Disconnect} from '../../../../messages';\n\nexport class Terminal extends SecureAvatar{\n  create(characterclass,occupation,level){\n    super.create(characterclass,occupation,level+rpg.r(1,4));\n    this.character.defence+=this.character.level;\n  }\n\n  scan(){\n    if(this.system!=this.system.business.mainframe){\n      //TODO since the main point of terminals right now is to crash the system and the game's objective is to get to the last level to do so, there's no purpose for terminals at previous depths\n      this.hide();\n      return;\n    }\n    this.setimage('nodes/terminal.png');\n    this.setname('Terminal');\n  }\n\n  click(){\n    if(!super.click()) return false;\n    this.system.business.crash(this.system);\n    this.system.raisealert(+2,true);\n    sound.play(sound.CRASH);\n    let d=new Disconnect('You have crashed the mainframe!');\n    d.win=true;\n    d.safe=true;\n    throw d;\n  }\n}\n"],"sourceRoot":".."}