{"version":3,"sources":["app.js","empty.js","environment.js","infojack-mainmenu.js","infojack-radio.js","infojack-topmenu.js","main.js","messages.js","character/character-abilities.js","character/character-deck.js","character/character-details.js","character/character-feats.js","character/character-general.js","character/character-programs.js","character/character-screen.js","character/character-skills.js","character/character-talents.js","cyberspace/infojack-cyberspace.js","cyberspace/program-bar.js","modules/deck.js","modules/grade.js","modules/rpg.js","modules/save.js","modules/sound.js","resources/index.js","modules/character/character.js","modules/character/feat.js","modules/character/occupation.js","modules/character/skill.js","modules/cyberspace/console.js","modules/cyberspace/system.js","modules/program/armor.js","modules/program/program.js","modules/character/class/class.js","modules/character/class/webcrawler.js","modules/cyberspace/avatar/alarm.js","modules/cyberspace/avatar/avatar.js","modules/cyberspace/avatar/backdoor.js","modules/cyberspace/avatar/control.js","modules/cyberspace/avatar/entry.js","modules/cyberspace/avatar/file.js","modules/cyberspace/avatar/gateway.js","modules/cyberspace/avatar/map.js","modules/cyberspace/avatar/player.js","modules/cyberspace/avatar/terminal.js","modules/cyberspace/node/cpu.js","modules/cyberspace/node/datastore.js","modules/cyberspace/node/interface.js","modules/cyberspace/node/node.js","modules/cyberspace/node/portal.js"],"names":["App","Example","debug","testing","nodesize","fullattributes","ccskills","playeravatars","revealmap","scannodes","printsave","systemlevel","view","MainMenu","sound","messaging","show","hassave","checkload","me","setTimeout","close","showpending","play","ERROR","alert","startgame","prompt","confirm","clear","loadgame","load","open","publish","openrepository","window","Radio","active","audio","pause","TopMenu","hideradio","configure","Promise","config","warnings","wForgottenReturn","aurelia","use","standardConfiguration","feature","developmentLogging","plugin","start","then","setRoot","ShowView","CharacterAbilities","attached","full","strength","dexterity","constitution","intelligence","wisdom","charisma","pointbuy","pointextra","save","clone","Object","assign","upgrade","ability","current","raised","buy","ranks","level","next","cost","CharacterDeck","refresh","memory","storage","name","possess","wealth","electronics","getelectronics","deckgrade","memorygrade","storagegrade","stealthgrade","canupgradedeck","upgradedeck","canupgradememory","upgradememory","canupgradestorage","upgradestorage","canupgradestealth","upgradestealth","grade","i","CharacterDetails","abilities","saves","skills","classes","hero","bind","avatar","connect","getmodifier","toLowerCase","getsave","getskill","skill","replace","sign","n","CharacterFeats","BindingSignaler","signals","viewname","points","newfeats","add","feat","apply","signal","validate","getcurrent","feats","f","talent","push","getall","CharacterGeneral","image","avatars","focus","select","CharacterPrograms","programs","technology","gettechnology","has","program","indexOf","getpurchaselabel","purchasedc","canbuy","cancreate","programmingdc","getprogramminglabel","create","CharacterScreen","showgeneral","showabilities","showskills","showfeats","showtalents","showdetails","showdeck","showprograms","subscribe","e","id","target","buttons","charactermenu","querySelectorAll","button","classList","remove","CharacterSkills","values","s","getranks","iscrossclass","classskills","includes","canupgrade","setranks","value","getability","substring","toUpperCase","CharacterTalents","talents","Map","c","get","set","TILESIZE","SPACING","FADETIME","Cyberspace","showconsole","init","map","document","querySelector","innerHTML","console","system","player","tiles","drawn","draw","clicktile","tile","tagName","parentNode","node","nodes","nodeid","getavatar","nodex","nodey","click","enter","placenode","placetile","x","y","createElement","onclick","style","width","height","left","top","placespacer","farx","fary","t","offsetLeft","offsetTop","spacer","body","scrollTop","scrollLeft","appendChild","expand","getneighbors","print","entrance","scroll","scrollIntoView","addimage","scanned","src","title","tooltip","removeimage","opacity","fade","removeChild","printmessages","m","pop","color","div","createTextNode","text","scrollHeight","revealed","visited","border","ProgramBar","collapsed","sort","slice","memoryused","totalload","toggle","isloaded","loaded","geticonclass","doload","result","dounload","unload","run","OK","MEMORYUPGRADE","Deck","storageused","checkgrade","currentgrade","installdc","data","key","a","b","compare","deck","grades","Rpg","r","min","max","Math","floor","random","d","dice","sides","sum","choose","list","length","chancein","shuffle","array","j","swap","randomize","amount","rpg","Save","localStorage","getItem","saveprograms","p","setItem","JSON","stringify","loadprograms","populate","parse","initialize","PREFIX","Sound","file","Audio","ABILITYPOINTS","round","costs","Character","hp","maxhp","bab","edgedice","edge","fort","ref","will","defence","speed","extratalents","contacts","setoccupation","occupation","addclassskill","enhancecrawler","con","hasfeat","addfeat","featbonus","getbluff","bluff","getconcentration","concentration","getdecryption","decryption","getforgery","forgery","getinformation","information","gethacking","hacking","getperceive","perceive","getmedicine","medicine","getstealth","stealth","getprofession","profession","getresearch","research","getsearch","search","getfortitude","getreflexes","getwill","getinitiative","getdefence","getmelee","getranged","price","difference","sell","upgradewealth","taketen","letter","adventurer","advance","log","Feat","description","character","Talent","Educated","Meticulous","Stealthy","Studious","Trustworthy","ImprovedInitiative","Windfall","Occupation","skillsp","occupations","checkskills","Skill","ss","Message","Console","messages","message","getactive","System","ice","generatemap","definenodes","generate","reveal","scan","getnode","size","leastx","leasty","replacenode","original","findentrance","neighbors","portals","filter","generatenode","setmain","entrancei","corridor","raisealert","cancelalert","Armor","duration","modify","bonus","describe","armor","SESSION","Number","MAX_SAFE_INTEGER","PROGRAMS","Program","hack","code","hackingdc","apcost","basename","conflict","splice","ntimes","localeCompare","Class","levelup","upgradehp","hd","upgraderanks","classlevel","stat","upgradestat","upgradeedgedice","upgradereputation","last","split","parseInt","reputation","check","TheWebIsAlive","SpecializedEquipment","Webcrawler","webcrawler","Alarm","setimage","Avatar","constructor","scandc","source","Backdoor","OUTCOMES","Control","privilege","Entry","File","worthless","trap","protected","Gateway","Player","Terminal","FUNCTIONS","Cpu","priority","Datastore","files","Interface","TILES","Node","xy","Portal"],"mappings":"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","file":"app-bundle.js","sourcesContent":["export class App {\n  constructor() {\n  }\n}\n","export class Example {\n    constructor() {\n    }\n}\n","export default {\n  /* environment */\n  debug:true,\n  testing:true,\n  /* game options */\n  nodesize:4, //grid size for each node\n  fullattributes:false, //no sense in having physical now\n  ccskills:false, //only 1 is cross-class, so disable for now\n  playeravatars:17,\n  /* debug flags (false=disabled) */\n  revealmap:true,\n  scannodes:true,\n  printsave:false, \n  systemlevel:false, //override system level (1-20)\n  view:false, //starting view name\n};\n","import {inject} from 'aurelia-framework';\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {Sound} from './modules/sound';\nimport {save} from './modules/save';\nimport {ShowView} from './messages';\nimport environment from './environment';\n\n@inject(Sound,EventAggregator)\nexport class MainMenu {\n    constructor(sound,messaging) {\n        this.sound=sound;\n        this.show=true;\n        this.messaging=messaging;\n        this.hassave=save.checkload()!=false;\n        if(environment.view){\n          let me=this;\n          setTimeout(function(){\n            me.close(environment.view);}\n          ,1);\n        }\n    }\n  \n    showpending(){\n        this.sound.play(this.sound.ERROR);\n        setTimeout(function(){\n            alert('Operation pending!');\n        },100);\n    }\n    \n    startgame(){\n        let prompt='Are you sure you want to start a new game? Any previous progress will be lost!';\n        if(this.hassave&&!confirm(prompt)){\n            return;\n        }\n        save.clear();\n        this.close('CharacterScreen');\n    }\n    \n    loadgame(){\n        if(this.hassave){\n          save.load();\n          this.close('CharacterScreen');\n        }else{\n          this.sound.play(this.sound.ERROR);\n          alert('No save found!');\n        }\n    }\n    \n    close(open){\n        this.show=false;\n        this.messaging.publish(new ShowView(open));\n    }\n      \n    openrepository(){\n      window.open('https://github.com/tukkek/infojack');\n    }\n}\n","export class Radio {\n    constructor() {\n        this.active=false;\n    }\n  \n    play(){\n        this.audio.play();\n        if(!this.active){\n            this.audio.play();\n        } else {\n            this.audio.pause();\n        }\n        return true;\n    }\n}\n","export class TopMenu{\n    constructor(){\n        this.hideradio=true;\n    }\n    \n    open(){\n        this.hideradio=!this.hideradio;\n    }\n}\n","import environment from './environment';\n\n//Configure Bluebird Promises.\nPromise.config({\n  warnings: {\n    wForgottenReturn: false\n  }\n});\n\nexport function configure(aurelia) {\n  aurelia.use\n    .standardConfiguration()\n    .feature('resources');\n\n  if (environment.debug) {\n    aurelia.use.developmentLogging();\n  }\n\n  if (environment.testing) {\n    aurelia.use.plugin('aurelia-testing');\n  }\n\n  aurelia.start().then(() => aurelia.setRoot());\n}\n","export class ShowView{\n    constructor(view){\n        this.view=view;//CharacterScreen\n    }\n}\n","//TODO needs to boost Character#ranks with int\n\nimport {hero,costs} from '../modules/character/character';\nimport environment from '../environment';\n\n/* TODO add difficulty modes */\nexport class CharacterAbilities {\n    constructor() {}\n    \n    attached(){\n        this.full=environment.fullattributes;\n        this.strength=hero.strength;\n        this.dexterity=hero.dexterity;\n        this.constitution=hero.constitution;\n        this.intelligence=hero.intelligence;\n        this.wisdom=hero.wisdom;\n        this.charisma=hero.charisma;\n        this.pointbuy=hero.pointbuy;\n        this.pointextra=hero.pointextra;\n    }\n    \n    save(){\n        let clone={};\n        Object.assign(clone,this);\n        delete clone.full;\n        hero.assign(clone);\n    }\n\n    upgrade(ability){\n        let current=this[ability];\n        if(current==18) return;\n        let raised=this[ability]+1;\n        if(this.pointextra>0){\n            this.pointextra-=1;\n            this[ability]=raised;\n        }else if(this.buy(current)){\n            this[ability]=raised;\n        }else return;\n        if(ability=='intelligence'&&raised%2==0){\n            hero.ranks+=hero.level==1?4:1;\n        }\n        this.save();\n    }\n    \n    buy(current){\n        let next=current+1;\n        let cost=costs[next]-costs[current];\n        if(this.pointbuy>=cost){\n            this.pointbuy-=cost;\n            return true;\n        }\n        return false;\n    }\n}\n","import {deck} from '../modules/deck';\nimport {hero,sign} from '../modules/character/character';\nimport {grades} from '../modules/grade';\nimport '../modules/program/armor'; //TODO\n\n//TODO move to a city shop screen instead of character\nexport class CharacterDeck {\n    constructor(){}\n    \n    attached(){this.refresh();}\n    \n    refresh(){\n      this.memory=deck.memory;\n      this.storage=deck.storage;\n      this.name=hero.possess();\n      this.wealth=hero.wealth;\n      this.electronics=sign(hero.getelectronics());\n      this.deckgrade=deck.deckgrade;\n      this.memorygrade=deck.memorygrade;\n      this.storagegrade=deck.storagegrade;\n      this.stealthgrade=deck.stealthgrade;\n      this.canupgradedeck=deck.upgradedeck(false);\n      this.canupgradememory=deck.upgradememory(false);\n      this.canupgradestorage=deck.upgradestorage(false);\n      this.canupgradestealth=deck.upgradestealth(false);\n    }\n    \n    grade(i){return grades[i];}\n    \n    upgradedeck(){\n      debugger;\n      deck.upgradedeck(true);\n      this.refresh();\n    }\n    \n    upgradememory(){\n      deck.upgradememory(true);\n      this.refresh();\n    }\n    \n    upgradestorage(){\n      deck.upgradestorage(true);\n      this.refresh();\n    }\n    \n    upgradestealth(){\n      deck.upgradestealth(true);\n      this.refresh();\n    }\n}\n","import {hero,sign} from '../modules/character/character';\nimport {skills} from '../modules/character/skill';\nimport {Class} from '../modules/character/class/class';\n\nexport class CharacterDetails {\n    constructor() {\n      this.abilities=['Strength','Dexterity','Constitution','Intelligence','Wisdom','Charisma'];\n      this.saves=['Fortitude','Reflexes','Will'];\n      this.skills=skills;\n      this.classes=Class.classes;\n      this.hero=hero;\n    }\n\n    bind(){\n      this.avatar=hero.connect();\n    }\n    \n    getmodifier(ability){\n      ability=ability.toLowerCase();\n      ability=this.avatar.getmodifier(this.avatar[ability]);\n      return sign(ability);\n    }\n    \n    getsave(save){\n      save=save.toLowerCase();\n      return sign(this.avatar['get'+save]());\n    }\n    \n    getskill(skill){\n      skill=skill.name.replace(' ','').toLowerCase()\n      return sign(this.avatar['get'+skill]());\n    }\n    \n    sign(n){return sign(n);}\n}\n","import {feats} from '../modules/character/feat';\nimport {hero} from '../modules/character/character';\nimport {inject} from 'aurelia-framework';\nimport {BindingSignaler} from 'aurelia-templating-resources';\n\n@inject(BindingSignaler)\nexport class CharacterFeats {\n    constructor(BindingSignaler) {\n        this.signals=BindingSignaler;\n        this.viewname='Feats';\n    }\n    \n    bind(){this.points=hero.newfeats;}\n\n    add(feat){\n        if(this.points==0) return;\n        this.points-=1;\n        hero.newfeats-=1;\n        feat.apply(hero);\n        this.signals.signal('update');\n    }\n    \n    validate(feat){\n        return this.points>0&&feat.validate(hero);\n    }\n    \n    getcurrent(){\n      let current=[];\n      for(let f of hero.feats) if(!f.talent) current.push(f);\n      return current;\n    }\n    \n    getall(){return feats;}\n}\n","import {hero} from '../modules/character/character';\nimport environment from '../environment';\n\nexport class CharacterGeneral {\n    constructor() {\n      this.hero=hero;\n      this.avatar=hero.image;\n      this.avatars=environment.playeravatars;\n    }\n    \n    attached(){this.name.focus();}\n    \n    select(avatar){\n      this.avatar=avatar;\n      hero.image=avatar;\n    }\n}\n","import {PROGRAMS} from '../modules/program/program';\nimport {hero,sign} from '../modules/character/character';\nimport {deck} from '../modules/deck';\nimport {inject} from 'aurelia-framework';\nimport {BindingSignaler} from 'aurelia-templating-resources';\n\n//TODO move out of character screen\n@inject(BindingSignaler)\nexport class CharacterPrograms {\n    constructor(BindingSignaler) {\n      this.programs=PROGRAMS;\n      this.signals=BindingSignaler;\n    }\n    \n    attached(){this.refresh();}\n    \n    refresh(){\n      this.name=hero.possess();\n      this.wealth=hero.wealth;\n      this.technology=sign(hero.gettechnology());\n      this.signals.signal('update');\n    }\n    \n    has(program){return deck.programs.indexOf(program)>=0;}\n    \n    getpurchaselabel(program){\n      let wealth=program.purchasedc-10;\n      if(wealth<0) wealth=0;\n      return 'Requires '+wealth+'';\n    }\n    \n    canbuy(program){\n      return !this.has(program)&&\n        hero.wealth+10>=program.purchasedc;\n    }\n    \n    buy(program){\n      if(!hero.buy(program.purchasedc)){\n        alert('Cannot buy error!');\n        return;\n      }\n      deck.programs.push(program);\n      this.refresh();\n    }\n    \n    cancreate(program){\n      return !this.has(program)&&\n        hero.gettechnology()+10>=program.programmingdc;\n    }\n    \n    getprogramminglabel(program){\n      return 'Requires technology '+\n        sign(program.programmingdc-10);\n    }\n    \n    create(program){\n      deck.programs.push(program);\n      this.refresh();\n    }\n}\n","import {inject} from 'aurelia-framework';\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {ShowView} from '../messages';\nimport {save} from '../modules/save';\n\n@inject(EventAggregator)\nexport class CharacterScreen {\n  constructor(messaging) {\n      this.show=false;\n      this.showgeneral=true;\n      this.showabilities=false;\n      this.showskills=false;\n      this.showfeats=false;\n      this.showtalents=false;\n      this.showdetails=false;\n      this.showdeck=false;\n      this.showprograms=false;\n      this.messaging=messaging;\n      \n      let me=this;\n      messaging.subscribe(ShowView,function(show){\n          if(show.view=='CharacterScreen') me.show=true;\n      });\n  }\n  \n  select(e){\n    let id=e.target.id;\n    let buttons=\n      this.charactermenu.querySelectorAll('button');\n    for(let button of buttons){\n      let classes=button.classList;\n      if(!classes) continue;\n      var show=button.id==id;\n      this['show'+button.id.replace('character-','')]=show;\n      if(show){\n        classes.add('highlightbg');\n      } else {\n        classes.remove('highlightbg');\n      }\n    }\n  }\n  \n  close(){\n      save.save();\n      this.show=false;\n      this.messaging.publish(new ShowView('Cyberspace'));\n  }\n}\n\n","import {skills} from '../modules/character/skill';\nimport {hero} from '../modules/character/character';\nimport {inject} from 'aurelia-framework';\nimport environment from '../environment';\n\nexport class CharacterSkills {\n    constructor() {\n        this.skills=skills;\n    }\n    \n    bind(){\n        this.hero=hero;\n        this.ranks={};\n        for(let s of skills.values()) \n          this.ranks[s.name]=hero.getranks(s.name);\n    }\n    \n    iscrossclass(skill){\n        return environment.ccskills&&\n          !hero.classskills.includes(skill);\n    }\n    \n    buy(skill){\n        return this.iscrossclass(skill)?2:1;\n    }\n    \n    upgrade(skill){\n        if(!this.canupgrade(this.ranks[skill],skill)) return;\n        let cost=this.buy(skill);\n        hero.ranks-=cost;\n        this.ranks[skill]+=1;\n        hero.setranks(skill,this.ranks[skill]);\n        if(skill=='Profession'&&hero.level==1\n          &&this.ranks[skill]==1) hero.wealth+=1;\n    }\n    \n    canupgrade(value,skill){\n        let cost=this.buy(skill);\n        return hero.ranks>=cost && value<3+hero.level;\n    }\n    \n    getability(skill){\n      return skill.ability.substring(0,3).toUpperCase();\n    }\n}\n","import {useView} from 'aurelia-framework';\nimport {hero} from '../modules/character/character';\nimport {Class} from '../modules/character/class/class';\nimport {inject} from 'aurelia-framework';\nimport {BindingSignaler} from 'aurelia-templating-resources';\n\n@useView('./character-feats.html')\n@inject(BindingSignaler)\nexport class CharacterTalents {\n    constructor(BindingSignaler) {\n        this.signals=BindingSignaler;\n        this.viewname='Talents';\n    }\n    \n    bind(){\n      this.points=hero.talent;\n      this.talents=new Map();\n      for(let c in hero.classes)\n        for(let [name,talent] of Class.classes.get(c).talents)\n          this.talents.set(name,talent);\n    }\n\n    add(talent){\n        if(this.points==0) return;\n        this.points-=1;\n        hero.talent-=1;\n        talent.apply(hero);\n        this.signals.signal('update');\n    }\n    \n    validate(talent){\n        return this.points>0&&talent.validate(hero);\n    }\n    \n    getcurrent(){\n      let current=[];\n      for(let f of hero.feats) if(f.talent) current.push(f);\n      return current;\n    }\n    \n    getall(){return this.talents;}\n}\n","import {System} from '../modules/cyberspace/system';\nimport {Player} from '../modules/cyberspace/avatar/player';\nimport {console} from '../modules/cyberspace/console';\nimport {inject} from 'aurelia-framework';\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {Sound} from '../modules/sound';\nimport {ShowView} from '../messages';\nimport environment from '../environment';\nimport {hero} from '../modules/character/character';\n\nvar TILESIZE=2.5;\nvar SPACING=1.1;\nvar FADETIME=2000;\n\nvar current=false;\n\n@inject(Sound,EventAggregator)\nexport class Cyberspace{\n  constructor(sound,messaging){\n    this.showconsole=false;\n    current=this;\n    let me=this;\n    messaging.subscribe(ShowView,function(show){\n        if(show.view=='Cyberspace') me.init();\n    });\n  }\n  \n  init(){\n    //TODO clean previous run\n    this.showconsole=true;\n    this.map=document.querySelector('#cyberspace');\n    this.map.innerHTML='';\n    this.console=document.querySelector('#console');\n    this.console.innerHTML='';\n    this.system=\n      new System(environment.systemlevel||hero.level);\n    this.player=new Player(this.system);\n    this.tiles=[];\n    this.drawn=[];\n    this.draw();\n  }\n  \n  clicktile(tile){\n    if(tile.tagName=='IMG') tile=tile.parentNode;\n    let node=this.system.nodes[tile.nodeid];\n    let avatar=node==this.player.node&&\n      node.getavatar(tile.nodex,tile.nodey);\n    if(avatar){\n      avatar.click();\n    }else{\n      this.player.enter(node);\n      this.placenode(node,true);\n    }\n    this.refresh();\n  }\n\n  placetile(x,y,node){\n    let tile=document.createElement('div');\n    this.tiles.push(tile);\n    tile.classList.add('tile');\n    tile.nodeid=node.id;\n    tile.nodex=x;\n    tile.nodey=y;\n    let me=this;\n    tile.onclick=function(){me.clicktile(this);};\n    let style=tile.style;\n    style.width=TILESIZE+'em';\n    style.height=TILESIZE+'em';\n    style.left=(node.x*SPACING*environment.nodesize+x)\n      *TILESIZE+'em';\n    style.top=(node.y*SPACING*environment.nodesize+y)\n      *TILESIZE+'em';\n    return tile;\n  }\n\n  placespacer(){\n    let farx=0;\n    let fary=0;\n    for(let t of this.tiles){\n      if(t.offsetLeft>farx) farx=t.offsetLeft;\n      if(t.offsetTop>fary) fary=t.offsetTop;\n    }\n    let spacer=document.createElement('div');\n    spacer.classList.add('spacer');\n    spacer.style.top=(document.body.scrollTop+fary)+'px';\n    spacer.style.left=(document.body.scrollLeft+farx)+'px';\n    this.map.appendChild(spacer);\n  }\n\n  placenode(node,expand){\n    if(this.drawn.indexOf(node)<0){\n      this.drawn.push(node);\n      for(let x=0;x<environment.nodesize;x++)\n        for(let y=0;y<environment.nodesize;y++)\n          this.map.appendChild(this.placetile(x,y,node));\n    }\n    if(expand) for(let n of node.getneighbors())\n      this.placenode(n,false);\n    let me=this;\n    setTimeout(function(){me.placespacer();},500);\n  }\n\n  draw(){\n    console.system=this.system;\n    console.print('You enter the system...');\n    this.placenode(this.system.entrance,true);\n    this.player.enter(this.system.entrance);\n    this.refresh();\n    this.scroll();\n  }\n  \n  scroll(){\n    for(let t of this.tiles) \n      if(t.nodeid==this.player.node.id&&\n        t.nodex==this.player.x&&t.nodey==this.player.y){\n          setTimeout(function(){t.scrollIntoView();},250);\n          return;\n      }\n  }\n\n  addimage(tile,avatar){\n    tile.avatar=avatar;\n    tile.scanned=avatar.scanned;\n    let image=document.createElement('img');\n    image.src=avatar.image;\n    image.title=avatar.tooltip;\n    tile.appendChild(image);\n    tile.image=image;\n  }\n\n  removeimage(tile){\n    tile.avatar=null;\n    tile.image.style.opacity=0;\n    let fade=tile.image;\n    tile.image=null;\n    setTimeout(function(){tile.removeChild(fade);},FADETIME);\n  }\n\n  printmessages(){\n    for(let m=console.pop();m;m=console.pop()){\n      let color=false;\n      if(m.alert==0) color='white';\n      else if(m.alert==1) color='yellow';\n      else if(m.alert==2) color='red';\n      else throw 'Unknown alert level';\n      let div=document.createElement('div');\n      div.style.color=color;\n      div.appendChild(document.createTextNode(m.text));\n      this.console.appendChild(div);\n    }\n    this.console.scrollTop=this.console.scrollHeight;\n  }\n  \n  refresh(){\n    this.printmessages();\n    if(this.system.revealed) for(let n of this.system.nodes) \n      this.placenode(n,false);\n    for(let t of this.tiles){\n      let node=this.system.nodes[t.nodeid];\n      if(t.style.opacity==0) setTimeout(function(){\n        t.classList.add('discovered');\n      },1);\n      if(!node.visited) continue;\n      if(!t.style.border) t.classList.add('visited');\n      let avatar=node.getavatar(t.nodex,t.nodey);\n      if(t.image&&(!avatar||\n        avatar!=t.avatar||t.scanned!=avatar.scanned)) \n          this.removeimage(t);\n      if(avatar&&avatar!=t.avatar) this.addimage(t,avatar);\n    }\n  }\n}\n\nexport function refresh(){current.refresh();}\n","import {deck} from '../modules/deck';\nimport {getactive as getsystem} from '../modules/cyberspace/system';\nimport {console} from '../modules/cyberspace/console';\nimport {inject} from 'aurelia-framework';\nimport {BindingSignaler} from 'aurelia-templating-resources';\nimport {refresh as refreshcyberspace} from './infojack-cyberspace';\n\n@inject(BindingSignaler)\nexport class ProgramBar{\n  constructor(BindingSignaler) {\n    this.signals=BindingSignaler;\n    this.collapsed=true;\n    deck.sort();\n  }\n  \n  attached(){this.refresh();}\n  \n  refresh(){\n    this.programs=deck.programs.slice();\n    this.load=deck.memoryused;\n    this.totalload=deck.memory;\n    this.system=getsystem();\n    refreshcyberspace();\n    this.signals.signal('update-program-bar');\n  }\n  \n  toggle(){this.collapsed=!this.collapsed;}\n  \n  isloaded(program){\n    return deck.loaded.indexOf(program)>=0;\n  }\n  \n  geticonclass(program){\n    return this.isloaded(program)?\"loaded\":\"unloaded\";\n  }\n  \n  doload(program){\n    let result=program.load(this.system);\n    this.refresh();\n    return result;\n  }\n  \n  dounload(program){\n    let result=program.unload(this.system);\n    this.refresh();\n    return result;\n  }\n  \n  run(program){\n    //TODO skill roll\n    if(!this.isloaded(program)){\n      console.print('Load '+program.name+' first...');\n    }else if(program.run(this.system)){\n      //TODO ap cost\n      //TODO duration callback or check\n    }\n    this.refresh();\n  }\n}\n","import {hero,sign} from './character/character'\n\nvar OK='';\nvar MEMORYUPGRADE=[+10,+5,+5,+5];\n\nclass Deck{\n  constructor(){\n    this.memory=10;\n    this.storage=20;\n    this.deckgrade=1;\n    this.memorygrade=0;\n    this.storagegrade=0;\n    this.stealthgrade=0;\n    this.loaded=[];\n    this.programs=[];\n    this.memoryused=0;\n    this.storageused=0;\n  }\n  \n  upgrade(checkgrade,currentgrade,purchasedc,installdc,\n    apply){\n      if(currentgrade==4)\n        return 'Already at maximum grade.';\n      let upgrade=currentgrade+1;\n      if(checkgrade&&upgrade>this.deckgrade) \n        return 'Requires a deck upgrade.';\n      purchasedc+=2*(upgrade-1);\n      if(hero.wealth<purchasedc-10) \n        return 'Requires '+(purchasedc-10)+'.';\n      installdc+=1*(upgrade-1);\n      if(hero.getelectronics()<installdc-10) \n        return 'Requires electronics '+sign(installdc-10)\n          +'.';\n      if(apply&&!hero.buy(purchasedc))\n        return 'Unexpected not buy error.';\n      return OK;\n  }\n  \n  upgradedeck(apply){\n    let result=this.upgrade(false,this.deckgrade,10,12,apply);\n    if(result==OK&&apply) this.deckgrade+=1;\n    return result;\n  }\n  \n  upgradememory(apply){\n    let result=\n      this.upgrade(true,this.memorygrade,9,14,apply);\n    if(result==OK&&apply){\n      this.memory+=MEMORYUPGRADE[this.memorygrade];\n      this.memorygrade+=1;\n    }\n    return result;\n  }\n  \n  upgradestorage(apply){\n    let result=\n      this.upgrade(true,this.storagegrade,8,14,apply);\n    if(result==OK&&apply){\n      this.storage+=10;\n      this.storagegrade+=1;\n    }\n    return result;\n  }\n  \n  upgradestealth(apply){\n    let result=\n      this.upgrade(true,this.stealthgrade,10,12,apply);\n    if(result==OK&&apply) this.stealthgrade+=1;\n    return result;\n  }\n  \n  assign(data){\n    for(let key in data){\n      if(key in this){\n        this[key]=data[key];\n      }\n    }\n  }\n  \n  sort(){\n    this.programs.sort((a,b)=>a.compare(b));\n    this.loaded.sort((a,b)=>a.compare(b));\n  }\n}\n\nexport var deck=new Deck();\n","export var grades=\n  ['','I','II','III','IV','V','VI','VII','VIII','IX','X'];\n","class Rpg{\n    constructor(){}\n    \n    r(min,max){\n      return Math.floor((Math.random()*(max+1))+min);\n    }\n    \n    d(dice,sides){\n        let sum=0;\n        for(let i=0;i<dice;i++){\n            sum+=this.r(1,sides);\n        }\n        return sum;\n    }\n    \n    choose(list){\n      return list[this.r(0,list.length-1)];\n    }\n    \n    chancein(n){\n      n=Math.floor(n);\n      return n>=1&&this.r(1,n)==1;\n    }\n    \n    shuffle(array){\n      for (let i=array.length-1;i>0;i--) {\n        let j=this.r(0,i);\n        let swap=array[i];\n        array[i]=array[j];\n        array[j]=swap;\n      }\n      return array;\n    }\n    \n    randomize(amount){\n      return this.r(1,amount)-this.r(1,amount);\n    }\n}\n\nexport var rpg=new Rpg();\n","import {hero} from './character/character';\nimport environment from '../environment';\nimport {deck} from './deck';\nimport {PROGRAMS} from './program/program';\n\nclass Save{\n  constructor(){}\n  \n  checkload(){\n    return localStorage.getItem('infojack-save');\n  }\n  \n  debug(){\n    if(!environment.printsave) return;\n    let data=this.checkload();\n    if(data) alert(data);\n  }\n\n  saveprograms(programs){\n    return programs.map(p=>p.name);\n  }\n  \n  save(){\n    let data={};\n    data.hero=hero;\n    data.deck=Object.assign({},deck);\n    data.deck.loaded=this.saveprograms(data.deck.loaded);\n    data.deck.programs=this.saveprograms(data.deck.programs);\n    localStorage.setItem('infojack-save',\n      JSON.stringify(data));\n    this.debug();\n  }\n\n  loadprograms(deck){\n    let programs=[];\n    let loaded=[];\n    for(let name of deck.programs){\n      let p=PROGRAMS.get(name);\n      programs.push(p);\n      if(deck.loaded.indexOf(name)>=0) loaded.push(p);\n    }\n    deck.programs=programs;\n    deck.loaded=loaded;\n  }\n  \n  populate(data){\n    hero.assign(data.hero);\n    deck.assign(data.deck);\n    this.loadprograms(deck);\n    this.debug();\n  }\n  \n  load(){\n    let data=this.checkload();\n    if(!data) return false;\n    data=JSON.parse(data);\n    this.populate(data);\n    this.initialize();\n    return true;\n  }\n\n  initialize(){}\n\n  //TODO use on game lost\n  //TODO use on game won\n  clear(){localStorage.setItem('infojack-save','');}\n}\n\nexport var save=new Save();\n","var PREFIX='./sounds/';\n\nexport class Sound{\n    constructor(){\n        this.ERROR='Computer Error Alert-SoundBible.com-783113881.mp3';\n    }\n     \n    play(file){\n        new Audio(PREFIX+file).play();\n    }\n}\n","export function configure(config) {\n  //config.globalResources([]);\n}\n","//TODO convert primary BAB elsewhere\n\nimport {occupations} from './occupation';\nimport {webcrawler} from './class/webcrawler';\nimport {skills} from './skill';\nimport {rpg} from '../rpg';\nimport environment from '../../environment';\n\nvar ABILITYPOINTS=\n  Math.round((15+4*6)/(environment.fullattributes?1:2));\n\nexport var costs={\n    7:-4,\n    8:-2,\n    9:-1,\n    10:0,\n    11:1,\n    12:2,\n    13:3,\n    14:5,\n    15:7,\n    16:10,\n    17:13,\n    18:17,\n}\n\nexport class Character{\n  constructor(name){\n    this.name=name;\n    this.image=rpg.r(0,environment.playeravatars-1);\n    this.hp=0;\n    this.maxhp=0;\n    this.strength=7;\n    this.dexterity=7;\n    this.constitution=7;\n    this.intelligence=7;\n    this.wisdom=7;\n    this.charisma=7;\n    this.pointbuy=ABILITYPOINTS;\n    this.pointextra=0;\n    this.wealth=5; //average of 2d4 to prevent scumming\n    this.classskills=[];\n    this.classes={};//holds levels\n    this.level=0;\n    this.ranks=0;\n    this.bab=0;//hold only primary BAB\n    this.edgedice=[0,0];//0d1\n    this.edge=0;//current edge\n    this.fort=0;\n    this.ref=0;\n    this.will=0;\n    this.defence=0;\n    this.init=0;\n    this.speed=30;\n    this.talent=0;\n    if(environment.extratalents)\n      this.talent+=environment.extratalents;\n    this.contacts=0;//TODO\n    this.feats=[];\n    this.newfeats=2;\n    for(let s of skills.values()){\n      this[s.name.replace(' ','').toLowerCase()]=0;\n    }\n  }\n\n  assign(data){\n    for(let key in data){\n      if(key in this){\n        this[key]=data[key];\n      }\n    }\n  }\n  \n  setoccupation(occupation){\n      this.wealth+=occupation.wealth;\n      for(let s of occupation.skills){\n          this.addclassskill(s);\n      }\n  }\n  \n  addclassskill(s){\n      if(this.classskills.indexOf(s)<0){\n          this.classskills.push(s);\n      }\n  }\n  \n  connect(){\n    let avatar=new Character();\n    Object.assign(avatar,this);\n    if(this.classes['Webcrawler']){\n      this.enhancecrawler(avatar);\n    }\n    return avatar;\n  }\n  \n  enhancecrawler(avatar){\n    avatar.strength=Math.max(\n      avatar.strength,avatar.intelligence);\n    avatar.dexterity=Math.max(\n      avatar.dexterity,avatar.wisdom);\n    avatar.constitution=Math.max(\n      avatar.constitution,avatar.charisma);\n    for(let con=this.constitution+1;\n      con<=avatar.constitution;con++)\n        if(con%2==0) avatar.maxhp+=1;\n    avatar.hp=avatar.maxhp;\n    let level=this.classes['Webcrawler'];\n    avatar.bab-=[0,1,1,2,2,3,3,4,4,5][level-1];\n    avatar.bab+=level;\n  }\n  \n  getmodifier(ability){\n      if(ability%2==1){\n          ability-=1;\n      }\n      return (ability-10)/2;\n  }\n  \n  getranks(name){\n      return this[name.replace(' ','').toLowerCase()];\n  }\n  \n  setranks(name,value){\n      this[name.replace(' ','').toLowerCase()]=value;\n  }\n  \n  hasfeat(f){\n      f=f.name||f;\n      for(let feat of this.feats)\n        if(feat.name.toLowerCase()==f.toLowerCase())\n          return feat;\n      return false;\n  }\n  \n  addfeat(f){\n      this.feats.push(f);\n  }\n  \n  getskill(ranks,ability,feat,featbonus){\n      if(feat&&this.hasfeat(feat)) ranks+=featbonus;\n      ranks=ranks+this.getmodifier(ability);\n      return ranks;\n  }\n  \n  getbluff(){\n    return this.getskill(this.bluff,this.charisma,'power of belief',1);\n  }\n  \n  getconcentration(){\n      return this.getskill(\n        this.concentration,this.constitution,false,0);\n  }\n  \n  getdecryption(){\n    let decryption=this.getskill(\n      this.decryption,this.intelligence,'studious',2);\n    if(this.hasfeat('power of belief')) decryption+=1;\n    return decryption;\n  }\n  \n  getelectronics(){\n      return this.getskill(\n        this.electronics,this.intelligence,false,0);\n  }\n  \n  getforgery(){\n      return this.getskill(\n        this.forgery,this.intelligence,'meticulous',2);\n  }\n  \n  getinformation(){\n      return this.getskill(\n        this.information,this.charisma,'trustworthy',3);\n  }\n  \n  gethacking(){\n      return this.getskill(\n        this.hacking,this.intelligence,\n        'specialized equipment',1);\n  }\n  \n  getperceive(){\n      return this.getskill(this.perceive,this.wisdom,false,0);\n  }\n  \n  getmedicine(){\n      return this.getskill(this.medicine,this.wisdom,false,0);\n  }\n  \n  getstealth(){\n    let stealth=this.getskill(\n      this.stealth,this.dexterity,'stealthy',3);\n    if(this.hasfeat('power of belief')) stealth+=1;\n    return stealth;\n  }\n  \n  getprofession(){\n    return this.getskill(\n      this.profession,this.wisdom,false,0);\n  }\n  \n  getresearch(){\n      return this.getskill(\n        this.research,this.intelligence,'studious',2);\n  }\n  \n  getsearch(){\n    let search=this.getskill(\n      this.search,this.intelligence,'meticulous',2);\n    if(this.hasfeat('power of belief')) search+=1;\n    return search;\n  }\n  \n  gettechnology(){\n      return this.getskill(\n        this.technology,this.intelligence,'educated',3);\n  }\n  \n  getfortitude(){\n    return this.fort+this.getmodifier(this.constitution);\n  }\n  \n  getreflexes(){\n    return this.ref+this.getmodifier(this.dexterity);\n  }\n  \n  getwill(){\n    return this.will+this.getmodifier(this.wisdom);\n  }\n  \n  getinitiative(){\n    let init=this.init+this.getmodifier(this.dexterity);\n    if(this.hasfeat('improved initiative')) init+=4;\n    return init;\n  }\n  \n  getdefence(){\n    return 10+this.defence+this.getmodifier(this.dexterity);\n  }\n  \n  getmelee(){\n    return this.bab+this.getmodifier(this.strength);\n  }\n  \n  getranged(){\n    return this.bab+this.getmodifier(this.dexterity);\n  }\n  \n  price(purchasedc){\n    let price=purchasedc>=15?1:0;\n    let difference=purchasedc-this.wealth;\n    if(difference<1) return price;\n    if(difference<=10) return price+1;\n    price+=difference-10;\n    return price>12?12:price; \n  }\n  \n  /*TODO gather information takes 1 hour per purchasedc\n    * use this to find items of interest (1 store per type of buy: programs, deck, cyber) and create as many options until the total purchasedc is equal or bigger than 16 in a day (or 24h with manual sleeping/tired routines). Each gather information roll returns the maximum purchasedc of the found object (or manybe result-10).\n    * */\n  buy(purchasedc){\n    if(10+this.wealth<purchasedc) return false;\n    this.wealth-=this.price(purchasedc);\n    if(this.wealth<0) this.wealth=0;\n    return true;\n  }\n  \n  /*-3 for selling, -3 for illegal*/\n  sell(purchasedc){\n    let price=this.price(purchasedc-6);\n    this.wealth+=price;\n    return price;\n  }\n  \n  /* As per level-up rules, in Infojack may be used to\n    * represent mission payment values or similar. TODO */\n  upgradewealth(){\n    let taketen=10+this.getprofession();\n    if(taketen<this.wealth) return 0;\n    let wealth=1;\n    taketen-=this.wealth;\n    while(taketen>=5){\n      wealth+=1;\n      taketen-=5;\n    }\n    return wealth;\n  }\n  \n  possess(){\n    let letter=this.name[this.name.length-1].toLowerCase();\n    let name=this.name+\"'\";\n    if(letter!='s') name+='s';\n    return name;\n  }\n}\n\nexport function sign(n){return n>=0?'+'+n:n;}\n\nexport var hero=new Character('Player1');\nhero.setoccupation(occupations.adventurer);\nwebcrawler.advance(hero); //becomes level 1\n\n//TODO actually buy these programs once they're ready\nconsole.log('Initial wealth: '+hero.wealth);\nconsole.log('Purchase deck: '+hero.price(10));\nconsole.log('Purchase flicker: '+hero.price(14));\nconsole.log('Purchase blade: '+hero.price(9));\nconsole.log('Purchase cloak: '+hero.price(9));\nhero.buy(10);hero.buy(9);hero.buy(9);hero.buy(14);//TODO CHECK\nconsole.log('Final wealth: '+hero.wealth);\n","export var feats=new Map();\n\nexport class Feat{\n    constructor(name,description){\n        this.name=name;\n        this.description=description;\n        this.talent=false;\n    }\n    \n    validate(character){\n        return !character.hasfeat(this);\n    }\n    \n    apply(character){\n        character.addfeat(this);\n    }\n}\n\nexport class Talent extends Feat{\n  constructor(name,description){\n    super(name,description);\n    this.talent=true;\n  }\n}\n\nclass Educated extends Feat{\n    constructor(){\n        super('Educated','+3 to Techonology rolls');\n    }\n}\n\nclass Meticulous extends Feat{\n    constructor(){\n        super('Meticulous','+2 to Forgery and Search rolls');\n    }\n}\n\nclass Stealthy extends Feat{\n    constructor(){\n        super('Stealthy','+3 to Stealth rolls');\n    }\n}\n\nclass Studious extends Feat{\n    constructor(){\n        super('Studious','+2 to Decrypt and Research rolls');\n    }\n}\n\nclass Trustworthy extends Feat{\n    constructor(){\n        super('Trustworthy','+3 to Information rolls');\n    }\n}\n\nclass ImprovedInitiative extends Feat{\n   constructor(){\n        super('Improved initiative',\n              '+4 to initiative rolls');\n    }\n}\n\nclass Windfall extends Feat{\n   constructor(){\n        super('Windfall',\n          '+3 wealth (may be taken multiple times)');\n    }\n    validate(character){return true;}\n    apply(character){character.wealth+=3;}\n}\n\nfor(let feat of [\n    new Educated(),\n    new ImprovedInitiative(),\n    new Meticulous(),\n    new Stealthy(),\n    new Stealthy(),\n    new Studious(),\n    new Trustworthy(),\n    new Windfall(),\n]) feats.set(feat.name.toLowerCase(),feat);\n","import {skills,checkskills} from './skill';\n\n//TODO feats\nclass Occupation{\n    constructor(wealth,skillsp){\n        this.wealth=wealth;\n        this.skills=skillsp;\n        checkskills(skillsp);\n    }\n}\n\nexport var occupations={};\n\noccupations.adventurer=new Occupation(+1,['Bluff','Technology','Stealth','Perceive','Medicine']);\n","class Skill{\n    constructor(name,ability,description){\n        this.name=name;\n        this.ability=ability; //used only as a label\n        this.description=description;\n    }\n}\n\nexport var skills=new Map();\n\n//TODO Concentration wasnt on the first draft, check class skills\nfor (let skill of [\n    new Skill('Bluff','Charisma',\n        \"Convince ICE you're not an intruder\"),\n    new Skill('Concentration','Constitution',\n        \"Focus your mind while in danger\"),\n    new Skill('Decryption','Intelligence',\n        \"Break into protected data\"),\n    new Skill('Electronics','Intelligence',\n        \"Build and install hardware\"),\n    new Skill('Forgery','Intelligence',\n        \"Forge authentication credentials\"),\n    new Skill('Hacking','Intelligence',\n        \"Act on the Web\"),\n    new Skill('Information','Charisma',\n        \"Find more shopping items and missions\"),\n    new Skill('Medicine','Wisdom',\n        \"Treat your injuries\"),\n    new Skill('Perceive','Wisdom',\n        \"Basic processing of Web stimuli.\"),\n    new Skill('Profession','Wisdom',\n        \"Earn more money per contract\"),\n    new Skill('Research','Intelligence',\n        \"Do perimeter checks on Frames\"),\n    new Skill('Search','Intelligence',\n        \"Scan avatars for more information.\"),\n    new Skill('Stealth','Dexterity',\n        \"Avoid being detected on the Web\"),\n    new Skill('Technology','Intelligence',\n        \"Create your own programs\"),\n]){\n    skills.set(skill.name,skill);\n}\n\nexport function checkskills(ss){\n    for(let s of ss) if(!skills.get(s)) alert('Unknown skill: '+s);\n    return ss;\n}\n","class Message{\n  constructor(text,system){\n    this.text=text;\n    this.alert=system.alert;\n  }\n}\n\nclass Console{\n  constructor(){\n    this.messages=[];\n    this.system=false;\n  }\n  print(message){\n    if(!this.system) throw 'System not set';\n    this.messages.push(\n      new Message(message,this.system));\n  }\n  pop(){\n    return this.messages.pop();\n  }\n}\n\nexport var console=new Console();\n","import {rpg} from '../rpg';\nimport {Node} from './node/node';\nimport {Datastore} from './node/datastore';\nimport {Cpu} from './node/cpu';\nimport {Portal} from './node/portal';\nimport {Interface} from './node/interface';\nimport environment from '../../environment';\n\nvar active=false;\n\nexport class System{\n  constructor(level){\n    this.revealed=false; //reveal all map\n    this.level=level;\n    if(this.level<1) this.level=1;\n    else if(this.level>20) this.level=20;\n    this.alert=0;\n    this.nodes=[];\n    this.ice=[];\n    this.entrance=null;\n    this.generatemap();\n    this.definenodes();\n    for(let n of this.nodes) n.generate();\n    this.player=false; //set by Player\n    active=this;\n    this.debug();\n  }\n  \n  debug(){\n    if(environment.revealmap) this.reveal();\n    if(environment.scannodes)\n      for(let n of this.nodes) for(let a of n.avatars){\n        a.scan();\n        a.scanned=true;\n      }\n  }\n  \n  getnode(x,y){\n    for(let n of this.nodes) if(x==n.x&&y==n.y) return n;\n    return null;\n  }\n  \n  generatemap(){\n    this.nodes.push(new Cpu(0,0,this));\n    let size=rpg.r(3,7)+this.level;\n    let leastx=0;\n    let leasty=0;\n    while(this.nodes.length<size){\n      let n=rpg.choose(this.nodes);\n      let x=n.x;\n      let y=n.y;\n      if(rpg.chancein(2)) x+=rpg.chancein(2)?+1:-1;\n      else y+=rpg.chancein(2)?+1:-1;\n      if(this.getnode(x,y)) continue;\n      this.nodes.push(new Node(x,y,this));\n      if(x<leastx) leastx=x;\n      if(y<leasty) leasty=y;\n    }\n    for(let n of this.nodes){ //ensure node.x>=0 node.y>=0\n      n.x-=leastx;\n      n.y-=leasty;\n    }\n  }\n  \n  replacenode(target,i){\n    let original=this.nodes[i];\n    target.id=original.id;\n    target.x=original.x;\n    target.y=original.y;\n    this.nodes[i]=target;\n  }\n  \n  findentrance(neighbors){\n    let portals=this.nodes.filter(\n      n=>n.id!=0&&n.getneighbors().length==neighbors); \n    if(portals.length==0) return -1;\n    return this.nodes.indexOf(rpg.choose(portals));\n  }\n  \n  generatenode(){\n    if(rpg.chancein(10)) return new Cpu(-1,-1,this);\n    if(rpg.chancein(4)) return new Interface(-1,-1,this);\n    return new Datastore(-1,-1,this);\n  }\n  \n  definenodes(){\n    this.nodes[0].setmain();\n    let entrancei=-1;\n    for(let neighbors=1;entrancei==-1;neighbors++){\n      entrancei=this.findentrance(neighbors);\n    }\n    this.entrance=new Portal(-1,-1,this);\n    this.replacenode(this.entrance,entrancei);\n    for(let i=1;i<this.nodes.length;i++){\n      if(i==entrancei) continue;\n      let neighbors=this.nodes[i].getneighbors().length;\n      let corridor=neighbors>1&&rpg.chancein(6-neighbors);\n      if(corridor) continue;\n      this.replacenode(this.generatenode(),i);\n    }\n  }\n  \n  reveal(){\n    this.revealed=true;\n    for(let n of this.nodes) n.visited=true;\n  }\n  \n  raisealert(){\n    if(this.alert<2) this.alert+=1;\n  }\n  \n  cancelalert(){\n    if(this.alert>0) this.alert-=1;\n  }\n}\n\n//TODO manually set active\nexport function getactive(){return active;}\n","import {Program,SESSION,PROGRAMS} from './program';\nimport {console} from '../cyberspace/console';\n\nclass Armor extends Program{\n  constructor(grade){\n    super('Armor',grade,4,10,20);\n    this.duration=SESSION;\n    this.defence=+4+(grade-1);\n  }\n  \n  modify(bonus,player){\n    player.hero.defence+=bonus;\n    console.print('Your defence is now '+\n      player.hero.getdefence()+'.');\n  }\n  \n  load(system){\n    if(!super.load(system)) return false;\n    this.modify(this.defence,system.player);\n    return true;\n  }\n  \n  unload(system){\n    if(!super.unload(system)) return false;\n    this.modify(-this.defence,system.player);\n    return true;\n  }\n  \n  describe(){\n    return 'Adds +'+this.defence+' to defence';\n  }\n  \n  run(system){\n    console.print(\"Armor is already active.\");\n    return false;\n  }\n}\n\nfor(let armor=+4;armor<=+10;armor++)\n  new Armor(armor-3);\n","import {deck} from '../deck';\nimport {grades} from '../grade';\nimport {console} from '../cyberspace/console';\n\nexport var SESSION=Number.MAX_SAFE_INTEGER;\nexport var PROGRAMS=new Map();\n\nexport class Program{\n  constructor(name,grade,hack,buy,code){\n    this.hackingdc=hack;\n    this.purchasedc=buy;\n    this.programmingdc=code;\n    this.size=1; //MBs / blocks\n    this.apcost=.5;\n    this.duration=0; //0=instantaneous SESSION=permanent\n    this.basename=name;\n    this.name=name;\n    this.grade=grade;\n    if(grade){\n      this.name+=' '+grades[grade];\n      if(grade>1) this.upgrade(grade-1);\n    }\n    PROGRAMS.set(this.name,this);\n  }\n  \n  conflict(program){return this.basename==program.basename;}\n  \n  load(system){\n    for(let program of deck.loaded) \n      if(this.conflict(program)){\n        console.print(\n          'You cannot load '+this.name+' while '+\n            program.name+' is loaded...');\n        return false;\n      }\n    if(deck.memoryused+this.size>deck.memory){\n      console.print(\n        'This program requires '+this.size+' free blocks.');\n      return false;\n    }\n    deck.memoryused+=this.size;\n    deck.loaded.push(this);\n    return true;\n  }\n  \n  unload(system){\n    let i=deck.loaded.indexOf(this);\n    if(i<0) return false;\n    deck.memoryused-=this.size;\n    deck.loaded.splice(i,1);\n    return true;\n  }\n  \n  run(system){return false;}\n  \n  upgrade(ntimes){\n    this.hackingdc+=ntimes;\n    this.purchasedc+=ntimes;\n    this.programmingdc+=ntimes;\n    this.size+=ntimes/2;\n  }\n  \n  describe(){return this.name;}\n  \n  compare(program){\n    if(this.basename==program.basename)\n      return this.grade-program.grade;\n    return this.basename.localeCompare(program.basename);\n  }\n}\n","/* TODO \n * - for advanced classes, have edge dice as part of levelup\n */\n\nimport {checkskills} from '../skill';\nimport {rpg} from '../../rpg';\nimport {webcrawler} from './webcrawler';\n\nexport class Class{\n    constructor(){this.talents=new Map();}\n    \n    advance(character){\n        let level=character.classes[this.name];\n        if(!level) level=0;\n        level+=1;\n        if(level>10) {\n            throw 'Cannot advance past level 10!';\n        }\n        character.level+=1;\n        this.levelup(character,level);\n        character.classes[this.name]=level;\n    }\n    \n    upgradehp(character){\n      if(character.level==1){\n          character.maxhp=this.hd;\n          character.hp=character.maxhp;\n      }else{\n          let hp=Math.round((1+this.hd)/2);\n          character.maxhp+=hp;\n          character.hp+=hp;\n      }\n    }\n    \n    upgraderanks(character,classlevel){\n      let ranks=this.ranks+\n        character.getmodifier(character.intelligence);\n      character.ranks+=Math.max(1,ranks);\n      if(character.level==1) character.ranks*=4;\n      if(classlevel==1) for(let s of this.skills)\n        character.addclassskill(s);\n    }\n    \n    levelup(character,classlevel){\n      for(let stat of ['bab','fort','ref','will','defence'])\n        this.upgradestat(classlevel,stat,character);\n      this.upgradeedgedice(classlevel,character);\n      this.upgradereputation(character,classlevel);\n      this.upgradehp(character);\n      this.upgraderanks(character,classlevel);\n      if(character.level%3==0) character.newfeats+=1;\n      if(character.level%4==0) character.pointextra+=1;\n      //TODO may want to do this through external means to make it explicit to the player (as mission payment rates for example):\n      if(character.level>1) character.upgradewealth(); \n    }\n    \n    upgradestat(level,stat,character){\n        let last=level>1?this[stat][level-2]:0;\n        let current=this[stat][level-1];\n        character[stat]+=current-last;\n    }\n    \n    upgradeedgedice(level,character){\n        let target=this.edgedice[level-1].split('d');\n        target=[parseInt(target[0]),parseInt(target[1])];\n        if(target[0]>character.edgedice[0]||\n          (target[0]==character.edgedice[0]&&\n            target[1]>=character.edgedice[1]))\n              character.edgedice[0]=target[0];\n              character.edgedice[1]=target[1];\n        if(character.level==1) \n          character.edge+=character.edgedice[0];\n    }\n    \n    upgradereputation(character,level){\n        if(level==1){\n            if(this.reputation[0]>0){\n                //TODO boost\n            }\n        }else if(this.reputation[level-1]>\n                this.reputation[level-2]){\n            //TODO boost\n        }\n    }\n    \n    check(skills){\n      return checkskills(skills);\n    }\n}\n\nClass.classes=new Map();\n","import {Talent} from '../feat'; \nimport {Class} from './class'; \n\nclass TheWebIsAlive extends Talent{\n  constructor(){\n    super('The web is alive',\n      'Adds Will to Perception rolls (requires level 3 and Power of Belief)');\n  }\n  \n  validate(character){\n    return super.validate(character)&&\n      character.level>=3&&\n      character.hasfeat('power of belief');\n  }\n}\n\nclass SpecializedEquipment extends Talent{\n  constructor(){\n    super('Specialized equipment',\n      '+1 to hacking rolls, +5 speed, safe disconnections (requires 4 in hacking, electronics and technology)');\n  }\n  \n  validate(character){\n    return super.validate(character)\n      &&character.hacking>=4\n      &&character.electronics>=4\n      &&character.technology>=4;\n  }\n  \n  apply(character){\n    super.apply(character);\n    character.speed+=5;\n  }\n}\n\nclass Webcrawler extends Class{\n    constructor(){\n        super();\n        this.name='Webcrawler';\n        this.skills=this.check(['Hacking', 'Electronics', 'Decryption', /*'Disable device',*/ 'Forgery', 'Technology', 'Profession', 'Research', 'Technology', 'Search']);\n        this.hd=4;\n        this.ranks=7;\n        this.bab=[0,1,1,2,2,3,3,4,4,5];\n        this.fort=[0,0,1,1,1,2,2,2,3,3];\n        this.ref=[1,2,2,2,3,3,4,4,4,5];\n        this.will=[1,2,2,2,3,3,4,4,4,5];\n        this.defence=[1,1,2,2,2,3,3,3,4,4];\n        this.reputation=[0,1,1,2,2,3,3,4,4,5];\n        this.edgedice=['1d4','1d4','2d4','2d6','2d6','3d6','3d8','3d8','4d8','4d10'];\n        let talents=[\n          new Talent('Hackmastery',\n            '+2 to all damage inflicted'),\n          new Talent('Phreakmastery',\n            'Safe connections, +1 against traces'),\n          new Talent('Power of belief',\n            '+1 to bluff, decryption, search and stealth'),\n          new SpecializedEquipment(),\n          new TheWebIsAlive(),\n          ];\n        for(let t of talents)\n          this.talents.set(t.name,t);\n    }\n    \n    levelup(character,classlevel){\n        super.levelup(character,classlevel);\n        let level=character.level;\n        if(level==1||level==3||level==6||level==9){\n            character.talent+=1;\n        }else if(level==4||level==7){\n            character.ranks+=1;\n        }else if(level==5||level==8){\n            character.contacts+=1;\n        }else if(level==10){\n            character.wealth+=5;\n            //TODO +5 reputation to law and hackers\n        }\n    }\n}\n\nexport var webcrawler=new Webcrawler();\nClass.classes.set(webcrawler.name,webcrawler);\n","import {Avatar} from './avatar';\n\nexport class Alarm extends Avatar{\n  constructor(system){\n    super('nodes/core.png',system);\n    this.tooltip='Process';\n  }\n  \n  scan(){\n    this.setimage('nodes/alarm.bmp');\n    this.tooltip='Alarm';\n  }\n  \n  click(){\n    super.click();\n  }\n}\n","import {System} from '../system';\nimport {rpg} from '../../rpg';\nimport {console} from '../console';\n\nexport class Avatar{\n  constructor(image,system){\n    this.setimage(image);\n    if(!(system instanceof System))\n      throw 'system type: '+system.constructor.name;\n    this.system=system;\n    this.node=null;\n    this.x=-1;\n    this.y=-1;\n    this.tooltip=this.constructor.name;\n    this.scanned=false;\n    this.scandc=this.system+rpg.randomize(10);\n    if(this.scandc<1) this.scandc=1;\n  }\n  \n  setimage(image){this.image='./images/'+image;}\n  \n  enter(node){\n    let source=this.node;\n    if(node==source) return false;\n    if(source&&source.getneighbors().indexOf(node)<0){\n      console.print(\"Can only access adjacent nodes...\");\n      return false;\n    }\n    return node.enter(this);\n  }\n  \n  click(){alert('Unimplemented.');}\n  \n  scan(){return true;}\n}\n","import {Avatar} from './avatar';\n\nexport class Backdoor extends Avatar{\n  constructor(system){\n    super('nodes/core.png',system);\n    this.tooltip='Process';\n  }\n  \n  scan(){\n    this.setimage('nodes/backdoor.bmp');\n    this.tooltip='Backdoor';\n  }\n}\n","import {Avatar} from './avatar';\nimport {rpg} from '../../rpg';\n\nvar OUTCOMES=2;\n\nexport class Control extends Avatar{\n  constructor(system){\n    super('nodes/core.png',system);\n    this.tooltip='Process';\n    this.memory=rpg.chancein(OUTCOMES);\n    this.privilege=rpg.chancein(OUTCOMES);\n  }\n  \n  scan(){\n    if(!this.memory&&!this.privilege) this.node.remove(this);\n    this.setimage('nodes/control.png');\n    this.tooltip='Control';\n  }\n}\n","import {Avatar} from './avatar';\n\nexport class Entry extends Avatar{\n  constructor(system){\n    super('nodes/core.png',system);\n    this.tooltip='Process';\n  }\n  \n  scan(){\n    this.setimage('nodes/entry.png');\n    this.tooltip='ICE entry';\n  }\n  \n  click(){\n    super.click();\n  }\n}\n","import {Avatar} from './avatar';\nimport {rpg} from '../../rpg';\n\nexport class File extends Avatar{\n  constructor(system){\n    super('nodes/fileunscanned.png',system);\n    this.tooltip='Data';\n    this.level=system.level+rpg.randomize(4);\n    this.worthless=this.level<1||rpg.chancein(system.level+1);\n    this.trap=!this.worthless&&\n      rpg.chancein(60/system.level);\n    this.protected=!this.worthless&&!this.trap&&\n      rpg.chancein(21/system.level);\n    if(this.worthless) this.level=0;\n    else if(this.protected&&this.level<system.level) \n      this.level=system.level;\n  }\n  \n  click(){\n    super.click();\n  }\n  \n  scan(){\n    if(this.worthless){\n      this.node.remove(this);\n    }else if(this.protected){\n      this.setimage('nodes/fileprotected.png');\n      this.tooltip='Protected data';\n    }else if(this.trap){\n      this.setimage('nodes/filetrap.png');\n      this.tooltip='Trap data';\n    }else{\n      this.setimage('nodes/file.png');\n    }\n  }\n}\n","import {Avatar} from './avatar';\n\nexport class Gateway extends Avatar{\n  constructor(system){\n    super('nodes/gateway.png',system);\n    this.scanned=true;\n  }\n}\n","import {Avatar} from './avatar';\n\nexport class Map extends Avatar{\n  constructor(system){\n    super('nodes/core.png',system);\n    this.tooltip='Process';\n  }\n  \n  scan(){\n    this.setimage('nodes/map.bmp');\n    this.tooltip='Map';\n  }\n  \n  click(){\n    this.system.reveal();\n    this.node.remove(this);\n  }\n}\n","import {Avatar} from './avatar';\nimport {console} from '../console';\nimport {hero as offlinehero} from '../../character/character';\n\nexport class Player extends Avatar{\n  constructor(system){\n    super('characters/'+offlinehero.image+'.png',system);\n    this.hero=offlinehero.connect();\n    this.scanned=true;\n    this.tooltip=this.hero.name;\n    system.player=this;\n  }\n  \n  enter(node){\n    if(!super.enter(node)) return false;\n    node.visited=true;\n    node.scan(); //TODO passive scan, roll-4\n    return true;\n  }\n}\n","import {Avatar} from './avatar';\n\nexport class Terminal extends Avatar{\n  constructor(system){\n    super('nodes/core.png',system);\n    this.tooltip='Process';\n  }\n  \n  scan(){\n    this.setimage('nodes/terminal.png');\n    this.tooltip='Terminal';\n  }\n  \n  click(){\n    super.click();\n  }\n}\n","import {rpg} from '../../rpg';\nimport {Node} from './node';\nimport {Alarm} from '../avatar/alarm';\nimport {Entry} from '../avatar/entry';\nimport {Map} from '../avatar/map';\nimport {Terminal} from '../avatar/terminal';\n\nvar FUNCTIONS=4;\n\nexport class Cpu extends Node{\n  constructor(x,y,system){\n    super(x,y,system)\n    this.priority=2;\n  }\n  \n  setmain(){\n    this.enter(new Alarm(this.system));\n    this.enter(new Entry(this.system));\n    this.enter(new Map(this.system));\n    this.enter(new Terminal(this.system));\n  }\n  \n  generate(){\n    while(this.avatars.length==0){\n      if(rpg.chancein(FUNCTIONS)) \n        this.enter(new Alarm(this.system));\n      if(rpg.chancein(FUNCTIONS)) \n        this.enter(new Entry(this.system));\n      if(rpg.chancein(FUNCTIONS)) \n        this.enter(new Map(this.system));\n      if(rpg.chancein(FUNCTIONS)) \n        this.enter(new Terminal(this.system));\n    }\n  }\n}\n","import {Node} from './node';\nimport {File} from '../avatar/file';\nimport {rpg} from '../../rpg';\n\nexport class Datastore extends Node{\n  constructor(x,y,system){\n    super(x,y,system)\n    this.priority=1;\n  }\n  \n  generate(){\n    let files=rpg.r(1,4);\n    for(let i=0;i<files;i++){\n      this.enter(new File(this.system));\n    }\n  }\n}\n","import {Node} from './node';\nimport {Backdoor} from '../avatar/backdoor';\nimport {Control} from '../avatar/control';\nimport {rpg} from '../../rpg';\n\nexport class Interface extends Node{\n  constructor(x,y,system){\n    super(x,y,system)\n    this.priority=1;\n  }\n  \n  generate(){\n    while(this.avatars.length==0){\n      if(rpg.chancein(4)) this.enter(new Control(this.system));\n      if(rpg.chancein(6)) this.enter(new Backdoor(this.system));\n    }\n  }\n}\n","import {rpg} from '../../rpg';\nimport environment from '../../../environment';\n\nvar TILES=[];\n\nfor(let x=0;x<environment.nodesize;x++) \n  for(let y=0;y<environment.nodesize;y++)\n    TILES.push([x,y]);\n\nexport class Node{\n  constructor(x,y,system){\n    this.x=x;\n    this.y=y;\n    this.id=system.nodes.length;\n    this.priority=0;\n    this.system=system;\n    this.avatars=[];\n    this.visited=false;\n  }\n  \n  generate(){\n    // override\n  }\n  \n  getneighbors(){\n    let neighbors=[];\n    for(let xy of [[-1,0],[+1,0],[0,+1],[0,-1]]){\n      let n=this.system.getnode(this.x+xy[0],this.y+xy[1]);\n      if(n) neighbors.push(n);\n    }\n    return neighbors;\n  }\n  \n  getavatar(x,y){\n    for(let a of this.avatars) if(a.x==x&&a.y==y) return a;\n    return null;\n  }\n  \n  remove(avatar){\n    this.avatars.splice(this.avatars.indexOf(avatar),1);\n  }\n  \n  /* return true if found free spot\n   * should only be called by Avatar#enter() */\n  enter(avatar){\n    rpg.shuffle(TILES);\n    console.log('#nodetiles '+JSON.stringify(TILES));\n    for(let xy of TILES) if(!this.getavatar(xy[0],xy[1])){\n      if(avatar.node) avatar.node.remove(avatar);\n      avatar.x=xy[0];\n      avatar.y=xy[1];\n      avatar.node=this;\n      this.avatars.push(avatar);\n      return true;\n    }\n    return false;\n  }\n  \n  /* scan avatars randomly\n   * return false if one fails or true if all done */\n  scan(){ //TODO skill test\n    let avatars=rpg.shuffle(this.avatars.slice());\n    for(let a of avatars){\n      if(!a) alert(JSON.stringify(avatars));\n      if(!a.scanned){\n        if(false) return false;\n        a.scan();\n        a.scanned=true;\n      }\n    }\n    return true;\n  }\n}\n","import {Node} from './node';\nimport {Gateway} from '../avatar/gateway';\n\n//TODO make it part of the normal generation to hop to other systems\n//TODO at first can even have it as \"stairs down\"\nexport class Portal extends Node{\n  constructor(x,y,system){\n    super(x,y,system)\n    this.priority=2;\n  }\n  \n  generate(){\n    this.enter(new Gateway(this.system));\n  }\n}\n"],"sourceRoot":".."}