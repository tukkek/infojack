{"version":3,"sources":["app.js","empty.js","environment.js","infojack-cyberspace.js","infojack-mainmenu.js","infojack-radio.js","infojack-topmenu.js","main.js","messages.js","character/character-abilities.js","character/character-details.js","character/character-feats.js","character/character-general.js","character/character-screen.js","character/character-skills.js","character/character-talents.js","modules/rpg.js","modules/save.js","modules/sound.js","resources/index.js","modules/character/character.js","modules/character/feat.js","modules/character/occupation.js","modules/character/skill.js","modules/cyberspace/console.js","modules/cyberspace/system.js","modules/character/class/class.js","modules/character/class/webcrawler.js","modules/cyberspace/avatar/alarm.js","modules/cyberspace/avatar/avatar.js","modules/cyberspace/avatar/backdoor.js","modules/cyberspace/avatar/control.js","modules/cyberspace/avatar/entry.js","modules/cyberspace/avatar/file.js","modules/cyberspace/avatar/gateway.js","modules/cyberspace/avatar/map.js","modules/cyberspace/avatar/player.js","modules/cyberspace/avatar/terminal.js","modules/cyberspace/node/cpu.js","modules/cyberspace/node/datastore.js","modules/cyberspace/node/interface.js","modules/cyberspace/node/node.js","modules/cyberspace/node/portal.js"],"names":["App","Example","debug","testing","nodesize","fullattributes","ccskills","playeravatars","revealmap","scannodes","printsave","systemlevel","view","TILESIZE","SPACING","FADETIME","Cyberspace","sound","messaging","showconsole","me","subscribe","show","init","map","document","querySelector","innerHTML","console","system","level","player","tiles","drawn","draw","clicktile","tile","tagName","parentNode","node","nodes","nodeid","avatar","getavatar","nodex","nodey","click","enter","placenode","refresh","placetile","x","y","createElement","push","classList","add","id","onclick","style","width","height","left","top","placespacer","farx","fary","t","bounds","getBoundingClientRect","right","bottom","spacer","body","scrollTop","scrollLeft","appendChild","expand","indexOf","getneighbors","n","print","entrance","scrollIntoView","addimage","scanned","image","src","title","tooltip","removeimage","opacity","fade","setTimeout","removeChild","printmessages","m","pop","color","alert","div","createTextNode","text","scrollHeight","revealed","visited","border","MainMenu","hassave","checkload","close","showpending","play","ERROR","startgame","prompt","confirm","clear","loadgame","load","open","publish","openrepository","window","Radio","active","audio","pause","TopMenu","hideradio","configure","Promise","config","warnings","wForgottenReturn","aurelia","use","standardConfiguration","feature","developmentLogging","plugin","start","then","setRoot","ShowView","CharacterAbilities","attached","full","strength","dexterity","constitution","intelligence","wisdom","charisma","pointbuy","pointextra","save","clone","Object","assign","upgrade","ability","current","raised","buy","ranks","next","cost","CharacterDetails","abilities","saves","skills","classes","bind","connect","sign","getmodifier","toLowerCase","getsave","getskill","skill","name","replace","CharacterFeats","BindingSignaler","signals","viewname","points","newfeats","feat","apply","signal","validate","getcurrent","feats","f","talent","getall","CharacterGeneral","hero","avatars","focus","select","CharacterScreen","showgeneral","showabilities","showskills","showfeats","showtalents","showdetails","e","target","charactermenu","childNodes","button","remove","CharacterSkills","values","s","getranks","iscrossclass","classskills","includes","canupgrade","setranks","wealth","value","getability","substring","toUpperCase","CharacterTalents","talents","Map","c","get","set","addfeat","Rpg","r","min","max","Math","floor","random","d","dice","sides","sum","i","choose","list","length","chancein","shuffle","array","j","swap","randomize","amount","rpg","Save","localStorage","getItem","data","JSON","parse","populate","initialize","setItem","stringify","PREFIX","Sound","file","Audio","ABILITYPOINTS","round","costs","Character","hp","maxhp","bab","edgedice","edge","fort","ref","will","defence","extratalents","contacts","key","setoccupation","occupation","addclassskill","enhancecrawler","hasfeat","featbonus","getbluff","bluff","getconcentration","concentration","getdecryption","decryption","getelectronics","electronics","getforgery","forgery","getinformation","information","gethacking","hacking","getperceive","perceive","getmedicine","medicine","getstealth","stealth","getprofession","profession","getresearch","research","getsearch","search","gettechnology","technology","getfortitude","getreflexes","getwill","getinitiative","getdefence","getmelee","getranged","price","purchasedc","difference","sell","upgradewealth","taketen","adventurer","advance","log","Feat","description","character","Talent","Educated","Meticulous","Stealthy","Studious","Trustworthy","ImprovedInitiative","Windfall","Occupation","skillsp","occupations","checkskills","Skill","ss","Message","Console","messages","message","System","ice","generatemap","definenodes","generate","reveal","a","scan","getnode","size","leastx","leasty","replacenode","original","findentrance","neighbors","portals","filter","generatenode","setmain","entrancei","corridor","raisealert","cancelalert","Class","levelup","upgradehp","hd","upgraderanks","classlevel","stat","upgradestat","upgradeedgedice","upgradereputation","last","split","parseInt","reputation","check","TheWebIsAlive","SpecializedEquipment","Webcrawler","webcrawler","Alarm","setimage","Avatar","constructor","scandc","Backdoor","OUTCOMES","Control","memory","privilege","Entry","File","worthless","trap","protected","Gateway","Player","Terminal","FUNCTIONS","Cpu","priority","Datastore","files","Interface","TILES","Node","xy","splice","slice","Portal"],"mappings":"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","file":"app-bundle.js","sourcesContent":["export class App {\n  constructor() {\n  }\n}\n","export class Example {\n    constructor() {\n    }\n}\n","export default {\n  /* environment */\n  debug:true,\n  testing:true,\n  /* game options */\n  nodesize:4, //grid size for each node\n  fullattributes:false, //no sense in having physical now\n  ccskills:false, //only 1 is cross-class, so disable for now\n  playeravatars:17,\n  /* debug flags (false=disabled) */\n  revealmap:true,\n  scannodes:true,\n  printsave:false, \n  systemlevel:false, //override system level (1-20)\n  view:false, //starting view name\n};\n","import {System} from './modules/cyberspace/system';\nimport {Player} from './modules/cyberspace/avatar/player';\nimport {console} from './modules/cyberspace/console';\nimport {inject} from 'aurelia-framework';\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {Sound} from './modules/sound';\nimport {ShowView} from './messages';\nimport environment from './environment';\nimport {hero} from './modules/character/character';\n\nvar TILESIZE=2.5;\nvar SPACING=1.1;\nvar FADETIME=2000;\n\n@inject(Sound,EventAggregator)\nexport class Cyberspace{\n  constructor(sound,messaging){\n    this.showconsole=false;\n    let me=this;\n    messaging.subscribe(ShowView,function(show){\n        if(show.view=='Cyberspace') me.init();\n    });\n  }\n  \n  init(){\n    //TODO clean previous run\n    this.map=document.querySelector('#cyberspace');\n    this.map.innerHTML='';\n    this.showconsole=true;\n    this.console=document.querySelector('#console');\n    this.console.innerHTML='';\n    this.system=\n      new System(environment.systemlevel||hero.level);\n    this.player=\n      new Player(hero,this.system);\n    this.tiles=[];\n    this.drawn=[];\n    this.draw();\n  }\n\n  clicktile(tile){\n    if(tile.tagName=='IMG') tile=tile.parentNode;\n    let node=this.system.nodes[tile.nodeid];\n    let avatar=node==this.player.node&&\n      node.getavatar(tile.nodex,tile.nodey);\n    if(avatar){\n      avatar.click();\n    }else{\n      this.player.enter(node);\n      this.placenode(node,true);\n    }\n    this.refresh();\n  }\n\n  placetile(x,y,node){\n    let tile=document.createElement('div');\n    this.tiles.push(tile);\n    tile.classList.add('tile');\n    tile.nodeid=node.id;\n    tile.nodex=x;\n    tile.nodey=y;\n    let me=this;\n    tile.onclick=function(){me.clicktile(this);};\n    let style=tile.style;\n    style.width=TILESIZE+'em';\n    style.height=TILESIZE+'em';\n    style.left=(node.x*SPACING*environment.nodesize+x)\n      *TILESIZE+'em';\n    style.top=(node.y*SPACING*environment.nodesize+y)\n      *TILESIZE+'em';\n    return tile;\n  }\n\n  placespacer(){\n    let farx=0;\n    let fary=0;\n    for(let t of this.tiles){\n      let bounds=t.getBoundingClientRect();\n      if(bounds.right>farx) farx=bounds.right;\n      if(bounds.bottom>fary) fary=bounds.bottom;\n    }\n    let spacer=document.createElement('div');\n    spacer.classList.add('spacer');\n    spacer.style.top=(document.body.scrollTop+fary)+'px';\n    spacer.style.left=(document.body.scrollLeft+farx)+'px';\n    this.map.appendChild(spacer);\n  }\n\n  placenode(node,expand){\n    if(this.drawn.indexOf(node)<0){\n      this.drawn.push(node);\n      for(let x=0;x<environment.nodesize;x++)\n        for(let y=0;y<environment.nodesize;y++)\n          this.map.appendChild(this.placetile(x,y,node));\n    }\n    if(expand) for(let n of node.getneighbors())\n      this.placenode(n,false);\n    this.placespacer();\n  }\n\n  draw(){\n    console.system=this.system;\n    console.print('You enter the system...');\n    this.placenode(this.system.entrance,true);\n    this.player.enter(this.system.entrance);\n    this.refresh();\n    for(let t of this.tiles){\n      if(t.nodeid==this.player.node.id&&\n        t.nodex==this.player.x&&t.nodey==this.player.y){\n        t.scrollIntoView();\n        break;\n      }\n    }\n  }\n\n  addimage(tile,avatar){\n    tile.avatar=avatar;\n    tile.scanned=avatar.scanned;\n    let image=document.createElement('img');\n    image.src=avatar.image;\n    image.title=avatar.tooltip;\n    tile.appendChild(image);\n    tile.image=image;\n  }\n\n  removeimage(tile){\n    tile.avatar=null;\n    tile.image.style.opacity=0;\n    let fade=tile.image;\n    tile.image=null;\n    setTimeout(function(){tile.removeChild(fade);},FADETIME);\n  }\n\n  printmessages(){\n    for(let m=console.pop();m;m=console.pop()){\n      let color=false;\n      if(m.alert==0) color='white';\n      else if(m.alert==1) color='yellow';\n      else if(m.alert==2) color='red';\n      else throw 'Unknown alert level';\n      let div=document.createElement('div');\n      div.style.color=color;\n      div.appendChild(document.createTextNode(m.text));\n      this.console.appendChild(div);\n    }\n    this.console.scrollTop=this.console.scrollHeight;\n  }\n  \n  refresh(){\n    this.printmessages();\n    if(this.system.revealed) for(let n of this.system.nodes) \n      this.placenode(n,false);\n    for(let t of this.tiles){\n      let node=this.system.nodes[t.nodeid];\n      if(t.style.opacity==0) setTimeout(function(){\n        t.classList.add('discovered');\n      },1);\n      if(!node.visited) continue;\n      if(!t.style.border) t.classList.add('visited');\n      let avatar=node.getavatar(t.nodex,t.nodey);\n      if(t.image&&(!avatar||\n        avatar!=t.avatar||t.scanned!=avatar.scanned)) \n          this.removeimage(t);\n      if(avatar&&avatar!=t.avatar) this.addimage(t,avatar);\n    }\n  }\n}\n","import {inject} from 'aurelia-framework';\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {Sound} from './modules/sound';\nimport {save} from './modules/save';\nimport {ShowView} from './messages';\nimport environment from './environment';\n\n@inject(Sound,EventAggregator)\nexport class MainMenu {\n    constructor(sound,messaging) {\n        this.sound=sound;\n        this.show=true;\n        this.messaging=messaging;\n        this.hassave=save.checkload()!=false;\n        if(environment.view){\n          let me=this;\n          setTimeout(function(){\n            me.close(environment.view);}\n          ,1);\n        }\n    }\n  \n    showpending(){\n        this.sound.play(this.sound.ERROR);\n        setTimeout(function(){\n            alert('Operation pending!');\n        },100);\n    }\n    \n    startgame(){\n        let prompt='Are you sure you want to start a new game? Any previous progress will be lost!';\n        if(this.hassave&&!confirm(prompt)){\n            return;\n        }\n        save.clear();\n        this.close('CharacterScreen');\n    }\n    \n    loadgame(){\n        if(this.hassave){\n          save.load();\n          this.close('CharacterScreen');\n        }else{\n          this.sound.play(this.sound.ERROR);\n          alert('No save found!');\n        }\n    }\n    \n    close(open){\n        this.show=false;\n        this.messaging.publish(new ShowView(open));\n    }\n      \n    openrepository(){\n      window.open('https://github.com/tukkek/infojack');\n    }\n}\n","export class Radio {\n    constructor() {\n        this.active=false;\n    }\n  \n    play(){\n        this.audio.play();\n        if(!this.active){\n            this.audio.play();\n        } else {\n            this.audio.pause();\n        }\n        return true;\n    }\n}\n","export class TopMenu{\n    constructor(){\n        this.hideradio=true;\n    }\n    \n    open(){\n        this.hideradio=!this.hideradio;\n    }\n}\n","import environment from './environment';\n\n//Configure Bluebird Promises.\nPromise.config({\n  warnings: {\n    wForgottenReturn: false\n  }\n});\n\nexport function configure(aurelia) {\n  aurelia.use\n    .standardConfiguration()\n    .feature('resources');\n\n  if (environment.debug) {\n    aurelia.use.developmentLogging();\n  }\n\n  if (environment.testing) {\n    aurelia.use.plugin('aurelia-testing');\n  }\n\n  aurelia.start().then(() => aurelia.setRoot());\n}\n","export class ShowView{\n    constructor(view){\n        this.view=view;//CharacterScreen\n    }\n}\n","//TODO needs to boost Character#ranks with int\n\nimport {hero,costs} from '../modules/character/character';\nimport environment from '../environment';\n\n/* TODO add difficulty modes */\nexport class CharacterAbilities {\n    constructor() {}\n    \n    attached(){\n        this.full=environment.fullattributes;\n        this.strength=hero.strength;\n        this.dexterity=hero.dexterity;\n        this.constitution=hero.constitution;\n        this.intelligence=hero.intelligence;\n        this.wisdom=hero.wisdom;\n        this.charisma=hero.charisma;\n        this.pointbuy=hero.pointbuy;\n        this.pointextra=hero.pointextra;\n    }\n    \n    save(){\n        let clone={};\n        Object.assign(clone,this);\n        delete clone.full;\n        hero.assign(clone);\n    }\n\n    upgrade(ability){\n        let current=this[ability];\n        if(current==18) return;\n        let raised=this[ability]+1;\n        if(this.pointextra>0){\n            this.pointextra-=1;\n            this[ability]=raised;\n        }else if(this.buy(current)){\n            this[ability]=raised;\n        }else return;\n        if(ability=='intelligence'&&raised%2==0){\n            hero.ranks+=hero.level==1?4:1;\n        }\n        this.save();\n    }\n    \n    buy(current){\n        let next=current+1;\n        let cost=costs[next]-costs[current];\n        if(this.pointbuy>=cost){\n            this.pointbuy-=cost;\n            return true;\n        }\n        return false;\n    }\n}\n","import {hero} from '../modules/character/character';\nimport {skills} from '../modules/character/skill';\nimport {Class} from '../modules/character/class/class';\n\nexport class CharacterDetails {\n    constructor() {\n      this.abilities=['Strength','Dexterity','Constitution','Intelligence','Wisdom','Charisma'];\n      this.saves=['Fortitude','Reflexes','Will'];\n      this.skills=skills;\n      this.classes=Class.classes;\n    }\n\n    bind(){\n      this.avatar=hero.connect();\n    }\n    \n    sign(n){\n      return n>=0?'+'+n:n;\n    }\n    \n    getmodifier(ability){\n      ability=ability.toLowerCase();\n      ability=this.avatar.getmodifier(this.avatar[ability]);\n      return this.sign(ability);\n    }\n    \n    getsave(save){\n      save=save.toLowerCase();\n      return this.sign(this.avatar['get'+save]());\n    }\n    \n    getskill(skill){\n      skill=skill.name.replace(' ','').toLowerCase()\n      return this.sign(this.avatar['get'+skill]());\n    }\n}\n","import {feats} from '../modules/character/feat';\nimport {hero} from '../modules/character/character';\nimport {inject} from 'aurelia-framework';\nimport {BindingSignaler} from 'aurelia-templating-resources';\n\n@inject(BindingSignaler)\nexport class CharacterFeats {\n    constructor(BindingSignaler) {\n        this.signals=BindingSignaler;\n        this.viewname='Feats';\n    }\n    \n    bind(){this.points=hero.newfeats;}\n\n    add(feat){\n        if(this.points==0) return;\n        this.points-=1;\n        hero.newfeats-=1;\n        feat.apply(hero);\n        this.signals.signal('update');\n    }\n    \n    validate(feat){\n        return this.points>0&&feat.validate(hero);\n    }\n    \n    getcurrent(){\n      let current=[];\n      for(let f of hero.feats) if(!f.talent) current.push(f);\n      return current;\n    }\n    \n    getall(){return feats;}\n}\n","import {hero} from '../modules/character/character';\nimport environment from '../environment';\n\nexport class CharacterGeneral {\n    constructor() {\n      this.hero=hero;\n      this.avatar=hero.image;\n      this.avatars=environment.playeravatars;\n    }\n    \n    attached(){this.name.focus();}\n    \n    select(avatar){\n      this.avatar=avatar;\n      hero.image=avatar;\n    }\n}\n","import {inject} from 'aurelia-framework';\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {ShowView} from '../messages';\nimport {save} from '../modules/save';\n\n@inject(EventAggregator)\nexport class CharacterScreen {\n    constructor(messaging) {\n        this.show=false;\n        this.showgeneral=true;\n        this.showabilities=false;\n        this.showskills=false;\n        this.showfeats=false;\n        this.showtalents=false;\n        this.showdetails=false;\n        this.messaging=messaging;\n        \n        let me=this;\n        messaging.subscribe(ShowView,function(show){\n            if(show.view=='CharacterScreen') me.show=true;\n        });\n    }\n    \n    select(e){\n        let id=e.target.id;\n        for(let button of this.charactermenu.childNodes){\n            let classes=button.classList;\n            if(!classes){\n                continue;\n            }\n            var show=button.id==id;\n            this['show'+button.id.replace('character-','')]=show;\n            if(show){\n                classes.add('highlightbg');\n            } else {\n                classes.remove('highlightbg');\n            }\n        }\n    }\n    \n    close(){\n        save.save();\n        this.show=false;\n        this.messaging.publish(new ShowView('Cyberspace'));\n    }\n}\n\n","import {skills} from '../modules/character/skill';\nimport {hero} from '../modules/character/character';\nimport {inject} from 'aurelia-framework';\nimport environment from '../environment';\n\nexport class CharacterSkills {\n    constructor() {\n        this.skills=skills;\n    }\n    \n    bind(){\n        this.hero=hero;\n        this.ranks={};\n        for(let s of skills.values()) \n          this.ranks[s.name]=hero.getranks(s.name);\n    }\n    \n    iscrossclass(skill){\n        return environment.ccskills&&\n          !hero.classskills.includes(skill);\n    }\n    \n    buy(skill){\n        return this.iscrossclass(skill)?2:1;\n    }\n    \n    upgrade(skill){\n        if(!this.canupgrade(this.ranks[skill],skill)) return;\n        let cost=this.buy(skill);\n        hero.ranks-=cost;\n        this.ranks[skill]+=1;\n        hero.setranks(skill,this.ranks[skill]);\n        if(skill=='Profession'&&hero.level==1\n          &&this.ranks[skill]==1) hero.wealth+=1;\n    }\n    \n    canupgrade(value,skill){\n        let cost=this.buy(skill);\n        return hero.ranks>=cost && value<3+hero.level;\n    }\n    \n    getability(skill){\n      return skill.ability.substring(0,3).toUpperCase();\n    }\n}\n","import {useView} from 'aurelia-framework';\nimport {hero} from '../modules/character/character';\nimport {Class} from '../modules/character/class/class';\nimport {inject} from 'aurelia-framework';\nimport {BindingSignaler} from 'aurelia-templating-resources';\n\n@useView('./character-feats.html')\n@inject(BindingSignaler)\nexport class CharacterTalents {\n    constructor(BindingSignaler) {\n        this.signals=BindingSignaler;\n        this.viewname='Talents';\n    }\n    \n    bind(){\n      this.points=hero.talent;\n      this.talents=new Map();\n      for(let c in hero.classes)\n        for(let [name,talent] of Class.classes.get(c).talents)\n          this.talents.set(name,talent);\n    }\n\n    add(talent){\n        if(this.points==0) return;\n        this.points-=1;\n        hero.talent-=1;\n        hero.addfeat(talent);\n        this.signals.signal('update');\n    }\n    \n    validate(talent){\n        return this.points>0&&talent.validate(hero);\n    }\n    \n    getcurrent(){\n      let current=[];\n      for(let f of hero.feats) if(f.talent) current.push(f);\n      return current;\n    }\n    \n    getall(){return this.talents;}\n}\n","class Rpg{\n    constructor(){}\n    \n    r(min,max){\n      return Math.floor((Math.random()*(max+1))+min);\n    }\n    \n    d(dice,sides){\n        let sum=0;\n        for(let i=0;i<dice;i++){\n            sum+=this.r(1,sides);\n        }\n        return sum;\n    }\n    \n    choose(list){\n      return list[this.r(0,list.length-1)];\n    }\n    \n    chancein(n){\n      n=Math.floor(n);\n      return n>=1&&this.r(1,n)==1;\n    }\n    \n    shuffle(array){\n      for (let i=array.length-1;i>0;i--) {\n        let j=this.r(0,i+1);\n        let swap=array[i];\n        array[i]=array[j];\n        array[j]=swap;\n      }\n      return array;\n    }\n    \n    randomize(amount){\n      return this.r(1,amount)-this.r(1,amount);\n    }\n}\n\nexport var rpg=new Rpg();\n","import {hero} from './character/character';\nimport environment from '../environment';\n\nclass Save{\n    constructor(){}\n    \n    checkload(){\n        return localStorage.getItem('infojack-save');\n    }\n    \n    load(){\n        let data=this.checkload();\n        if(!data){\n            return false;\n        }\n        data=JSON.parse(data);\n        this.populate(data);\n        this.initialize();\n        return true;\n    }\n\n    populate(data){\n        Object.assign(hero,data.hero);\n        this.debug();\n    }\n\n    initialize(){\n    }\n\n    //TODO use on game lost\n    //TODO use on game won\n    clear(){\n        localStorage.setItem('infojack-save','');\n    }\n\n    save(){\n        let data={};\n        data.hero=hero;\n        localStorage.setItem('infojack-save',JSON.stringify(data));\n        this.debug();\n    } \n    \n    debug(){\n        if(!environment.printsave) return;\n        let data=this.checkload();\n        if(data) alert(data);\n    }\n}\n\nexport var save=new Save();\n","var PREFIX='./sounds/';\n\nexport class Sound{\n    constructor(){\n        this.ERROR='Computer Error Alert-SoundBible.com-783113881.mp3';\n    }\n     \n    play(file){\n        new Audio(PREFIX+file).play();\n    }\n}\n","export function configure(config) {\n  //config.globalResources([]);\n}\n","//TODO convert primary BAB elsewhere\n\nimport {occupations} from './occupation';\nimport {webcrawler} from './class/webcrawler';\nimport {skills} from './skill';\nimport {rpg} from '../rpg';\nimport environment from '../../environment';\n\nvar ABILITYPOINTS=\n  Math.round((15+4*6)/(environment.fullattributes?1:2));\n\nexport var costs={\n    7:-4,\n    8:-2,\n    9:-1,\n    10:0,\n    11:1,\n    12:2,\n    13:3,\n    14:5,\n    15:7,\n    16:10,\n    17:13,\n    18:17,\n}\n\nexport class Character{\n    constructor(name){\n        this.name=name;\n        this.image=rpg.r(0,environment.playeravatars-1);\n        this.hp=0;\n        this.maxhp=0;\n        this.strength=7;\n        this.dexterity=7;\n        this.constitution=7;\n        this.intelligence=7;\n        this.wisdom=7;\n        this.charisma=7;\n        this.pointbuy=ABILITYPOINTS;\n        this.pointextra=0;\n        this.wealth=5; //average of 2d4 to prevent scumming\n        this.classskills=[];\n        this.classes={};//holds levels\n        this.level=0;\n        this.ranks=0;\n        this.bab=0;//hold only primary BAB\n        this.edgedice=[0,0];//0d1\n        this.edge=0;//current edge\n        this.fort=0;\n        this.ref=0;\n        this.will=0;\n        this.defence=0;\n        this.init=0;\n        this.talent=0;\n        if(environment.extratalents)\n          this.talent+=environment.extratalents;\n        this.contacts=0;//TODO\n        this.feats=[];\n        this.newfeats=2;\n        for(let s of skills.values()){\n            this[s.name.replace(' ','').toLowerCase()]=0;\n        }\n    }\n\n    /* makes sure not to write new data */\n    assign(data){\n        for(let key in data){\n            if(key in this){\n                this[key]=data[key];\n            }\n        }\n    }\n    \n    setoccupation(occupation){\n        this.wealth+=occupation.wealth;\n        for(let s of occupation.skills){\n            this.addclassskill(s);\n        }\n    }\n    \n    addclassskill(s){\n        if(this.classskills.indexOf(s)<0){\n            this.classskills.push(s);\n        }\n    }\n    \n    //TODO use\n    connect(){\n        let avatar=new Character();\n        Object.assign(avatar,this);\n        if(this.classes['Webcrawler']){\n            this.enhancecrawler(avatar);\n        }\n        return avatar;\n    }\n    \n    enhancecrawler(avatar){\n        avatar.strength=Math.max(\n            avatar.strength,avatar.intelligence);\n        avatar.dexterity=Math.max(\n            avatar.dexterity,avatar.wisdom);\n        avatar.constitution=Math.max(\n            avatar.constitution,avatar.charisma);\n        let level=this.classes['Webcrawler'];\n        avatar.bab-=[0,1,1,2,2,3,3,4,4,5][level-1];\n        avatar.bab+=level;\n    }\n    \n    getmodifier(ability){\n        if(ability%2==1){\n            ability-=1;\n        }\n        return (ability-10)/2;\n    }\n    \n    getranks(name){\n        return this[name.replace(' ','').toLowerCase()];\n    }\n    \n    setranks(name,value){\n        this[name.replace(' ','').toLowerCase()]=value;\n    }\n    \n    hasfeat(f){\n        f=f.name||f;\n        for(let feat of this.feats)\n          if(feat.name.toLowerCase()==f.toLowerCase())\n            return feat;\n        return false;\n    }\n    \n    addfeat(f){\n        this.feats.push(f);\n    }\n    \n    getskill(ranks,ability,feat,featbonus){\n        if(feat&&this.hasfeat(feat)) ranks+=featbonus;\n        ranks=ranks+this.getmodifier(ability);\n        return ranks;\n    }\n    \n    getbluff(){\n      return this.getskill(this.bluff,this.charisma,'power of belief',1);\n    }\n    \n    getconcentration(){\n        return this.getskill(\n          this.concentration,this.constitution,false,0);\n    }\n    \n    getdecryption(){\n      let decryption=this.getskill(\n        this.decryption,this.intelligence,'studious',2);\n      if(this.hasfeat('power of belief')) decryption+=1;\n      return decryption;\n    }\n    \n    getelectronics(){\n        return this.getskill(\n          this.electronics,this.intelligence,false,0);\n    }\n    \n    getforgery(){\n        return this.getskill(\n          this.forgery,this.intelligence,'meticulous',2);\n    }\n    \n    getinformation(){\n        return this.getskill(\n          this.information,this.charisma,'trustworthy',3);\n    }\n    \n    gethacking(){\n        return this.getskill(\n          this.hacking,this.intelligence,\n          'specialized equipment',1);\n    }\n    \n    getperceive(){\n        return this.getskill(this.perceive,this.wisdom,false,0);\n    }\n    \n    getmedicine(){\n        return this.getskill(this.medicine,this.wisdom,false,0);\n    }\n    \n    getstealth(){\n      let stealth=this.getskill(\n        this.stealth,this.dexterity,'stealthy',3);\n      if(this.hasfeat('power of belief')) stealth+=1;\n      return stealth;\n    }\n    \n    getprofession(){\n      return this.getskill(\n        this.profession,this.wisdom,false,0);\n    }\n    \n    getresearch(){\n        return this.getskill(\n          this.research,this.intelligence,'studious',2);\n    }\n    \n    getsearch(){\n      let search=this.getskill(\n        this.search,this.intelligence,'meticulous',2);\n      if(this.hasfeat('power of belief')) search+=1;\n      return search;\n    }\n    \n    gettechnology(){\n        return this.getskill(\n          this.technology,this.intelligence,'educated',3);\n    }\n    \n    getfortitude(){\n      return this.fort+this.getmodifier(this.constitution);\n    }\n    \n    getreflexes(){\n      return this.ref+this.getmodifier(this.dexterity);\n    }\n    \n    getwill(){\n      return this.will+this.getmodifier(this.wisdom);\n    }\n    \n    getinitiative(){\n      let init=this.init+this.getmodifier(this.dexterity);\n      if(this.hasfeat('improved initiative')) init+=4;\n      return init;\n    }\n    \n    getdefence(){\n      return 10+this.defence+this.getmodifier(this.dexterity);\n    }\n    \n    getmelee(){\n      return this.bab+this.getmodifier(this.strength);\n    }\n    \n    getranged(){\n      return this.bab+this.getmodifier(this.dexterity);\n    }\n    \n    price(purchasedc){\n      let price=purchasedc>=15?1:0;\n      let difference=purchasedc-this.wealth;\n      if(difference<1) return price;\n      if(difference<=10) return price+1;\n      price+=difference-10;\n      return price>12?12:price; \n    }\n    \n    /*TODO gather information takes 1 hour per purchasedc\n     * use this to find items of interest (1 store per type of buy: programs, deck, cyber) and create as many options until the total purchasedc is equal or bigger than 16 in a day (or 24h with manual sleeping/tired routines). Each gather information roll returns the maximum purchasedc of the found object (or manybe result-10).\n     * */\n    buy(purchasedc){\n      if(10+this.wealth<purchasedc) return false;\n      this.wealth-=this.price(purchasedc);\n      if(this.wealth<0) this.wealth=0;\n      return true;\n    }\n    \n    /*-3 for selling, -3 for illegal*/\n    sell(purchasedc){\n      let price=this.price(purchasedc-6);\n      this.wealth+=price;\n      return price;\n    }\n    \n    /* As per level-up rules, in Infojack may be used to\n     * represent mission payment values or similar. TODO */\n    upgradewealth(){\n      let taketen=10+this.getprofession();\n      if(taketen<this.wealth) return 0;\n      let wealth=1;\n      taketen-=this.wealth;\n      while(taketen>=5){\n        wealth+=1;\n        taketen-=5;\n      }\n      return wealth;\n    }\n}\n\nexport var hero=new Character('Player1');\nhero.setoccupation(occupations.adventurer);\nwebcrawler.advance(hero); //becomes level 1\n\n//TODO actually buy these programs once they're ready\nconsole.log('Initial wealth: '+hero.wealth);\nconsole.log('Purchase blade: '+hero.price(9));\nconsole.log('Purchase cloak: '+hero.price(9));\nconsole.log('Purchase flicker: '+hero.price(14));\nhero.buy(9);hero.buy(9);hero.buy(14);\nconsole.log('Final wealth: '+hero.wealth);\n","export var feats=new Map();\n\nexport class Feat{\n    constructor(name,description){\n        this.name=name;\n        this.description=description;\n        this.talent=false;\n    }\n    \n    validate(character){\n        return !character.hasfeat(this);\n    }\n    \n    apply(character){\n        character.addfeat(this);\n    }\n}\n\nexport class Talent extends Feat{\n  constructor(name,description){\n    super(name,description);\n    this.talent=true;\n  }\n}\n\nclass Educated extends Feat{\n    constructor(){\n        super('Educated','+3 to Techonology rolls');\n    }\n}\n\nclass Meticulous extends Feat{\n    constructor(){\n        super('Meticulous','+2 to Forgery and Search rolls');\n    }\n}\n\nclass Stealthy extends Feat{\n    constructor(){\n        super('Stealthy','+3 to Stealth rolls');\n    }\n}\n\nclass Studious extends Feat{\n    constructor(){\n        super('Studious','+2 to Decrypt and Research rolls');\n    }\n}\n\nclass Trustworthy extends Feat{\n    constructor(){\n        super('Trustworthy','+3 to Information rolls');\n    }\n}\n\nclass ImprovedInitiative extends Feat{\n   constructor(){\n        super('Improved initiative',\n              '+4 to initiative rolls');\n    }\n}\n\nclass Windfall extends Feat{\n   constructor(){\n        super('Windfall',\n          '+3 wealth (may be taken multiple times)');\n    }\n    validate(character){return true;}\n    apply(character){character.wealth+=3;}\n}\n\nfor(let feat of [\n    new Educated(),\n    new ImprovedInitiative(),\n    new Meticulous(),\n    new Stealthy(),\n    new Stealthy(),\n    new Studious(),\n    new Trustworthy(),\n    new Windfall(),\n]) feats.set(feat.name.toLowerCase(),feat);\n","import {skills,checkskills} from './skill';\n\n//TODO feats\nclass Occupation{\n    constructor(wealth,skillsp){\n        this.wealth=wealth;\n        this.skills=skillsp;\n        checkskills(skillsp);\n    }\n}\n\nexport var occupations={};\n\noccupations.adventurer=new Occupation(+1,['Bluff','Technology','Stealth','Perceive','Medicine']);\n","class Skill{\n    constructor(name,ability,description){\n        this.name=name;\n        this.ability=ability; //used only as a label\n        this.description=description;\n    }\n}\n\nexport var skills=new Map();\n\n//TODO Concentration wasnt on the first draft, check class skills\nfor (let skill of [\n    new Skill('Bluff','Charisma',\n        \"Convince ICE you're not an intruder\"),\n    new Skill('Concentration','Constitution',\n        \"Focus your mind while in danger\"),\n    new Skill('Decryption','Intelligence',\n        \"Break into protected data\"),\n    new Skill('Electronics','Intelligence',\n        \"Build and install hardware\"),\n    new Skill('Forgery','Intelligence',\n        \"Forge authentication credentials\"),\n    new Skill('Hacking','Intelligence',\n        \"Act on the Web\"),\n    new Skill('Information','Charisma',\n        \"Find more shopping items and missions\"),\n    new Skill('Medicine','Wisdom',\n        \"Treat your injuries\"),\n    new Skill('Perceive','Wisdom',\n        \"Basic processing of Web stimuli.\"),\n    new Skill('Profession','Wisdom',\n        \"Earn more money per contract\"),\n    new Skill('Research','Intelligence',\n        \"Do perimeter checks on Frames\"),\n    new Skill('Search','Intelligence',\n        \"Scan avatars for more information.\"),\n    new Skill('Stealth','Dexterity',\n        \"Avoid being detected on the Web\"),\n    new Skill('Technology','Intelligence',\n        \"Create your own programs\"),\n]){\n    skills.set(skill.name,skill);\n}\n\nexport function checkskills(ss){\n    for(let s of ss) if(!skills.get(s)) alert('Unknown skill: '+s);\n    return ss;\n}\n","class Message{\n  constructor(text,system){\n    this.text=text;\n    this.alert=system.alert;\n  }\n}\n\nclass Console{\n  constructor(){\n    this.messages=[];\n    this.system=false;\n  }\n  print(message){\n    if(!this.system) throw 'System not set';\n    this.messages.push(\n      new Message(message,this.system));\n  }\n  pop(){\n    return this.messages.pop();\n  }\n}\n\nexport var console=new Console();\n","import {rpg} from '../rpg';\nimport {Node} from './node/node';\nimport {Datastore} from './node/datastore';\nimport {Cpu} from './node/cpu';\nimport {Portal} from './node/portal';\nimport {Interface} from './node/interface';\nimport environment from '../../environment';\n\nexport class System{\n  constructor(level){\n    this.revealed=false; //reveal all map\n    this.level=level;\n    if(this.level<1) this.level=1;\n    else if(this.level>20) this.level=20;\n    this.alert=0;\n    this.nodes=[];\n    this.ice=[];\n    this.entrance=null;\n    this.generatemap();\n    this.definenodes();\n    for(let n of this.nodes) n.generate();\n    this.player=false; //set by Player\n    this.debug();\n  }\n  \n  debug(){\n    if(environment.revealmap) this.reveal();\n    if(environment.scannodes)\n      for(let n of this.nodes) for(let a of n.avatars){\n        a.scan();\n        a.scanned=true;\n      }\n  }\n  \n  getnode(x,y){\n    for(let n of this.nodes) if(x==n.x&&y==n.y) return n;\n    return null;\n  }\n  \n  generatemap(){\n    this.nodes.push(new Cpu(0,0,this));\n    let size=rpg.r(3,7)+this.level;\n    let leastx=0;\n    let leasty=0;\n    while(this.nodes.length<size){\n      let n=rpg.choose(this.nodes);\n      let x=n.x;\n      let y=n.y;\n      if(rpg.chancein(2)) x+=rpg.chancein(2)?+1:-1;\n      else y+=rpg.chancein(2)?+1:-1;\n      if(this.getnode(x,y)) continue;\n      this.nodes.push(new Node(x,y,this));\n      if(x<leastx) leastx=x;\n      if(y<leasty) leasty=y;\n    }\n    for(let n of this.nodes){ //ensure node.x>=0 node.y>=0\n      n.x-=leastx;\n      n.y-=leasty;\n    }\n  }\n  \n  replacenode(target,i){\n    let original=this.nodes[i];\n    target.id=original.id;\n    target.x=original.x;\n    target.y=original.y;\n    this.nodes[i]=target;\n  }\n  \n  findentrance(neighbors){\n    let portals=this.nodes.filter(\n      n=>n.id!=0&&n.getneighbors().length==neighbors); \n    if(portals.length==0) return -1;\n    return this.nodes.indexOf(rpg.choose(portals));\n  }\n  \n  generatenode(){\n    if(rpg.chancein(10)) return new Cpu(-1,-1,this);\n    if(rpg.chancein(4)) return new Interface(-1,-1,this);\n    return new Datastore(-1,-1,this);\n  }\n  \n  definenodes(){\n    this.nodes[0].setmain();\n    let entrancei=-1;\n    for(let neighbors=1;entrancei==-1;neighbors++){\n      entrancei=this.findentrance(neighbors);\n    }\n    this.entrance=new Portal(-1,-1,this);\n    this.replacenode(this.entrance,entrancei);\n    for(let i=1;i<this.nodes.length;i++){\n      if(i==entrancei) continue;\n      let neighbors=this.nodes[i].getneighbors().length;\n      let corridor=neighbors>1&&rpg.chancein(6-neighbors);\n      if(corridor) continue;\n      this.replacenode(this.generatenode(),i);\n    }\n  }\n  \n  reveal(){\n    this.revealed=true;\n    for(let n of this.nodes) n.visited=true;\n  }\n  \n  raisealert(){\n    if(this.alert<2) this.alert+=1;\n  }\n  \n  cancelalert(){\n    if(this.alert>0) this.alert-=1;\n  }\n}\n","/* TODO \n * - for advanced classes, have edge dice as part of levelup\n */\n\nimport {checkskills} from '../skill';\nimport {rpg} from '../../rpg';\nimport {webcrawler} from './webcrawler';\n\nexport class Class{\n    constructor(){this.talents=new Map();}\n    \n    advance(character){\n        let level=character.classes[this.name];\n        if(!level) level=0;\n        level+=1;\n        if(level>10) {\n            throw 'Cannot advance past level 10!';\n        }\n        character.level+=1;\n        this.levelup(character,level);\n        character.classes[this.name]=level;\n    }\n    \n    upgradehp(character){\n      if(character.level==1){\n          character.maxhp=this.hd;\n          character.hp=character.maxhp;\n      }else{\n          let hp=Math.round((1+this.hd)/2);\n          character.maxhp+=hp;\n          character.hp+=hp;\n      }\n    }\n    \n    upgraderanks(character,classlevel){\n      let ranks=this.ranks+\n        character.getmodifier(character.intelligence);\n      character.ranks+=Math.max(1,ranks);\n      if(character.level==1) character.ranks*=4;\n      if(classlevel==1) for(let s of this.skills)\n        character.addclassskill(s);\n    }\n    \n    levelup(character,classlevel){\n      for(let stat of ['bab','fort','ref','will','defence'])\n        this.upgradestat(classlevel,stat,character);\n      this.upgradeedgedice(classlevel,character);\n      this.upgradereputation(character,classlevel);\n      this.upgradehp(character);\n      this.upgraderanks(character,classlevel);\n      if(character.level%3==0) character.newfeats+=1;\n      if(character.level%4==0) character.pointextra+=1;\n      //TODO may want to do this through external means to make it explicit to the player (as mission payment rates for example):\n      if(character.level>1) character.upgradewealth(); \n    }\n    \n    upgradestat(level,stat,character){\n        let last=level>1?this[stat][level-2]:0;\n        let current=this[stat][level-1];\n        character[stat]+=current-last;\n    }\n    \n    upgradeedgedice(level,character){\n        let target=this.edgedice[level-1].split('d');\n        target=[parseInt(target[0]),parseInt(target[1])];\n        if(target[0]>character.edgedice[0]||\n          (target[0]==character.edgedice[0]&&\n            target[1]>=character.edgedice[1]))\n              character.edgedice[0]=target[0];\n              character.edgedice[1]=target[1];\n        if(character.level==1) \n          character.edge+=character.edgedice[0];\n    }\n    \n    upgradereputation(character,level){\n        if(level==1){\n            if(this.reputation[0]>0){\n                //TODO boost\n            }\n        }else if(this.reputation[level-1]>\n                this.reputation[level-2]){\n            //TODO boost\n        }\n    }\n    \n    check(skills){\n      return checkskills(skills);\n    }\n}\n\nClass.classes=new Map();\n","import {Talent} from '../feat'; \nimport {Class} from './class'; \n\nclass TheWebIsAlive extends Talent{\n  constructor(){\n    super('The web is alive',\n      'Adds Will to Perception rolls (requires level 3 and Power of Belief)');\n  }\n  \n  validate(character){\n    return super.validate(character)&&\n      character.level>=3&&\n      character.hasfeat('power of belief');\n  }\n}\n\nclass SpecializedEquipment extends Talent{\n  constructor(){\n    super('Specialized equipment',\n      '+1 to hacking rolls, +5 speed, safe disconnections (requires 4 in hacking, electronics and technology)');\n  }\n  \n  validate(character){\n    return super.validate(character)\n      &&character.hacking>=4\n      &&character.electronics>=4\n      &&character.technology>=4;\n  }\n}\n\nclass Webcrawler extends Class{\n    constructor(){\n        super();\n        this.name='Webcrawler';\n        this.skills=this.check(['Hacking', 'Electronics', 'Decryption', /*'Disable device',*/ 'Forgery', 'Technology', 'Profession', 'Research', 'Technology', 'Search']);\n        this.hd=4;\n        this.ranks=7;\n        this.bab=[0,1,1,2,2,3,3,4,4,5];\n        this.fort=[0,0,1,1,1,2,2,2,3,3];\n        this.ref=[1,2,2,2,3,3,4,4,4,5];\n        this.will=[1,2,2,2,3,3,4,4,4,5];\n        this.defence=[1,1,2,2,2,3,3,3,4,4];\n        this.reputation=[0,1,1,2,2,3,3,4,4,5];\n        this.edgedice=['1d4','1d4','2d4','2d6','2d6','3d6','3d8','3d8','4d8','4d10'];\n        let talents=[\n          new Talent('Hackmastery',\n            '+2 to all damage inflicted'),\n          new Talent('Phreakmastery',\n            'Safe connections, +1 against traces'),\n          new Talent('Power of belief',\n            '+1 to bluff, decryption, search and stealth'),\n          new TheWebIsAlive(),\n          new SpecializedEquipment(),\n          ];\n        for(let t of talents)\n          this.talents.set(t.name,t);\n    }\n    \n    levelup(character,classlevel){\n        super.levelup(character,classlevel);\n        let level=character.level;\n        if(level==1||level==3||level==6||level==9){\n            character.talent+=1;\n        }else if(level==4||level==7){\n            character.ranks+=1;\n        }else if(level==5||level==8){\n            character.contacts+=1;\n        }else if(level==10){\n            character.wealth+=5;\n            //TODO +5 reputation to law and hackers\n        }\n    }\n}\n\nexport var webcrawler=new Webcrawler();\nClass.classes.set(webcrawler.name,webcrawler);\n","import {Avatar} from './avatar';\n\nexport class Alarm extends Avatar{\n  constructor(system){\n    super('nodes/core.png',system);\n    this.tooltip='Process';\n  }\n  \n  scan(){\n    this.setimage('nodes/alarm.bmp');\n    this.tooltip='Alarm';\n  }\n  \n  click(){\n    super.click();\n  }\n}\n","import {System} from '../system';\nimport {rpg} from '../../rpg';\n\nexport class Avatar{\n  constructor(image,system){\n    this.setimage(image);\n    if(!(system instanceof System))\n      throw 'system type: '+system.constructor.name;\n    this.system=system;\n    this.node=null;\n    this.x=-1;\n    this.y=-1;\n    this.tooltip=this.constructor.name;\n    this.scanned=false;\n    this.scandc=this.system+rpg.randomize(10);\n    if(this.scandc<1) this.scandc=1;\n  }\n  \n  setimage(image){\n    this.image='./images/'+image;\n  }\n  \n  enter(node){\n    return node.enter(this);\n  }\n  \n  click(){\n    alert('clicky!');\n  }\n  \n  scan(){\n    return true;\n  }\n}\n","import {Avatar} from './avatar';\n\nexport class Backdoor extends Avatar{\n  constructor(system){\n    super('nodes/core.png',system);\n    this.tooltip='Process';\n  }\n  \n  scan(){\n    this.setimage('nodes/backdoor.bmp');\n    this.tooltip='Backdoor';\n  }\n}\n","import {Avatar} from './avatar';\nimport {rpg} from '../../rpg';\n\nvar OUTCOMES=2;\n\nexport class Control extends Avatar{\n  constructor(system){\n    super('nodes/core.png',system);\n    this.tooltip='Process';\n    this.memory=rpg.chancein(OUTCOMES);\n    this.privilege=rpg.chancein(OUTCOMES);\n  }\n  \n  scan(){\n    if(!this.memory&&!this.privilege) this.node.remove(this);\n    this.setimage('nodes/control.png');\n    this.tooltip='Control';\n  }\n}\n","import {Avatar} from './avatar';\n\nexport class Entry extends Avatar{\n  constructor(system){\n    super('nodes/core.png',system);\n    this.tooltip='Process';\n  }\n  \n  scan(){\n    this.setimage('nodes/entry.png');\n    this.tooltip='ICE entry';\n  }\n  \n  click(){\n    super.click();\n  }\n}\n","import {Avatar} from './avatar';\nimport {rpg} from '../../rpg';\n\nexport class File extends Avatar{\n  constructor(system){\n    super('nodes/fileunscanned.png',system);\n    this.tooltip='Data';\n    this.level=system.level+rpg.randomize(4);\n    this.worthless=this.level<1||rpg.chancein(system.level+1);\n    this.trap=!this.worthless&&\n      rpg.chancein(60/system.level);\n    this.protected=!this.worthless&&!this.trap&&\n      rpg.chancein(21/system.level);\n    if(this.worthless) this.level=0;\n    else if(this.protected&&this.level<system.level) \n      this.level=system.level;\n  }\n  \n  click(){\n    super.click();\n  }\n  \n  scan(){\n    if(this.worthless){\n      this.node.remove(this);\n    }else if(this.protected){\n      this.setimage('nodes/fileprotected.png');\n      this.tooltip='Protected data';\n    }else if(this.trap){\n      this.setimage('nodes/filetrap.png');\n      this.tooltip='Trap data';\n    }else{\n      this.setimage('nodes/file.png');\n    }\n  }\n}\n","import {Avatar} from './avatar';\n\nexport class Gateway extends Avatar{\n  constructor(system){\n    super('nodes/gateway.png',system);\n    this.scanned=true;\n  }\n}\n","import {Avatar} from './avatar';\n\nexport class Map extends Avatar{\n  constructor(system){\n    super('nodes/core.png',system);\n    this.tooltip='Process';\n  }\n  \n  scan(){\n    this.setimage('nodes/map.bmp');\n    this.tooltip='Map';\n  }\n  \n  click(){\n    this.system.reveal();\n    this.node.remove(this);\n  }\n}\n","import {Avatar} from './avatar';\nimport {console} from '../console';\n\nexport class Player extends Avatar{\n  constructor(hero,system){\n    super('characters/'+hero.image+'.png',system);\n    this.scanned=true;\n    this.tooltip=hero.name;\n    system.hero=this;\n  }\n  \n  enter(node){\n    if(!super.enter(node)) return false;\n    node.visited=true;\n    node.scan(); //TODO passive scan, roll-4\n    return true;\n  }\n}\n","import {Avatar} from './avatar';\n\nexport class Terminal extends Avatar{\n  constructor(system){\n    super('nodes/core.png',system);\n    this.tooltip='Process';\n  }\n  \n  scan(){\n    this.setimage('nodes/terminal.png');\n    this.tooltip='Terminal';\n  }\n  \n  click(){\n    super.click();\n  }\n}\n","import {rpg} from '../../rpg';\nimport {Node} from './node';\nimport {Alarm} from '../avatar/alarm';\nimport {Entry} from '../avatar/entry';\nimport {Map} from '../avatar/map';\nimport {Terminal} from '../avatar/terminal';\n\nvar FUNCTIONS=4;\n\nexport class Cpu extends Node{\n  constructor(x,y,system){\n    super(x,y,system)\n    this.priority=2;\n  }\n  \n  setmain(){\n    this.enter(new Alarm(this.system));\n    this.enter(new Entry(this.system));\n    this.enter(new Map(this.system));\n    this.enter(new Terminal(this.system));\n  }\n  \n  generate(){\n    while(this.avatars.length==0){\n      if(rpg.chancein(FUNCTIONS)) \n        this.enter(new Alarm(this.system));\n      if(rpg.chancein(FUNCTIONS)) \n        this.enter(new Entry(this.system));\n      if(rpg.chancein(FUNCTIONS)) \n        this.enter(new Map(this.system));\n      if(rpg.chancein(FUNCTIONS)) \n        this.enter(new Terminal(this.system));\n    }\n  }\n}\n","import {Node} from './node';\nimport {File} from '../avatar/file';\nimport {rpg} from '../../rpg';\n\nexport class Datastore extends Node{\n  constructor(x,y,system){\n    super(x,y,system)\n    this.priority=1;\n  }\n  \n  generate(){\n    let files=rpg.r(1,4);\n    for(let i=0;i<files;i++){\n      this.enter(new File(this.system));\n    }\n  }\n}\n","import {Node} from './node';\nimport {Backdoor} from '../avatar/backdoor';\nimport {Control} from '../avatar/control';\nimport {rpg} from '../../rpg';\n\nexport class Interface extends Node{\n  constructor(x,y,system){\n    super(x,y,system)\n    this.priority=1;\n  }\n  \n  generate(){\n    while(this.avatars.length==0){\n      if(rpg.chancein(4)) this.enter(new Control(this.system));\n      if(rpg.chancein(6)) this.enter(new Backdoor(this.system));\n    }\n  }\n}\n","import {rpg} from '../../rpg';\nimport environment from '../../../environment';\n\nvar TILES=[];\n\nfor(let x=0;x<environment.nodesize;x++) \n  for(let y=0;y<environment.nodesize;y++)\n    TILES.push([x,y]);\n\nexport class Node{\n  constructor(x,y,system){\n    this.x=x;\n    this.y=y;\n    this.id=system.nodes.length;\n    this.priority=0;\n    this.system=system;\n    this.avatars=[];\n    this.visited=false;\n  }\n  \n  generate(){\n    // override\n  }\n  \n  getneighbors(){\n    let neighbors=[];\n    for(let xy of [[-1,0],[+1,0],[0,+1],[0,-1]]){\n      let n=this.system.getnode(this.x+xy[0],this.y+xy[1]);\n      if(n) neighbors.push(n);\n    }\n    return neighbors;\n  }\n  \n  getavatar(x,y){\n    for(let a of this.avatars) if(a.x==x&&a.y==y) return a;\n    return null;\n  }\n  \n  remove(avatar){\n    this.avatars.splice(this.avatars.indexOf(avatar),1);\n  }\n  \n  /* return true if found free spot */\n  enter(avatar){\n    if(avatar.node==this) return false;\n    rpg.shuffle(TILES);\n    for(let xy of TILES) if(!this.getavatar(xy[0],xy[1])){\n      if(avatar.node) avatar.node.remove(avatar);\n      avatar.x=xy[0];\n      avatar.y=xy[1];\n      avatar.node=this;\n      this.avatars.push(avatar);\n      return true;\n    }\n    return false;\n  }\n  \n  /* scan avatars randomly\n   * return false if one fails or true if all done */\n  scan(){ //TODO skill test\n    for(let a of rpg.shuffle(this.avatars.slice())){\n      if(!a.scanned){\n        if(false) return false;\n        a.scan();\n        a.scanned=true;\n      }\n    }\n    return true;\n  }\n}\n","import {Node} from './node';\nimport {Gateway} from '../avatar/gateway';\n\n//TODO make it part of the normal generation to hop to other systems\n//TODO at first can even have it as \"stairs down\"\nexport class Portal extends Node{\n  constructor(x,y,system){\n    super(x,y,system)\n    this.priority=2;\n  }\n  \n  generate(){\n    this.enter(new Gateway(this.system));\n  }\n}\n"],"sourceRoot":".."}